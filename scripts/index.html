<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>scripts - xieby1&#x27;s notes</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="..//fonts/lxgwwenkai-regular.css" />
        <link rel="stylesheet" href="..//fonts/lxgwwenkaimono-regular.css" />
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../index.html">Welcome</a></li><li class="chapter-item "><a href="../Essays.html">Essays</a></li><li class="chapter-item "><a href="../abbreviations.html">abbreviations</a></li><li class="chapter-item affix "><li class="part-title">xieby1's notes</li><li class="chapter-item "><div>ABI</div></li><li class="chapter-item "><div>Algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Graph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Algo/Graph/1998.distance.bunke.prl.775.html">1998.distance.bunke.prl.775.md</a></li><li class="chapter-item "><a href="../Algo/Graph/2002.inexact_match.bengoetxea.doc_thesis.107.html">2002.inexact_match.bengoetxea.doc_thesis.107.md</a></li><li class="chapter-item "><a href="../Algo/Graph/2014.attributed.zhang.cvpr.19.html">2014.attributed.zhang.cvpr.19.md</a></li><li class="chapter-item "><a href="../Algo/Graph/2016.survey.yan.icmr.108.html">2016.survey.yan.icmr.108.md</a></li><li class="chapter-item "><a href="../Algo/Graph/2021.igraphmatch.qiao..0.html">2021.igraphmatch.qiao..0.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div></li><li class="chapter-item "><div>Arch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Cache</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Arch/Cache/2022.dsa_cache.sedaghati.isca.0.html">2022.dsa_cache.sedaghati.isca.0.md</a></li></ol></li><li class="chapter-item "><div>HT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Arch/HT/2005.cell.kahle.ibmjrd.1093.html">2005.cell.kahle.ibmjrd.1093.md</a></li><li class="chapter-item "><a href="../Arch/HT/2012.process_migration.devuyst.asplos.83.html">2012.process_migration.devuyst.asplos.83.md</a></li><li class="chapter-item "><a href="../Arch/HT/2014.isa_explore.venkat.isca.112.html">2014.isa_explore.venkat.isca.112.md</a></li><li class="chapter-item "><a href="../Arch/HT/2015.overview.mitra.jip.15.html">2015.overview.mitra.jip.15.md</a></li><li class="chapter-item "><a href="../Arch/HT/2018.process_migration.venkat.doc_thesis.5.html">2018.process_migration.venkat.doc_thesis.5.md</a></li><li class="chapter-item "><a href="../Arch/HT/2019.composite_isa.venkat.hpca.17.html">2019.composite_isa.venkat.hpca.17.md</a></li><li class="chapter-item "><a href="../Arch/HT/2020.byoc_framework.balkind.asplos.3.html">2020.byoc_framework.balkind.asplos.3.md</a></li><li class="chapter-item "><a href="../Arch/HT/xa64/index.html">xa64</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Arch/HT/xa64/manual.html">XA64 MANUAL</a></li></ol></li></ol></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Arch/reconf/1997.chimaera.hauck.fccm.461.html">1997.chimaera.hauck.fccm.461.md</a></li><li class="chapter-item "><a href="../Arch/reconf/2008.reconf_acc.beck.date.97.html">2008.reconf_acc.beck.date.97.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div></li></ol></li><li class="chapter-item "><div>Benchmarks</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Benchmarks/coremark.html">coremark.md</a></li><li class="chapter-item "><div>herdtools7</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Benchmarks/herdtools7/overview.html">内存模型测试——DIY（Herdtools）</a></li></ol></li><li class="chapter-item "><a href="../Benchmarks/spec/index.html">spec</a></li><li class="chapter-item "><a href="../Benchmarks/spec2000.html">spec2000.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/algo/2006.lib.杨浩.计算机研究与发展.0.html">2006.lib.杨浩.计算机研究与发展.0.md</a></li><li class="chapter-item "><a href="../BT/algo/2016.static_identify_jump_target.federico.cases.9.html">2016.static_identify_jump_target.federico.cases.9.md</a></li><li class="chapter-item "><div>bt_rules</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/algo/bt_rules/2006.peephole_superopt.bansal.asplos.134.html">2006.peephole_superopt.bansal.asplos.134.md</a></li><li class="chapter-item "><a href="../BT/algo/bt_rules/2018.learn.wwwang.asplos.11.html">2018.learn.wwwang.asplos.11.md</a></li></ol></li><li class="chapter-item "><div>offload</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/algo/offload/2010.distribit.guan.hpdc.5.html">2010.distribit.guan.hpdc.5.md</a></li></ol></li><li class="chapter-item "><div>reg</div></li><li class="chapter-item "><div>smc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/algo/smc/2015.detect.hawkins.cgo.24.html">2015.detect.hawkins.cgo.24.md</a></li></ol></li><li class="chapter-item "><div>trace</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/algo/trace/1994.opt_profiling_tracing.ball.toplas.580.html">1994.opt_profiling_tracing.ball.toplas.580.md</a></li><li class="chapter-item "><a href="../BT/algo/trace/2000.net.duesterwald.asplos.141.html">2000.net.duesterwald.asplos.141.md</a></li><li class="chapter-item "><a href="../BT/algo/trace/2005.edge_profile.白童心.计算机工程.2.html">2005.edge_profile.白童心.计算机工程.2.md</a></li><li class="chapter-item "><a href="../BT/algo/trace/2005.lei_net.hiniker.micro.39.html">2005.lei_net.hiniker.micro.39.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/analysis/2014.simulators_harm.nowatki..19.html">2014.simulators_harm.nowatki..19.md</a></li><li class="chapter-item "><a href="../BT/analysis/2020.perfdbt.wu.iccd.2.html">2020.perfdbt.wu.iccd.2.md</a></li></ol></li><li class="chapter-item "><div>application</div></li><li class="chapter-item "><div>Box86</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/Box86/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>dynamic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/dynamic/2017.mambox64.dantras.pldi.18.html">2017.mambox64.dantras.pldi.18.md</a></li></ol></li><li class="chapter-item "><a href="../BT/exagear.html">exagear.md</a></li><li class="chapter-item "><div>HQEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/HQEMU/codeReading-deprecated.html">codeReading-deprecated.md</a></li><li class="chapter-item "><a href="../BT/HQEMU/codeReading.html">codeReading.md</a></li></ol></li><li class="chapter-item "><div>HW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/HW/2008.coprocessor.li.amasbt.3.html">2008.coprocessor.li.amasbt.3.md</a></li><li class="chapter-item "><a href="../BT/HW/2009.godson3_x86_emu.hu.micro.84.html">2009.godson3_x86_emu.hu.micro.84.md</a></li><li class="chapter-item "><div>codeCache</div></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/HW/reconf/2013.x86_mips_reconf.junior.jsa.4.html">2013.x86_mips_reconf.junior.jsa.4.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/HW/VLIW/2015.denver.nvidia.micro.36.html">2015.denver.nvidia.micro.36.md</a></li><li class="chapter-item "><a href="../BT/HW/VLIW/2019.hybrid_dbt.rokicki.cadics.2.html">2019.hybrid_dbt.rokicki.cadics.2.md</a></li><li class="chapter-item "><div>crusoe</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/HW/VLIW/crusoe/2000.crusoe.klaiber.transmeta.118.html">2000.crusoe.klaiber.transmeta.118.md</a></li></ol></li><li class="chapter-item "><div>daisy</div></li></ol></li></ol></li><li class="chapter-item "><div>kernel</div></li><li class="chapter-item "><a href="../BT/libDBT/index.html">libDBT</a></li><li class="chapter-item "><div>lift</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LLBT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/lift/IR/LLBT/LLBT调研.html">LLBT调研</a></li><li class="chapter-item "><a href="../BT/lift/IR/LLBT/二进制翻译调研报告（LLBT相关）.html">二进制翻译调研报告（LLBT相关）.md</a></li></ol></li><li class="chapter-item "><div>mcsema</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/lift/IR/mcsema/2019.mcsema_dyninst.korencik...html">2019.mcsema_dyninst.korencik...md</a></li><li class="chapter-item "><a href="../BT/lift/IR/mcsema/2019.mcsema.researchLogs.html">2019.mcsema.researchLogs.md</a></li><li class="chapter-item "><a href="../BT/lift/IR/mcsema/remill.html">remill.md</a></li></ol></li><li class="chapter-item "><div>mctoll</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/lift/IR/mctoll/2019.mctoll.yadavalli.lctes.5.html">2019.mctoll.yadavalli.lctes.5.md</a></li><li class="chapter-item "><a href="../BT/lift/IR/mctoll/codesReading.html">codesReading.md</a></li><li class="chapter-item "><a href="../BT/lift/IR/mctoll/run.html">run.md</a></li></ol></li><li class="chapter-item "><a href="../BT/lift/IR/overview.html">overview.md</a></li><li class="chapter-item "><div>REVNG</div></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/Mem/2008.thread_safe_by_tm.chung.hpca.51.html">2008.thread_safe_by_tm.chung.hpca.51.md</a></li><li class="chapter-item "><a href="../BT/Mem/2016.atomic.rigo.taco.6.html">2016.atomic.rigo.taco.6.md</a></li></ol></li><li class="chapter-item "><div>oldProj</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/oldProj/1993.mips2alphaaxp.sites.cacm.267.html">1993.mips2alphaaxp.sites.cacm.267.md</a></li><li class="chapter-item "><a href="../BT/oldProj/1998.fx32.chernoff.micro.217.html">1998.fx32.chernoff.micro.217.md</a></li><li class="chapter-item "><div>dbt4AndStatic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/oldProj/dbt4AndStatic/DBT4代码阅读笔记.html">DBT4代码阅读笔记</a></li><li class="chapter-item "><a href="../BT/oldProj/dbt4AndStatic/dbt-static.html">dbt-static.md</a></li><li class="chapter-item "><a href="../BT/oldProj/dbt4AndStatic/去除orc工作量和难度.html">ORC的CGIR</a></li></ol></li></ol></li><li class="chapter-item "><div>others</div></li><li class="chapter-item "><div>overview</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/overview/2001.bt_opt_challenges.altman.pieee.38.html">2001.bt_opt_challenges.altman.pieee.38.md</a></li><li class="chapter-item "><a href="../BT/overview/2004.bibliography_of_simulators.html">2004.bibliography_of_simulators.md</a></li></ol></li><li class="chapter-item "><div>QEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/QEMU/16k.html">16k.md</a></li><li class="chapter-item "><a href="../BT/QEMU/2005.qemu.bellard.usenix.2217.html">2005.qemu.bellard.usenix.2217.md</a></li><li class="chapter-item "><a href="../BT/QEMU/2017.qemu_multi_cores.cota.cgo.8.html">2017.qemu_multi_cores.cota.cgo.8.md</a></li><li class="chapter-item "><a href="../BT/QEMU/LA-backend.html">LA-backend.md</a></li><li class="chapter-item "><a href="../BT/QEMU/linux-user-32.html">linux-user-32.md</a></li><li class="chapter-item "><a href="../BT/QEMU/linux-user.html">linux-user.md</a></li><li class="chapter-item "><a href="../BT/QEMU/linux-user-memory_region.html">linux-user-memory_region.md</a></li><li class="chapter-item "><a href="../BT/QEMU/logs.html">logs.md</a></li><li class="chapter-item "><div>lx</div></li><li class="chapter-item "><a href="../BT/QEMU/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../BT/QEMU/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../BT/QEMU/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../BT/QEMU/signal.html">signal.md</a></li><li class="chapter-item "><div>target</div></li><li class="chapter-item "><a href="../BT/QEMU/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>rewrite</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/rewrite/2018.superset_disassembly.bauman.ndss.40.html">2018.superset_disassembly.bauman.ndss.40.md</a></li><li class="chapter-item "><div>instru</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/rewrite/instru/2009.mt.hazelwood.ismm.28.html">2009.mt.hazelwood.ismm.28.md</a></li><li class="chapter-item "><a href="../BT/rewrite/instru/mem_count.html">mem_count.md</a></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>static</div></li><li class="chapter-item "><div>sys</div></li><li class="chapter-item "><div>Tarmac</div></li><li class="chapter-item "><div>test</div></li><li class="chapter-item "><div>x86-qemu-mips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/x86-qemu-mips/check_manual.html">x86-qemu-mips check手册</a></li><li class="chapter-item "><a href="../BT/x86-qemu-mips/check.html">check.md</a></li><li class="chapter-item "><div>debugs</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/x86-qemu-mips/debugs/OPEN.unknown-loop-in-bios.html">OPEN.unknown-loop-in-bios.md</a></li></ol></li><li class="chapter-item "><a href="../BT/x86-qemu-mips/linux-user.html">x86-qemu-mips做出的修改</a></li><li class="chapter-item "><a href="../BT/x86-qemu-mips/mips-llvm.html">mips-llvm.md</a></li><li class="chapter-item "><a href="../BT/x86-qemu-mips/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../BT/x86-qemu-mips/tr_misc修改记录.html">tr_misc修改记录.md</a></li></ol></li><li class="chapter-item "><div>X86toMips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../BT/X86toMips/dbt测试结果.html">dbt测试结果.md</a></li><li class="chapter-item "><a href="../BT/X86toMips/Pseudo-README.html">Pseudo-README.md</a></li><li class="chapter-item "><a href="../BT/X86toMips/X86toMips调研.html">武成岗</a></li><li class="chapter-item "><a href="../BT/X86toMips/X86toMips调研-续.html">X86toMips调研-续.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Build</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Autotools</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Autotools/2012.autotools_criticism.kamp..html">2012.autotools_criticism.kamp..md</a></li><li class="chapter-item "><a href="../Build/Autotools/autotools.html">autotools.md</a></li></ol></li><li class="chapter-item "><div>CMake</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/CMake/Notes.html">CMkake Notes</a></li></ol></li><li class="chapter-item "><div>Compiler</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Compiler/1992.hyperblock.mahlke.micro.html">1992.hyperblock.mahlke.micro.md</a></li><li class="chapter-item "><div>llvm</div></li><li class="chapter-item "><div>mingw</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Compiler/mingw/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>ORC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Compiler/ORC/2004.ORC-LCPC04-Tutorial.html">2004.ORC-LCPC04-Tutorial.md</a></li><li class="chapter-item "><a href="../Build/Compiler/ORC/2004.overview_orc.wuchengyong.iwlcpc.html">2004.overview_orc.wuchengyong.iwlcpc.md</a></li></ol></li><li class="chapter-item "><div>trans</div></li></ol></li><li class="chapter-item "><div>Disassemble</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Disassemble/2002.disassembly.bschwarz.pieee.html">2002.disassembly.bschwarz.pieee.md</a></li></ol></li><li class="chapter-item "><a href="../Build/ELF/index.html">ELF</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/ELF/ELF调研.html">前沿</a></li><li class="chapter-item "><a href="../Build/ELF/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Linker_Loader</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Build/Linker_Loader/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../Build/mingw.html">Windows Development Environment on Linux</a></li></ol></li><li class="chapter-item "><a href="../cheatsheet.html">cheatsheet.md</a></li><li class="chapter-item "><div>CLI</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../CLI/term_pty_sh.html">term_pty_sh.md</a></li></ol></li><li class="chapter-item "><div>CompatLayer</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../CompatLayer/2006.linuxulator.divacky.freebsd..html">2006.linuxulator.divacky.freebsd..md</a></li><li class="chapter-item "><a href="../CompatLayer/Alky.html">Alky.md</a></li><li class="chapter-item "><div>UML</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../CompatLayer/UML/user_mode_linux.html">user_mode_linux.md</a></li></ol></li><li class="chapter-item "><div>WINE</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../CompatLayer/WINE/2020_6_25.emu_win_syscall.corbet.lwn.html">2020_6_25.emu_win_syscall.corbet.lwn.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/Design_of_WINE.html">wine中的各类设计</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/optimizable.html">optimizable.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/others.html">others.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/qemu-wine-logs.html">qemu-wine-logs.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/qemu-winetest_debug_logs.html">qemu-winetest_debug_logs.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/qemu-wine环境搭建.html">qemu-wine环境搭建.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/References.html">Wine相关资料</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/Winegcc调研.html">最终目标</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/Winelib调研报告.html">Winelib调研报告.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/WINE设备驱动调研.html">背景</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/WINE调研.html">Wine调研</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/二进制翻译调研报告_FX32_Wine.html">二进制翻译调研报告_FX32_Wine.md</a></li><li class="chapter-item "><a href="../CompatLayer/WINE/二进制翻译调研报告_Wine.html">二进制翻译调研报告_Wine.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Connect</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Bluetooth/index.html">Bluetooth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bluez</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Bluetooth/bluez/profile_input.html">总体架构</a></li></ol></li><li class="chapter-item "><div>btkbdd</div></li><li class="chapter-item "><div>dbus</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Bluetooth/dbus/Overview.html">Overview.md</a></li></ol></li><li class="chapter-item "><div>Essays</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>2005.bluez_intro.albert</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Bluetooth/Essays/2005.bluez_intro.albert/An_Introduction_to_Bluetooth_Programming.html">An Introduction to Bluetooth Programming</a></li></ol></li><li class="chapter-item "><a href="../Connect/Bluetooth/Essays/阅读记录.html">HID_v1.1.1</a></li></ol></li><li class="chapter-item "><div>hidclient</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Bluetooth/hidclient/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Network</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bittorrent</div></li><li class="chapter-item "><div>nginx</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Connect/Network/nginx/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><a href="../Connect/Network/p2p.html">p2p.md</a></li><li class="chapter-item "><a href="../Connect/Network/streaming_server.html">streaming_server.md</a></li></ol></li><li class="chapter-item "><div>NFC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Essays</div></li></ol></li></ol></li><li class="chapter-item "><div>dataViz</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../dataViz/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Distro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Distro/JingOS.html">JingOS.md</a></li><li class="chapter-item "><a href="../Distro/Nix/index.html">Nix</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Distro/Nix/32bit.html">打包/编译32位程序</a></li><li class="chapter-item "><a href="../Distro/Nix/android.html">在NixOS上使用Android程序</a></li><li class="chapter-item "><a href="../Distro/Nix/backup_binary_cache.html">备份binary cache</a></li><li class="chapter-item "><a href="../Distro/Nix/cross.html">Nix交叉编译和跨平台程序</a></li><li class="chapter-item "><a href="../Distro/Nix/deb_feishu.html">安装deb包，以飞书为例</a></li><li class="chapter-item "><a href="../Distro/Nix/gnome.html">Gnome in NixOS</a></li><li class="chapter-item "><a href="../Distro/Nix/nixpkgs.html">nixpkgs.md</a></li><li class="chapter-item "><a href="../Distro/Nix/node.html">node.md</a></li><li class="chapter-item "><a href="../Distro/Nix/productivity.html">productivity.md</a></li><li class="chapter-item "><a href="../Distro/Nix/python.html">Python in Nix/NixOS</a></li><li class="chapter-item "><a href="../Distro/Nix/README-en.html">Nix/NixOS</a></li><li class="chapter-item "><a href="../Distro/Nix/static_qemu.html">静态链接，以qemu为例</a></li><li class="chapter-item "><a href="../Distro/Nix/vim.html">Vim in Nix/NixOS</a></li><li class="chapter-item "><a href="../Distro/Nix/wayland.html">Currently, Not Wayland, But X11</a></li><li class="chapter-item "><a href="../Distro/Nix/weird.html">Weird Things in Nix/NixOS</a></li></ol></li></ol></li><li class="chapter-item "><div>Emulator</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Emulator_Design</div></li><li class="chapter-item "><div>gem5</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Emulator/gem5/cache.html">Cache in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/clock.html">Clock in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/debug.html">Debug Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/decode.html">decoding in gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/fetch.html">Fetch in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/files.html">gem5 files</a></li><li class="chapter-item "><a href="../Emulator/gem5/iew.html">Issue, Execute and Writeback in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/isa.html">xieby1's Manual for isa, a new DSL(Domain Specific Language)</a></li><li class="chapter-item "><a href="../Emulator/gem5/logs.html">logs.md</a></li><li class="chapter-item "><a href="../Emulator/gem5/microop.html">microop in gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/mmu.html">X86MMU (X86TLB) in gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/o3cpu.html">O3 CPU in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/overview.html">overview.md</a></li><li class="chapter-item "><a href="../Emulator/gem5/ply.html">PLY(Python Lex Yacc) in gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/port.html">Port Abstraction in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/rename.html">rename.md</a></li><li class="chapter-item "><a href="../Emulator/gem5/scons.html">Scons</a></li><li class="chapter-item "><a href="../Emulator/gem5/simplecpu.html">Simple CPU in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/specialize.html">Specialize in Gem5</a></li><li class="chapter-item "><a href="../Emulator/gem5/troubleShoot.html">Troubles in Gem5</a></li></ol></li><li class="chapter-item "><a href="../Emulator/spike.html">spike.md</a></li></ol></li><li class="chapter-item "><div>EPaper</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../EPaper/laptop.html">laptop.md</a></li></ol></li><li class="chapter-item "><div>fonts</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>files</div></li></ol></li><li class="chapter-item "><div>FPGA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../FPGA/iverilog.html">iverilog.md</a></li></ol></li><li class="chapter-item "><div>hackthon</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../hackthon/Untitled.html">Untitled.md</a></li></ol></li><li class="chapter-item "><div>Input</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Input/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>ISA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ISA/2013.power_of_risc_cisc.blem.hpca.144.html">2013.power_of_risc_cisc.blem.hpca.144.md</a></li><li class="chapter-item "><div>arm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ISA/arm/aarch64.html">aarch64.md</a></li></ol></li><li class="chapter-item "><div>enhance</div></li><li class="chapter-item "><div>mips</div></li><li class="chapter-item "><div>mips_lx</div></li><li class="chapter-item "><div>riscv</div></li><li class="chapter-item "><a href="../ISA/Semantics/index.html">Semantics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ISA/Semantics/2013.locate.lakhotia.pprew.75.html">2013.locate.lakhotia.pprew.75.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2014.lem.mulligan.icfp.79.html">2014.lem.mulligan.icfp.79.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2015.sail.gray.micro.31.html">2015.sail.gray.micro.31.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2016.learn.heule.pldi.56.html">2016.learn.heule.pldi.56.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2018.sail.armstrong..3.html">2018.sail.armstrong..3.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2019.x64_validation.dasgupta.sigplan.24.html">2019.x64_validation.dasgupta.sigplan.24.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/2021.sail.armstrong.manual.html">2021.sail.armstrong.manual.md</a></li><li class="chapter-item "><a href="../ISA/Semantics/asmjit.html">AsmJit</a></li><li class="chapter-item "><div>k</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ISA/Semantics/k/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>ultrasparc</div></li><li class="chapter-item "><div>Uop</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ISA/Uop/1990.nec_intel.elkins...html">1990.nec_intel.elkins...md</a></li><li class="chapter-item "><a href="../ISA/Uop/1996.palcode..manual..html">1996.palcode..manual..md</a></li><li class="chapter-item "><a href="../ISA/Uop/2003.ucache.solomon.tvlsi.13.html">2003.ucache.solomon.tvlsi.13.md</a></li><li class="chapter-item "><a href="../ISA/Uop/2019.reverse_engineer.koppe.usenix_security.16.html">2019.reverse_engineer.koppe.usenix_security.16.md</a></li><li class="chapter-item "><a href="../ISA/Uop/2020.improve_ucache.kotra.micro.1.html">2020.improve_ucache.kotra.micro.1.md</a></li></ol></li><li class="chapter-item "><div>x86</div></li></ol></li><li class="chapter-item "><div>JIT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../JIT/2008.llvm_sim.brandner..29.html">2008.llvm_sim.brandner..29.md</a></li><li class="chapter-item "><a href="../JIT/2011.llvm_sim.helmstetter.imecs.6.html">2011.llvm_sim.helmstetter.imecs.6.md</a></li><li class="chapter-item "><div>dynarmic</div></li><li class="chapter-item "><div>opt</div></li></ol></li><li class="chapter-item "><a href="../Kernel/index.html">Kernel</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/2020_9_9.prepare_new_feat.edge.lwn-lpc.html">2020_9_9.prepare_new_feat.edge.lwn-lpc.md</a></li><li class="chapter-item "><div>Driver</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Driver/2019.linux_win_printer.金融通.软件所硕士.html">2019.linux_win_printer.金融通.软件所硕士.md</a></li></ol></li><li class="chapter-item "><div>exo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/exo/1995.intro.engler.sosp.1259.html">1995.intro.engler.sosp.1259.md</a></li></ol></li><li class="chapter-item "><div>Linux</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Linux/2002.rcu.mckenney..216.html">2002.rcu.mckenney..216.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/2016.sched_bug.lozi.eurosys.120.html">2016.sched_bug.lozi.eurosys.120.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/2018.concurrency.alglave.asplos.31.html">2018.concurrency.alglave.asplos.31.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/2020.rcu.mckenney...html">2020.rcu.mckenney...md</a></li><li class="chapter-item "><div>Android</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Linux/Android/anbox.html">anbox.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/Android/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/Android/to_mainline.html">to_mainline.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/Android/Waydroid.html">Waydroid.md</a></li></ol></li><li class="chapter-item "><a href="../Kernel/Linux/cache_alias.html">🚧cache别名、页着色</a></li><li class="chapter-item "><a href="../Kernel/Linux/cache_alias_page_color.html">cache_alias_page_color.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/docsReading.html">docsReading.md</a></li><li class="chapter-item "><div>drivers</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Linux/drivers/ioctl.html">ioctl.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/drivers/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../Kernel/Linux/idle.html">idle.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/lx.html">lx.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/memory_mapping.html">memory_mapping.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/module.logs.html">module.logs.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/mtlb.logs.html">mtlb.logs.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/page_fault.html">do_page_fault源码分析</a></li><li class="chapter-item "><a href="../Kernel/Linux/page_size.html">page_size.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/QnA-alpine.html">QnA-alpine.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/startup.html">startup.md</a></li><li class="chapter-item "><a href="../Kernel/Linux/syscalls.html">syscalls.md</a></li></ol></li><li class="chapter-item "><a href="../Kernel/memory.html">memory.md</a></li><li class="chapter-item "><div>micro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/micro/1995.u_kernel.lietdke.sosp.308.html">1995.u_kernel.lietdke.sosp.308.md</a></li><li class="chapter-item "><a href="../Kernel/micro/2013.l3_sel4.elphinstone.sosp.126.html">2013.l3_sel4.elphinstone.sosp.126.md</a></li></ol></li><li class="chapter-item "><div>multi</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/multi/2009.intro.baumann.sosp.856.html">2009.intro.baumann.sosp.856.md</a></li></ol></li><li class="chapter-item "><div>syscall</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/syscall/2020_9_8.extensible_syscall.corbet.lwn-lpc.html">2020_9_8.extensible_syscall.corbet.lwn-lpc.md</a></li></ol></li><li class="chapter-item "><a href="../Kernel/transkernel.html">transkernel.md</a></li><li class="chapter-item "><div>unikernel</div></li><li class="chapter-item "><div>WinCmptbl</div></li><li class="chapter-item "><div>Windows</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Windows/compilation.html">compilation.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/index.html">driver</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/Windows/driver/ddiwrapper.html">ddiwrapper.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/logs-1.html">logs-1.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/logs.html">logs.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/ndis.html">ndis.md</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>err</div></li></ol></li><li class="chapter-item "><a href="../Kernel/Windows/driver/printer.html">驱动安装包构成</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/driver/types.html">types.md</a></li></ol></li><li class="chapter-item "><a href="../Kernel/Windows/nameConventions.html">Windows命名风格</a></li><li class="chapter-item "><a href="../Kernel/Windows/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/ReactOS/index.html">ReactOS</a></li><li class="chapter-item "><a href="../Kernel/Windows/service.html">service.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/subsystem.html">subsystem.md</a></li><li class="chapter-item "><a href="../Kernel/Windows/syscall.html">syscall.md</a></li></ol></li><li class="chapter-item "><div>XNU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Darling</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Kernel/XNU/Darling/overview.html">overview.md</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><div>Lang</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Asm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/Asm/asm.html">asm.md</a></li><li class="chapter-item "><div>riscv</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/Asm/riscv/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../Lang/awk.html">AWK</a></li><li class="chapter-item "><a href="../Lang/bc.html">BC</a></li><li class="chapter-item "><div>C.f</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/C.f/macro.html">macro.md</a></li></ol></li><li class="chapter-item "><div>Dot</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/Dot/overview.html">overview.md</a></li><li class="chapter-item "><a href="../Lang/Dot/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/IR/1999.JVM_Specification.html">1999.JVM_Specification.md</a></li><li class="chapter-item "><a href="../Lang/IR/2000.llvm.lattner.master_thesis.241.html">2000.llvm.lattner.master_thesis.241.md</a></li><li class="chapter-item "><a href="../Lang/IR/2004.llvm.lattner.cgo.4340.html">2004.llvm.lattner.cgo.4340.md</a></li><li class="chapter-item "><a href="../Lang/IR/2013.importance.chow...html">2013.importance.chow...md</a></li><li class="chapter-item "><div>Common2</div></li><li class="chapter-item "><a href="../Lang/IR/LLVM-IR.html">LLVM-IR.md</a></li><li class="chapter-item "><a href="../Lang/IR/MapleIRDesign.html">Introduction </a></li></ol></li><li class="chapter-item "><div>JS</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/JS/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Latex</div></li><li class="chapter-item "><div>Lisp</div></li><li class="chapter-item "><div>Py</div></li><li class="chapter-item "><div>SMT-LIB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/SMT-LIB/2012.smt_lib_v2.cok..47.html">2012.smt_lib_v2.cok..47.md</a></li></ol></li><li class="chapter-item "><div>WebAsm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lang/WebAsm/2017.intro.haas.pldi.194.html">2017.intro.haas.pldi.194.md</a></li><li class="chapter-item "><a href="../Lang/WebAsm/linux_desktop.html">Web Assembly and Linux GUI (GUI Shell)</a></li><li class="chapter-item "><a href="../Lang/WebAsm/overview.html">overview.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Lib</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Glibc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lib/Glibc/glibc.html">glibc.md</a></li><li class="chapter-item "><a href="../Lib/Glibc/mmap.html">mmap特性</a></li><li class="chapter-item "><a href="../Lib/Glibc/pthread.html">pthread.md</a></li><li class="chapter-item "><a href="../Lib/Glibc/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>igraph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lib/igraph/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Libc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Lib/Libc/Musl/index.html">Musl</a></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Mem/cat.html">cat.md</a></li><li class="chapter-item "><div>model</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Mem/model/2017.memalloy.wickerson.popl.77.html">2017.memalloy.wickerson.popl.77.md</a></li></ol></li><li class="chapter-item "><a href="../Mem/order.html">C++11访存顺序</a></li><li class="chapter-item "><a href="../Mem/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>Opinions</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Opinions/notes.html">notes.md</a></li><li class="chapter-item "><a href="../Opinions/openEcoSys.html">openEcoSys.md</a></li></ol></li><li class="chapter-item "><div>other_read_list</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../other_read_list/cambridge.html">Cambrige Advanced Topics in Computer Architecture Reading List</a></li><li class="chapter-item "><a href="../other_read_list/stanford/index.html">stanford</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../other_read_list/stanford/1999.codesigned_vm.smith.iwia.html">1999.codesigned_vm.smith.iwia.md</a></li><li class="chapter-item "><a href="../other_read_list/stanford/2001.vm_intro.smith.html">2001.vm_intro.smith.md</a></li><li class="chapter-item "><a href="../other_read_list/stanford/2002.vector_vs_ss.kozyrakis.micro.html">2002.vector_vs_ss.kozyrakis.micro.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Perf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Perf/flamegraph.html">flamegraph.md</a></li></ol></li><li class="chapter-item "><div>PoSh</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../PoSh/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../Proj/index.html">Proj</a></li><li class="chapter-item "><div>Pwr</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Pwr/2009.mcpat.li.micro.2319.html">2009.mcpat.li.micro.2319.md</a></li></ol></li><li class="chapter-item "><a href="../QnA-Daliy.html">QnA-Daliy.md</a></li><li class="chapter-item "><div>Repos</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Repos/llvm-tutor.html">llvm-tutor.md</a></li></ol></li><li class="chapter-item "><div>Sandbox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Sandbox/chroot.html">chroot.md</a></li><li class="chapter-item "><div>Docker</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Sandbox/Docker/Overview.html">Overview.md</a></li><li class="chapter-item "><a href="../Sandbox/Docker/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../Sandbox/proot.html">proot.md</a></li></ol></li><li class="chapter-item expanded "><a href="../scripts/index.html" class="active">scripts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bash</div></li><li class="chapter-item "><div>nix</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>shell_gem5</div></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>Sim</div></li><li class="chapter-item "><div>Softwares</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Softwares/ocrmypdf.html">ocrmypdf.md</a></li><li class="chapter-item "><a href="../Softwares/pandoc.html">pandoc.md</a></li><li class="chapter-item "><a href="../Softwares/tree_timeline_note.html">tree_timeline_note.md</a></li><li class="chapter-item "><div>Vim</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Softwares/Vim/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../SPIN.html">SPIN.md</a></li><li class="chapter-item "><div>SQL</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../SQL/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>SymExec</div></li><li class="chapter-item "><div>Temp</div></li><li class="chapter-item "><div>uArch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>TLB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../uArch/TLB/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Virt</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Virt/1988.386.smith.programmers_journal..html">1988.386.smith.programmers_journal..md</a></li><li class="chapter-item "><a href="../Virt/2002.esx.waldspurger.opsr.1402.html">2002.esx.waldspurger.opsr.1402.md</a></li><li class="chapter-item "><a href="../Virt/2003.xen.barham.opsr.6475.html">2003.xen.barham.opsr.6475.md</a></li><li class="chapter-item "><a href="../Virt/2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.html">2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.md</a></li><li class="chapter-item "><a href="../Virt/2006.cmp_soft_hard_x86.adams.asplos.700.html">2006.cmp_soft_hard_x86.adams.asplos.700.md</a></li><li class="chapter-item "><a href="../Virt/2012.dune.belay.osdi.215.html">2012.dune.belay.osdi.215.md</a></li><li class="chapter-item "><div>addr_trans</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Virt/addr_trans/2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.html">2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Virt/BT/2016.cross_arch_captive.spink.taco.3.html">2016.cross_arch_captive.spink.taco.3.md</a></li><li class="chapter-item "><a href="../Virt/BT/2019.cross_arch_captive.spink.usenix.1.html">2019.cross_arch_captive.spink.usenix.1.md</a></li></ol></li><li class="chapter-item "><a href="../Virt/overview.html">overview.md</a></li><li class="chapter-item "><div>virtualBox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../Virt/virtualBox/install.html">install.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Write</div></li><li class="chapter-item "><a href="../X11/index.html">X11</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../X11/windowManage.html">windowManage.md</a></li></ol></li><li class="chapter-item "><div>行业报告</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LF</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../行业报告/LF/2020-Linux-Foundation-Annual-Report_120520.html">2020-Linux-Foundation-Annual-Report_120520.md</a></li><li class="chapter-item "><a href="../行业报告/LF/FINOS-business-value-of-open-source.html">FINOS-business-value-of-open-source.md</a></li></ol></li><li class="chapter-item "><div>Nix</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../行业报告/Nix/2021.summur.html">2021.summur.md</a></li></ol></li><li class="chapter-item "><div>企业年报</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>apple</div></li><li class="chapter-item "><div>华为</div></li><li class="chapter-item "><div>海信</div></li><li class="chapter-item "><div>联想</div></li></ol></li><li class="chapter-item "><div>信通院</div></li><li class="chapter-item "><div>国家</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../行业报告/国家/2006_2022.国家中长期科学和技术发展规划纲要.html">国家中长期科学和技术发展规划纲要（2006━2020年）</a></li></ol></li><li class="chapter-item "><div>网信自主创新</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../行业报告/网信自主创新/2020.html">2020.md</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="shuimitao">水蜜桃</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">xieby1&#x27;s notes</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/xieby1/xieby1.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="my-scripts"><a class="header" href="#my-scripts">My Scripts</a></h1>
<h2 id="bash-scripts"><a class="header" href="#bash-scripts">Bash Scripts</a></h2>
<h3 id="allfilessh"><a class="header" href="#allfilessh">allfiles.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# ability to ignore some file
if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;un-hidden files&quot;
    exit
fi

find . \( ! -regex '.*/\..*' \) -type f
</code></pre>
<h3 id="asmsh"><a class="header" href="#asmsh">asm.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# input: native assmblies
# output: native machine codes
CMD=&quot;${0##*/}&quot;
usage() {
    echo &quot;asm =&gt; bin&quot;
    echo &quot;Usage: ${CMD} [-h] &lt;asm&gt;&quot;
    echo &quot;  Convert &lt;asm&gt; to machine code, by GNU assembler 'as'.&quot;
    echo &quot;Symbol needs to be escaped:&quot;
    echo &quot;  dolar (\\\$), hash tag (\\#), simicolon (\\;), slash (\\\\)&quot;
    echo &quot;Example:&quot;
    echo &quot;  ${CMD} \&quot;int \\\$0x80\&quot;&quot;
    echo &quot;  ${CMD} \&quot;add \\\$12, %eax\&quot;&quot;
    echo &quot;  ${CMD} \&quot;nop\\nnop\&quot;&quot;
    echo &quot;  ${CMD} \&quot;nop\\;nop\&quot;&quot;
    exit 0
}
if [[ $# -lt 1 ]]
then
    usage
fi
if [[ $1 == &quot;-h&quot; ]]
then
    usage
fi

echo -e &quot;$@&quot; | as -al --32 -o /dev/null
</code></pre>
<h3 id="ffsh"><a class="header" href="#ffsh">ff.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# This script does not use the fzf to search,
# instead it use `rg` (case-ignored mode) to search,
# fzf is just a selector or a UI infrastructure to call `rg`
# From https://github.com/junegunn/fzf/wiki/Examples#searching-file-contents
##
# Interactive search.
# Usage: `ff` or `ff &lt;folder&gt;`.
#

if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;fuzzy find&quot;
    exit
fi

[[ -n $1 ]] &amp;&amp; cd $1 # go to provided folder or noop
RG_DEFAULT_COMMAND=&quot;rg -i -l --hidden --no-ignore-vcs --sortr path&quot;

selected=$(
FZF_DEFAULT_COMMAND=&quot;rg --files&quot; fzf \
  -m \
  -e \
  --ansi \
  --phony \
  --reverse \
  --bind &quot;ctrl-a:select-all&quot; \
  --bind &quot;f12:execute-silent:(subl -b {})&quot; \
  --bind &quot;change:reload:$RG_DEFAULT_COMMAND {q} || true&quot; \
  --preview &quot;rg -i --pretty --context 2 {q} {}&quot; | cut -d&quot;:&quot; -f1,2
)

echo &quot;${selected}&quot;
# [[ -n $selected ]] &amp;&amp; gedit $selected # open multiple files in editor 
</code></pre>
<h3 id="formatxmlsh"><a class="header" href="#formatxmlsh">formatxml.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;${0##*/} &lt;xml_file&gt;&quot;
    echo &quot;  Format xml file in place.&quot;
    echo &quot;  If the file extension is .drawio,&quot;
    echo &quot;  this script will try to uncompress it first.&quot;
    exit
fi

IN=$1
BAK=${1%.*}.bak.${1##*.}
mv &quot;$IN&quot; &quot;$BAK&quot;
if [[ &quot;${IN##*.}&quot; == &quot;drawio&quot; ]]
then
    drawio -u -x -f xml &quot;$BAK&quot; &amp;&gt; /dev/null
    xmllint --format &quot;${BAK%.*}.xml&quot; &gt; &quot;$IN&quot;
    rm -f &quot;${BAK%.*}.xml&quot;
else
    xmllint --format &quot;$BAK&quot; &gt; &quot;$IN&quot;
fi
mv &quot;$BAK&quot; &quot;/tmp/${IN##*/}&quot;
</code></pre>
<h3 id="grepsh"><a class="header" href="#grepsh">grep.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;my grep&quot;
    exit
fi

EXTRA_OPTION=(
    --color=always
    --line-number
)

EXCLUDE_BASIC=(
    -I
    --exclude=&quot;*.html&quot;
    --exclude=&quot;*.js&quot;
    --exclude=&quot;*.svg&quot;
    --exclude=&quot;*.obj&quot;
    --exclude=&quot;*.json&quot;
    --exclude=&quot;*.drawio&quot;
    --exclude=&quot;*.xml&quot;
    --exclude=&quot;*.css&quot;
    --exclude=&quot;*.csv&quot;
    --exclude=&quot;tags&quot;
    --exclude-dir=&quot;expm&quot;
    --exclude-dir=&quot;.git&quot;
    --exclude-dir=&quot;.stversions&quot;
)

grep &quot;$1&quot; . -r \
    ${EXTRA_OPTION[@]} \
    ${EXCLUDE_BASIC[@]} \
    ${@:2}
</code></pre>
<h3 id="ldd-grepsh"><a class="header" href="#ldd-grepsh">ldd-grep.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# input: the file (or diretory) to be examed,
# output: its (or files under the directory, recursively) depending lib

# default value
TARGET=.

while [[ ${OPTIND} -le $# ]]; do
    getopts &quot;ho:&quot; opt
    case &quot;${opt}&quot; in
        h)
            echo &quot;gather dep so&quot;
            echo &quot;Usage: ${0##*/} [-o DEST] [ FILE | DIR ]&quot;
            echo &quot;  List the lib dependencies of FILE or files under DIR&quot;
            echo &quot;  If FILE or DIR is not specified, '.' will be used&quot;
            echo &quot;  If -o DEST is specifed, dependencies will be copied to DEST&quot;
            exit 0
            ;;
        o)
            if [[ -e ${OPTARG} ]]; then
                if [[ -d ${OPTARG} ]]; then
                    DEST_DIR=${OPTARG}
                else
                    echo &quot;-o ${OPTARG} should be a directory&quot;
                    exit 1
                fi
            else
                echo &quot;${OPTARG} not exists&quot;
                exit 1
            fi
            ;;
        ?)
            TARGET=${!OPTIND}
            shift
            ;;
        *)
            echo &quot;unknown options arg${OPTIND} ${OPTARG}&quot;
            exit 1
            ;;
    esac
done

ldd_real_path()
{
    ldd &quot;$1&quot; 2&gt; /dev/null |\
        sed 's/.*=&gt;//' |\
        grep -E -o '\/.*\s' |\
        sed 's/\s//'
}

get_dependencies()
{
    if [[ -z ${DEST_DIR} ]]; then
        ldd_real_path $1
    else
        ldd_real_path $1 | while read DEP; do
            LIB_NEW_PATH=&quot;${DEST_DIR}/${DEP#/}&quot;
            LIB_NEW_DIR=&quot;${LIB_NEW_PATH%/*}/&quot;
            mkdir -p ${LIB_NEW_DIR}
            cp -n -v ${DEP} ${LIB_NEW_DIR}
        done
    fi
}

echo &quot;ldd-grep from ${TARGET} to ${DEST_DIR}&quot;

if [[ -d ${TARGET} ]]; then
    for FILE in $(find ${TARGET} -type f); do
        get_dependencies ${FILE}
    done
elif [[ -f ${TARGET} ]]; then
    get_dependencies ${TARGET}
fi
</code></pre>
<h3 id="ls-gitsh"><a class="header" href="#ls-gitsh">ls-git.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# ls files &amp; directories only contaion in git repo
if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;ls files in git&quot;
    exit
fi
FILES_IN_GIT=$(git ls-files .)
if [[ $? -ne 0 ]]; then
    exit $?
fi
echo ${FILES_IN_GIT} | \
    tr &quot; &quot; &quot;\n&quot; | \
    sed s,/.*,, | \
    uniq | \
    xargs ls -d --color=auto $*
</code></pre>
<h3 id="nbd-mountsh"><a class="header" href="#nbd-mountsh">nbd-mount.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

# reference to https://askubuntu.com/questions/19430/mount-a-virtualbox-drive-image-vdi
# input: disk image to be mounted, mount destination folder

# clean should be done manually,
## sudo umount MOUNT_DIR
## sudo qemu-nbd -d /dev/nbd/nbd0p1

usage() {
    echo &quot;nbd mount&quot;
    echo &quot;Usage: ${0##*/} DISK_IMAGE [-o MOUNT_DIR]&quot;
    echo &quot;  export DISK_IMAGE using the NBD protocol&quot;
    echo &quot;  mount the nbd dev to MOUNT_DIR&quot;
    echo &quot;  default MOUNT_DIR is c/, not create dir if c/ not exist&quot;
    exit 0
}

if [[ $# -lt 1 ]]
then
    usage
fi

while [[ ${OPTIND} -le $# ]]; do
    getopts &quot;ho:&quot; opt
    case &quot;${opt}&quot; in
        h)
            usage
            ;;
        o)
            MOUNT_DIR=${OPTARG}
            ;;
        ?)
            DISK_IMAGE=${!OPTIND}
            shift
            ;;
        *)
            echo &quot;unknown arg${OPTIND} ${OPTARG}&quot;
            exit 1
            ;;
    esac
done

if [[ -z &quot;${DISK_IMAGE}&quot; ]]; then
    echo &quot;DISK_IMAGE not specified&quot;
    exit 1
fi
if [[ -z &quot;${MOUNT_DIR}&quot; ]]; then
    MOUNT_DIR=c
fi

# check nbd kernel module
if [[ ! -e /dev/nbd0 ]]; then
    sudo modprobe nbd max_part=16
fi
# create nbd
  # TODO: check available /dev/nbd
sudo qemu-nbd -c /dev/nbd0 ${DISK_IMAGE}
# mount
sudo mount /dev/nbd0p1 ${MOUNT_DIR}
# TODO: umount
# TODO: delete nbd
</code></pre>
<h3 id="pdbsfsh"><a class="header" href="#pdbsfsh">pdbsf.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;pdb src file&quot;
    exit
fi
CVDUMP=~/Softwares/Packages/Kernel/Windows/tools/cvdump.exe

wine &quot;${CVDUMP}&quot; -sf $1
</code></pre>
<h3 id="pdfbookmarksh"><a class="header" href="#pdfbookmarksh">pdfbookmark.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

echoHelp() {
    echo &quot;md &lt;=&gt; pdf toc&quot;
    echo &quot;Usage:&quot;
    echo &quot;  Extract Bookmarks from pdf: ${0##*/} FILE.pdf [FILE.md]&quot; 
    echo &quot;  Update Bookmarks to pdf:  ${0##*/} FILE.md FILE.pdf&quot;
    exit 0
}

# default value
BKMRK=&quot;Bookmark&quot;
BEGIN=&quot;${BKMRK}Begin&quot;
TITLE=&quot;${BKMRK}Title&quot;
LEVEL=&quot;${BKMRK}Level&quot;
PGNUM=&quot;${BKMRK}PageNumber&quot;
## markdown default value
INDENTNUM=2
INDENTSYM=&quot;*&quot;
INDENTSYM_ESC=&quot;\*&quot;
PGNUMDELIMIT=&quot;@&quot;

# value
TITLEV=&quot;&quot;
LEVELV=&quot;&quot;
PGNUMV=&quot;&quot;

pdfdata_to_markdown() {
    #for LINE in $1; do
    cat $1 | while read LINE; do
        #echo ${LINE}
        case ${LINE} in
            ${BEGIN}*)
                TITLEV=&quot;&quot;
                LEVELV=&quot;&quot;
                PGNUMV=&quot;&quot;
                ;;
            ${TITLE}*)
                TITLEV=${LINE#&quot;${TITLE}: &quot;}
                ;;
            ${LEVEL}*)
                LEVELV=${LINE#&quot;${LEVEL}: &quot;}
                ;;
            ${PGNUM}*)
                PGNUMV=${LINE#&quot;${PGNUM}: &quot;}
                output=&quot;&quot;
                while [[ ${#output} -lt $(((LEVELV - 1)*INDENTNUM)) ]]; do
                    output=&quot;${output} &quot;
                done
                output=&quot;${output}${INDENTSYM} ${TITLEV} ${PGNUMDELIMIT}${PGNUMV}&quot;
                echo -e &quot;${output}&quot;
                ;;
        esac
    done
}

markdown_to_pdfdata() {
    IFS=''
    cat $1 | while read LINE; do
    indentStr=&quot;${LINE%%${INDENTSYM_ESC}*}&quot;
    indentStrLen=&quot;${#indentStr}&quot;
    LEVELV=$((indentStrLen / INDENTNUM + 1))

    PGNUMV=&quot;${LINE##*${PGNUMDELIMIT}}&quot;

    TITLEV=&quot;${LINE#*${INDENTSYM_ESC} }&quot;
    TITLEV=&quot;${TITLEV%${PGNUMDELIMIT}*}&quot;

    echo &quot;${BEGIN}&quot;
    echo &quot;${TITLE}: ${TITLEV}&quot;
    echo &quot;${LEVEL}: ${LEVELV}&quot;
    echo &quot;${PGNUM}: ${PGNUMV}&quot;
done
}

# main function
FILE1=&quot;&quot;
FILE2=&quot;&quot;

while [[ ${OPTIND} -le $# ]]; do
    getopts &quot;h&quot; opt
    case &quot;${opt}&quot; in
        h)
            echoHelp
            ;;
        ?)
            if [[ -z ${FILE1} ]]; then
                FILE1=${!OPTIND}
            elif [[ -z ${FILE2} ]]; then
                FILE2=${!OPTIND}
            else
                echoHelp
            fi
            shift
            ;;
    esac
done

## create temporary directory
tempDir=&quot;/dev/shm/${0##*/}&quot;
if [[ ! -d ${tempDir} ]]; then
    mkdir ${tempDir}
fi

## check input files
if [[ -z ${FILE1} ]]; then
    echoHelp
fi
if [[ -z ${FILE2} ]]; then
    FILE2=${FILE1%.*}.md
fi

tempFile=${tempDir}/${FILE2##*/}
tempFile=${tempFile%.*}
if [[ ${FILE1##*.} == &quot;md&quot; ]]; then
### md to pdf
    pdftk ${FILE2} dump_data_utf8 output ${tempFile}.dumpdata

    #### clear bookmark info
    grep -v &quot;${BKMRK}&quot; ${tempFile}.dumpdata &gt; ${tempFile}.cleardata
    cp ${tempFile}.cleardata ${tempFile}.newdata

    #### append bookmark info
    markdown_to_pdfdata ${FILE1} &gt;&gt; ${tempFile}.newdata
    pdftk ${FILE2} update_info ${tempFile}.newdata output ${FILE2%.*}.toc.pdf
elif [[ ${FILE2##*.} == &quot;md&quot; ]]; then
    pdftk ${FILE1} dump_data_utf8 output ${tempFile}.dumpdata

    pdfdata_to_markdown ${tempFile}.dumpdata &gt; ${FILE2}
else
    echoHelp
fi

## clear tempDir
#rm -r ${tempDir}
</code></pre>
<h3 id="pwrthrsh"><a class="header" href="#pwrthrsh">pwrThr.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

# Toggle Lenovo Power Threshold
# References
#  https://askubuntu.com/questions/1038471/problem-with-lenovo-battery-threshold
if [[ $1 == &quot;-h&quot; ]]
then
    echo &quot;toggle pwrThr&quot;
    exit
fi

INTERFACE=&quot;/sys/bus/platform/drivers/ideapad_acpi/VPC2004:00/conservation_mode&quot;
THRSTATE=$(cat &quot;${INTERFACE}&quot;)

# redirection is done by shell, so `sudo echo XXX &gt;&gt; XXX` is not work
# refers to: https://askubuntu.com/questions/230476/how-to-solve-permission-denied-when-using-sudo-with-redirection-in-bash
sudo bash -c &quot;echo $((! THRSTATE)) &gt; ${INTERFACE}&quot;

echo &quot;Power Threshold $THRSTATE =&gt; $((! THRSTATE))&quot;
</code></pre>
<h3 id="quteappsh"><a class="header" href="#quteappsh">quteapp.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

usage()
{
    echo &quot;Usage: ${0##*/} &lt;window&gt; &lt;url&gt;&quot;
    exit 0
}

if [[ $# -lt 2 || $1 == &quot;-h&quot; ]]
then
    usage
fi

WID=$(xdotool search --onlyvisible --name &quot;${1}.*qutebrowser&quot;)
URL=$2

if [[ -z ${WID} ]]
then
    qutebrowser &quot;$URL&quot;
else
    xdotool set_desktop_for_window ${WID} $(xdotool get_desktop)
    xdotool windowactivate ${WID}
fi
</code></pre>
<h3 id="resize_gifsh"><a class="header" href="#resize_gifsh">resize_gif.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

if [[ $# -eq 0 ||  $1 == &quot;-h&quot; || $1 == &quot;--help&quot; ]]
then
    echo &quot;gif&lt;=10M&quot;
    echo &quot;Usage: ${0##*/} &lt;xxx.gif&gt;&quot;
    echo &quot;  Compress &lt;xxx.gif&gt; under and near 10M,&quot;
    echo &quot;  output to &lt;xxx.resized.gif&gt;&quot;
    exit 0
fi

# functions
get_pic_size()
{
    du &quot;$1&quot; | sed -n 's/\([0-9]*\).*/\1/p'
}

get_pic_width()
{
    identify &quot;$1&quot; | sed -n '1s/\S*\s\S*\s\([0-9]*\)x[0-9]*.*/\1/p'
}

get_pic_height()
{
    identify &quot;$1&quot; | sed -n '1s/\S*\s\S*\s[0-9]*x\([0-9]*\).*/\1/p'
}

# constants
VERBOSE=1
PIC_ORIG=$1
PIC_RESZ=${PIC_ORIG%.*}.resized.${PIC_ORIG##*.}
TEMP_DIR=${HOME}/.miao_temp
PIC_TEMP=${TEMP_DIR}/${PIC_RESZ##*/}
PIC_SIZE_LIMIT=9600
PIC_ORIG_SIZE=$(get_pic_size &quot;$PIC_ORIG&quot;)
PIC_ORIG_WIDTH=$(get_pic_width &quot;$PIC_ORIG&quot;)
PIC_ORIG_HEIGHT=$(get_pic_height &quot;$PIC_ORIG&quot;)
# variables
PIC_RESZ_SIZE=$PIC_ORIG_SIZE
PIC_RESZ_WIDTH=$PIC_ORIG_WIDTH

#echo size $PIC_RESZ_SIZE width $PIC_RESZ_WIDTH

mkdir -p ${TEMP_DIR}

while [[ $PIC_RESZ_SIZE -gt $PIC_SIZE_LIMIT ]]
do
    BC=&quot;sqrt(0.9*$PIC_RESZ_WIDTH*$PIC_RESZ_WIDTH*$PIC_SIZE_LIMIT/$PIC_RESZ_SIZE)&quot;
    PIC_RESZ_WIDTH=$(echo $BC | bc)
    convert $PIC_ORIG -resize ${PIC_RESZ_WIDTH}x${PIC_ORIG_HEIGHT} $PIC_TEMP
    PIC_RESZ_SIZE=$(get_pic_size $PIC_TEMP)
    PIC_RESZ_WIDTH=$(get_pic_width $PIC_TEMP)
#    echo size $PIC_RESZ_SIZE width $PIC_RESZ_WIDTH
done

mv $PIC_TEMP $PIC_RESZ
rm -rf ${TEMP_DIR}
</code></pre>
<h3 id="singletonsh"><a class="header" href="#singletonsh">singleton.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash
# based on quteapp.sh
usage()
{
    echo &quot;Usage: ${0##*/} &lt;window&gt; &lt;command and its args&gt;&quot;
    echo &quot;  Only start a app once, if the app is running&quot;
    echo &quot;  then bring it to foreground&quot;
    exit 0
}

if [[ $# -lt 2 || $1 == &quot;-h&quot; ]]
then
    usage
fi


if [[ &quot;$1&quot; == &quot;kdeconnect.app&quot; ]]
then
    WID=$(xdotool search --classname &quot;$1&quot;)
else
    WID=$(xdotool search --onlyvisible --name &quot;$1&quot;)
fi

if [[ -z ${WID} ]]
then
    eval &quot;${@:2}&quot;
else
    for WIN in $WID
    do
        xdotool set_desktop_for_window ${WIN} $(xdotool get_desktop)
        xdotool windowactivate ${WIN}
    done
fi
</code></pre>
<h3 id="tar-reposh"><a class="header" href="#tar-reposh">tar-repo.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

usage()
{
    echo &quot;tar git files&quot;
    echo &quot;Usage: ${0##*/} [-h] &lt;DIR&gt;&quot;
    echo &quot;  tar git repo &lt;DIR&gt;, exclude patterns from&quot;
    echo &quot;  * global gitignore&quot;
    echo &quot;  * repo's gitignore&quot;
    echo &quot;  * repo's git/info/exclude&quot;
    echo &quot;  output to &lt;DIR&gt;.tar.gz&quot;
    exit 0
}

if [[ $# -lt 1 ]]
then
    usage
fi
if [[ $1 == &quot;-h&quot; ]]
then
    usage
fi

GI=~/Documents/Config/ignore/git
RI=&quot;$1/.gitignore&quot;
RE=&quot;$1/.git/info/exclude&quot;

tar \
    -X &quot;${GI}&quot; \
    -X &quot;${RI}&quot; \
    -X &quot;${RE}&quot; \
    -czf &quot;${1%/}.tar.gz&quot; \
    &quot;$1&quot;

</code></pre>
<h3 id="ubuntush"><a class="header" href="#ubuntush">ubuntu.sh</a></h3>
<pre><code class="language-bash">#!/usr/bin/env bash

# DONE: sudo broken inside container
#       https://www.redhat.com/sysadmin/sudo-rootless-podman
#   tldr: not recommend use su/sudo in rootless container

# create image
CREATE_IMAGE() {
    VER=$1

    mkdir -p /tmp/u${VER}
    echo &quot;FROM ubuntu:${VER}.04&quot; &gt; /tmp/u${VER}/Dockerfile

    # buildah default not save intermediate layers,
    # it seems podman layers default true?
    # ~~one RUN command, avoid redundent layers~~
    echo &quot;RUN echo 'root:miqbxgyfdA.PY' | chpasswd -e&quot; &gt;&gt; /tmp/u${VER}/Dockerfile
    echo &quot;RUN useradd -u ${UID} -G users,sudo -p miqbxgyfdA.PY -s /bin/bash xieby1&quot; &gt;&gt; /tmp/u${VER}/Dockerfile
    echo &quot;RUN sed -i 's/http.*com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g' /etc/apt/sources.list&quot; &gt;&gt; /tmp/u${VER}/Dockerfile
    # echo &quot;RUN echo 'Acquire::http::Proxy \&quot;http://127.0.0.1:8889\&quot;;' &gt; /etc/apt/apt.conf&quot; &gt;&gt; /tmp/u${VER}/Dockerfile
    echo &quot;RUN apt update&quot; &gt;&gt; /tmp/u${VER}/Dockerfile
    echo &quot;RUN apt install -y sudo tmux&quot; &gt;&gt; /tmp/u${VER}/Dockerfile

    sudo podman build --network=host -t u${VER} /tmp/u${VER}
}

# podman volumes always owned by root:
#   https://github.com/containers/podman/issues/2898
CREATE_CONTAINER() {
    VER=$1

    CMD=(
    &quot;sudo&quot;
    &quot;podman&quot; &quot;run&quot;

    &quot;-u&quot; &quot;xieby1&quot; # [root container]
    # &quot;--userns=keep-id&quot; # [rootless container]

    #&quot;-d&quot; # deamon, not exit
    &quot;--rm&quot; # exit then remove this container
    &quot;--env&quot; &quot;debian_chroot=u${VER}&quot;
    # &quot;-h&quot; &quot;container-u${VER}&quot; # host name
    &quot;-h&quot; &quot;localhost&quot; # host name # avoid edit /etc/hosts
    &quot;--name='u${VER}'&quot; # container name

    &quot;-v&quot; &quot;/home/xieby1:/home/xieby1&quot;
    &quot;-v&quot; &quot;/nix:/nix&quot; # make sure symbol links in home work

    &quot;-w&quot; &quot;/home/xieby1&quot; # working directory

    # this will cause guest /etc/hosts override by host's
    # use host ip instead, see host's ip address
    &quot;--network=host&quot; # use host network stack

    &quot;-it&quot;
    &quot;u${VER}&quot;
#    &quot;/usr/bin/tmux&quot;
    )

    eval &quot;${CMD[@]}&quot;
}


OPTIONS=(
    &quot;-h&quot;
    &quot;-c&quot;
    &quot;-v&quot;
)

CREATE=&quot;no&quot;
VER=22
while [[ ${OPTIND} -le $# ]]
do
    getopts &quot;lhcv:&quot; opt
    case &quot;${opt}&quot; in
    l)
        echo &quot;${OPTIONS[@]}&quot;
        exit 0;
    ;;
    h)
        echo &quot;ubuntu container&quot;
        echo &quot;Usage: ${0##*/} [-h] [-c] [-v &lt;VER&gt;]&quot;
        echo &quot;  run with no arg: enter a ubuntu container&quot;
        echo &quot;  -c: reate a ubuntu container image&quot;
        echo &quot;  -h: show this help&quot;
        echo &quot;  -v &lt;VER&gt;: set ubuntu version, default is 20&quot;
        exit 0;
    ;;
    c)
        CREATE=&quot;yes&quot;
    ;;
    v)
        VER=${OPTARG}
        echo ${OPTARG}
    ;;
    *)
        shift
    esac
done

if [[ &quot;${CREATE}&quot; == &quot;yes&quot; ]]
then
    CREATE_IMAGE ${VER}
else
    CREATE_CONTAINER ${VER}
fi
</code></pre>
<h2 id="nix-scripts"><a class="header" href="#nix-scripts">Nix Scripts</a></h2>
<h3 id="androidnix"><a class="header" href="#androidnix">android.nix</a></h3>
<pre><code class="language-nix"># run `nix-build &lt;this file&gt;`

# https://nixos.wiki/wiki/Android
#  Building Android applications with the Nix package manager: https://sandervanderburg.blogspot.com/2014/02/reproducing-android-app-deployments-or.html

with import /home/xieby1/Codes/nixpkgs {
# with import /home/xieby1/temp-nixpkgs {
  config.android_sdk.accept_license = true;
};

androidenv.emulateApp {
  name = &quot;diary&quot;;
  app = ./org.billthefarmer.diary_187.apk;
  enableGPU = false;
  # get these info by `nixpkgs/pkgs/development/mobile/androidenv/repo.json`
  # see if installed `sdkmanager --list`
  platformVersion = &quot;18&quot;;
  abiVersion = &quot;x86&quot;;
  systemImageType = &quot;google_apis&quot;;

  package = &quot;org.billthefarmer.diary&quot;;
  activity = &quot;org.billthefarmer.diary.Diary&quot;;

  avdHomeDir = &quot;$HOME/.diary&quot;;
  sdkExtraArgs = {
    emulatorVersion = &quot;30.8.4&quot;;
    includeSystemImages = true;
  };
}
</code></pre>
<h3 id="libllvm13_debugnix"><a class="header" href="#libllvm13_debugnix">libllvm13_debug.nix</a></h3>
<pre><code class="language-nix"># nix-env -f ./libllvm13_debug.nix -i
with (import &lt;nixpkgs&gt; {});
(llvmPackages_13.libllvm.override {
  debugVersion = true;
})
</code></pre>
<h3 id="pkgs2105_cross_static_hellonix"><a class="header" href="#pkgs2105_cross_static_hellonix">pkgs2105_cross_static_hello.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env nix-build
let
  pkgs = import (builtins.fetchTarball {
    url = &quot;https://github.com/NixOS/nixpkgs/archive/e60c3e2abb8ae9df3d89820c706cc736fad01ff7.tar.gz&quot;;
    sha256 = &quot;0vyjpf1jw4cvw7kfbk055faq08q4swz6v1h2mf9zw4r8frhqa73w&quot;;
  }) {};
in
pkgs.pkgsCross.aarch64-multiplatform.pkgsStatic.glib
</code></pre>
<h3 id="pkgs_coremarknix"><a class="header" href="#pkgs_coremarknix">pkgs_coremark.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env nix-build
let
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.pkgsStatic.stdenv.mkDerivation {
  name = &quot;coremark&quot;;
  src = pkgs.fetchFromGitHub {
    owner = &quot;eembc&quot;;
    repo = &quot;coremark&quot;;
    rev = &quot;d26d6fdcefa1f9107ddde70024b73325bfe50ed2&quot;;
    sha256 = &quot;0kd6bnrnd3f325ypxzn0w5ii4fmc98h16sbvvjikvzhm78y60wz3&quot;;
  };
  preBuild = ''
    export CFLAGS=&quot;-DHAS_FLOAT=0&quot;
  '';
  buildFlags = [
    &quot;compile&quot;
  ];
  installPhase = ''
    mkdir -p $out/bin
    find . -maxdepth 1 -type f -executable -print0 | xargs -0 -I {} mv {} $out/bin/
  '';
}
</code></pre>
<h3 id="pkgs_cross_mipsnix"><a class="header" href="#pkgs_cross_mipsnix">pkgs_cross_mips.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env -S nix-env -i -f
# xieby1: 2022.05.16
with (import &lt;nixpkgs&gt; {crossSystem = &quot;mips-linux&quot;;}); {
  gdb = lib.lowPrio buildPackages.gdb;
  gcc = lib.lowPrio buildPackages.gcc;
}
</code></pre>
<h3 id="pkgs_docker_tailscalenix"><a class="header" href="#pkgs_docker_tailscalenix">pkgs_docker_tailscale.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env nix-build
let
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.dockerTools.buildImage {
  name = &quot;headscale&quot;;
  tag = &quot;lateset&quot;;
  contents = with pkgs; [
    headscale
  ];
}
</code></pre>
<h3 id="pkgs_qemu_riscv64_staticnix"><a class="header" href="#pkgs_qemu_riscv64_staticnix">pkgs_qemu_riscv64_static.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env nix-build
# xieby1: 2022.05.24
# build static qemu (current version 6.1.1) into ./result/
# $ nix-build &lt;this-file&gt; -A qemu
# build static qemu-3.1.0 into ./result/
# $ nix-build &lt;this-file&gt; -A qemu31
# build and install static qemu
# $ nix-env -i -f &lt;this-file&gt; -A qemu
# build and install static qemu-3.1.0
# $ nix-env -i -f &lt;this-file&gt; -A qemu31
let
  pinnedPkgsSrc = builtins.fetchTarball {
    name = &quot;nixos-static-qemu&quot;;
    url = &quot;https://github.com/nixos/nixpkgs/archive/e7d63bd0d50df412f5a1d8acfa3caae75522e347.tar.gz&quot;;
    sha256 = &quot;132pc4f9ixisyv4117p2jirmlyl6sd76bfaz33rhlcwakg7bhjm7&quot;;
  };
  # pkgs = import pinnedPkgsSrc {};
  # mypkgs = import pinnedPkgsSrc {
  pkgs = import &lt;nixpkgs&gt; {};
  mypkgs = import &lt;nixpkgs&gt; {
    overlays = [(self: super: {

      cdparanoiaIII = super.pkgsStatic.cdparanoiaIII.overrideAttrs (old: {
        preConfigure = old.preConfigure + ''
          cp ${super.gnu-config}/config.sub configure.sub
          cp ${super.gnu-config}/config.guess configure.guess
        '';
        # Makefile needs this to compile static
        STATIC=&quot;TRUE&quot;;
        buildPhase = ''
          make lib
          make cdparanoia
        '';
        preInstallPhases = [&quot;preInstallPhase&quot;];
        preInstallPhase = ''
          sed -i '/so/d' Makefile
        '';
      });

      liburing = super.pkgsStatic.liburing.overrideDerivation (old: {
        configureFlags = &quot;&quot;;
        ENABLE_SHARED = 0;
      });

      # p11-kit cannot be used as a static library
      # https://github.com/p11-glue/p11-kit/issues/355
      p11-kit = super.pkgsMusl.p11-kit;
      # gnutls depends on p11-kit
      gnutls = super.pkgsMusl.gnutls;

      pam = super.pkgsStatic.openpam;

      # support both static and shared
      libselinux = (super.pkgsMusl.libselinux.override {
        libsepol = super.pkgsStatic.libsepol;
      }).overrideAttrs (old: {
         makeFlags = old.makeFlags ++ [
           &quot;LIBDIR=$(out)/lib&quot;
         ];
      });

      glib = (super.pkgsStatic.glib.override {
        meson = pkgs.meson;
        ninja = pkgs.ninja;
        pkg-config = pkgs.pkg-config;
        perl = pkgs.perl;
        python3 = pkgs.python3;
        gettext = pkgs.gettext;
        gtk-doc = pkgs.gtk-doc;
        docbook_xsl = pkgs.docbook_xsl;
        docbook_xml_dtd_45 = pkgs.docbook_xml_dtd_45;
        libxml2 = pkgs.libxml2;
      }).overrideAttrs (old: {
        outputs = super.lib.lists.remove &quot;devdoc&quot; old.outputs;
        buildInputs = old.buildInputs ++ [
          super.pkgsStatic.libsepol
        ];
        preBuild = ''
          sed -i &quot;s/get_option('libmount')/get_option('libmount'), static: true/g&quot; ../meson.build
          sed -i &quot;s/get_option('selinux')/get_option('selinux'), static: true/g&quot; ../meson.build
        '';
        # no devdoc from non-static glibc
        # ${pname} &amp; ${version} is correct due to lazy assignment
        postInstall = pkgs.glib.postInstall;
      });

      gtk3 = super.pkgsStatic.gtk3.override {
        trackerSupport = false;
        cupsSupport = false;
        withGtkDoc = false;

        # nativeBuildInputs
        inherit (pkgs) gettext gobject-introspection makeWrapper meson ninja
        pkg-config python3 sassc docbook_xml_dtd_43 docbook-xsl-nons gtk-doc libxml2;
      };

      qemu = ((super.pkgsStatic.qemu.override {
        alsaSupport = false;
        spiceSupport = false;
        sdlSupport = false;
        smartcardSupport = false;
        gtkSupport = false;
        pulseSupport = false;

        # nativeBuildInputs
        makeWrapper = pkgs.makeWrapper;
        python = pkgs.python3;
        pkg-config = pkgs.pkg-config;
        flex = pkgs.flex;
        bison = pkgs.bison;
        meson = pkgs.meson;
        ninja = pkgs.ninja;
        perl = pkgs.perl;
      }).overrideAttrs (old: {
        nativeBuildInputs = old.nativeBuildInputs ++ [
          pkgs.binutils
          # perl as nativeBuildInputs has been added in nixpkgs master
          # while it is backported to nixpkgs 21.11 (nixos 21.11).
          # If without perl as nativeBuildInputs,
          # ./scripts/shaderinclude.pl can not be patchShebangs'ed.
          pkgs.perl # without it cannot patchShebangs
        ];
        # qemu-6.1.1 has contained sigrtminmax patch, can not be patched again
        patches = builtins.filter (
          x: ! super.lib.hasSuffix &quot;sigrtminmax.patch&quot; x
        ) old.patches;
      })).overrideDerivation (old: let
        # qemu configure uses &quot;--static&quot; instead of standard &quot;--disable-shared&quot; and &quot;--enable-static&quot;
        configureFlags_no_DS = super.lib.lists.remove &quot;--disable-shared&quot; old.configureFlags;
        configureFlags_no_DS_no_ES = super.lib.lists.remove &quot;--enable-static&quot; configureFlags_no_DS;
      in {
        configureFlags = configureFlags_no_DS_no_ES ++ [
          &quot;--static&quot;
          # &quot;--target-list-exclude=&quot;
          &quot;--target-list=x86_64-softmmu&quot;
        ];
      });
    })];
  };
in
{
  inherit (mypkgs.pkgsStatic.pkgsCross.riscv64) qemu;
}
</code></pre>
<h3 id="pkgs_qemu_staticnix"><a class="header" href="#pkgs_qemu_staticnix">pkgs_qemu_static.nix</a></h3>
<pre><code class="language-nix">#!/usr/bin/env nix-build
# xieby1: 2022.05.24
# build static qemu (current version 6.1.1) into ./result/
# $ nix-build &lt;this-file&gt; -A qemu
# build static qemu-3.1.0 into ./result/
# $ nix-build &lt;this-file&gt; -A qemu31
# build and install static qemu
# $ nix-env -i -f &lt;this-file&gt; -A qemu
# build and install static qemu-3.1.0
# $ nix-env -i -f &lt;this-file&gt; -A qemu31
let
  # https://lazamar.co.uk/nix-versions
  pinnedPkgsForQemu31Src = builtins.fetchTarball {
    name = &quot;nixos-20.03-with-qemu-3.1.0&quot;;
    url = &quot;https://github.com/NixOS/nixpkgs/archive/81d4e65891f92e8e72c244da663c83c1e40dc919.tar.gz&quot;;
    sha256 = &quot;0dk1k1zqy2bnp9gsy9mdxk0idkazyvnmqrj2jpbwzfnhjzpmzq1w&quot;;
  };
  pinnedPkgsSrc = builtins.fetchTarball {
    name = &quot;nixos-static-qemu&quot;;
    url = &quot;https://github.com/nixos/nixpkgs/archive/e7d63bd0d50df412f5a1d8acfa3caae75522e347.tar.gz&quot;;
    sha256 = &quot;132pc4f9ixisyv4117p2jirmlyl6sd76bfaz33rhlcwakg7bhjm7&quot;;
  };
  pkgsForQemu31 = import pinnedPkgsForQemu31Src {};
  pkgs = import pinnedPkgsSrc {};
  mypkgs = import pinnedPkgsSrc {
    overlays = [(self: super: {

      cdparanoiaIII = super.pkgsStatic.cdparanoiaIII.overrideAttrs (old: {
        preConfigure = old.preConfigure + ''
          cp ${super.gnu-config}/config.sub configure.sub
          cp ${super.gnu-config}/config.guess configure.guess
        '';
        # Makefile needs this to compile static
        STATIC=&quot;TRUE&quot;;
        buildPhase = ''
          make lib
          make cdparanoia
        '';
        preInstallPhases = [&quot;preInstallPhase&quot;];
        preInstallPhase = ''
          sed -i '/so/d' Makefile
        '';
      });

      liburing = super.pkgsStatic.liburing.overrideDerivation (old: {
        configureFlags = &quot;&quot;;
        ENABLE_SHARED = 0;
      });

      # p11-kit cannot be used as a static library
      # https://github.com/p11-glue/p11-kit/issues/355
      p11-kit = super.pkgsMusl.p11-kit;
      # gnutls depends on p11-kit
      gnutls = super.pkgsMusl.gnutls;

      pam = super.pkgsStatic.openpam;

      # support both static and shared
      libselinux = (super.pkgsMusl.libselinux.override {
        libsepol = super.pkgsStatic.libsepol;
      }).overrideAttrs (old: {
         makeFlags = old.makeFlags ++ [
           &quot;LIBDIR=$(out)/lib&quot;
         ];
      });

      glib = (super.pkgsStatic.glib.override {
        meson = pkgs.meson;
        ninja = pkgs.ninja;
        pkg-config = pkgs.pkg-config;
        perl = pkgs.perl;
        python3 = pkgs.python3;
        gettext = pkgs.gettext;
        gtk-doc = pkgs.gtk-doc;
        docbook_xsl = pkgs.docbook_xsl;
        docbook_xml_dtd_45 = pkgs.docbook_xml_dtd_45;
        libxml2 = pkgs.libxml2;
      }).overrideAttrs (old: {
        outputs = super.lib.lists.remove &quot;devdoc&quot; old.outputs;
        buildInputs = old.buildInputs ++ [
          super.pkgsStatic.libsepol
        ];
        preBuild = ''
          sed -i &quot;s/get_option('libmount')/get_option('libmount'), static: true/g&quot; ../meson.build
          sed -i &quot;s/get_option('selinux')/get_option('selinux'), static: true/g&quot; ../meson.build
        '';
        # no devdoc from non-static glibc
        # ${pname} &amp; ${version} is correct due to lazy assignment
        postInstall = pkgs.glib.postInstall;
      });

      gtk3 = super.pkgsStatic.gtk3.override {
        trackerSupport = false;
        cupsSupport = false;
        withGtkDoc = false;

        # nativeBuildInputs
        inherit (pkgs) gettext gobject-introspection makeWrapper meson ninja
        pkg-config python3 sassc docbook_xml_dtd_43 docbook-xsl-nons gtk-doc libxml2;
      };

      qemu = ((super.pkgsStatic.qemu.override {
        alsaSupport = false;
        spiceSupport = false;
        sdlSupport = false;
        smartcardSupport = false;
        gtkSupport = false;
        pulseSupport = false;

        # nativeBuildInputs
        makeWrapper = pkgs.makeWrapper;
        python = pkgs.python3;
        pkg-config = pkgs.pkg-config;
        flex = pkgs.flex;
        bison = pkgs.bison;
        meson = pkgs.meson;
        ninja = pkgs.ninja;
        perl = pkgs.perl;
      }).overrideAttrs (old: {
        nativeBuildInputs = old.nativeBuildInputs ++ [
          pkgs.binutils
          # perl as nativeBuildInputs has been added in nixpkgs master
          # while it is backported to nixpkgs 21.11 (nixos 21.11).
          # If without perl as nativeBuildInputs,
          # ./scripts/shaderinclude.pl can not be patchShebangs'ed.
          pkgs.perl # without it cannot patchShebangs
        ];
        # qemu-6.1.1 has contained sigrtminmax patch, can not be patched again
        patches = builtins.filter (
          x: ! super.lib.hasSuffix &quot;sigrtminmax.patch&quot; x
        ) old.patches;
      })).overrideDerivation (old: let
        # qemu configure uses &quot;--static&quot; instead of standard &quot;--disable-shared&quot; and &quot;--enable-static&quot;
        configureFlags_no_DS = super.lib.lists.remove &quot;--disable-shared&quot; old.configureFlags;
        configureFlags_no_DS_no_ES = super.lib.lists.remove &quot;--enable-static&quot; configureFlags_no_DS;
      in {
        configureFlags = configureFlags_no_DS_no_ES ++ [
          &quot;--static&quot;
          # &quot;--target-list-exclude=&quot;
          &quot;--target-list=x86_64-softmmu&quot;
        ];
      });

      qemu31 = (((super.callPackage (
        pinnedPkgsForQemu31Src + &quot;/pkgs/applications/virtualization/qemu/default.nix&quot;
      ) {
        inherit (super.darwin.apple_sdk.frameworks) CoreServices Cocoa Hypervisor;
        inherit (super.darwin.stubs) rez setfile;
      }).override {
        # In nixpkgs 20.03, stdenv contains lib attr.
        stdenv = pkgs.pkgsStatic.stdenv // {lib = super.lib;};
        alsaLib = null;
        spiceSupport = false;
        sdlSupport = false;
        smartcardSupport = false;
        gtkSupport = false;
        pulseSupport = false;

        # nativeBuildInputs
        makeWrapper = pkgs.makeWrapper;
        python2 = pkgs.python2;
        pkgconfig = pkgs.pkgconfig;
        flex = pkgs.flex;
        bison = pkgs.bison;
        perl = pkgs.perl;
      }).overrideAttrs (old: {
        nativeBuildInputs = old.nativeBuildInputs ++ [
          # Several issues report ld version &gt;= 2.34 will failed due to
          # PHDR segment not covered by LOAD segment.
          # https://github.com/OpenOrbis/OpenOrbis-PS4-Toolchain/issues/122
          # https://github.com/genodelabs/genode/issues/4003
          # So I downgrade ld version &lt; 2.34.
          # I still do not figure out why the same version ld in
          # qemu 6.1.1 static works correctly?
          pkgsForQemu31.binutils
        ];
      })).overrideDerivation (old: let
        # drop audio configure flag
        configureFlags_no_audio = builtins.filter (
          x: ! super.lib.hasPrefix &quot;--audio-drv-list&quot; x
        ) old.configureFlags;
        # qemu configure uses &quot;--static&quot; instead of standard &quot;--disable-shared&quot; and &quot;--enable-static&quot;
        configureFlags_no_DS = super.lib.lists.remove &quot;--disable-shared&quot; configureFlags_no_audio;
        configureFlags_no_DS_no_ES = super.lib.lists.remove &quot;--enable-static&quot; configureFlags_no_DS;
      in {
        configureFlags = configureFlags_no_DS_no_ES ++ [
          # &quot;--static&quot;
          # &quot;--target-list-exclude=&quot;
          &quot;--target-list=x86_64-softmmu&quot;
          &quot;--disable-gnutls&quot;
          &quot;--disable-tools&quot;
        ];
        makeFlags = [
          # &quot;V=1&quot; # qemu Makefile verbose
          # It is neccessary to use ld in binutils, otherwise pc-bios build will fail.
          # In qemu 6.1.1 static, it is using ld in binutils, instead of ld from musl-gcc
          &quot;AR=${pkgs.binutils-unwrapped}/bin/ar&quot;
          &quot;AS=${pkgs.binutils}/bin/as&quot;
          &quot;LD=${pkgs.binutils}/bin/ld&quot;
          &quot;NIX_BINTOOLS=${pkgs.binutils}&quot;
        ];
      });
    })];

  };
in
{
  inherit (mypkgs.pkgsStatic) qemu qemu31;
}
</code></pre>
<h3 id="shell_cross_mipsnix"><a class="header" href="#shell_cross_mipsnix">shell_cross_mips.nix</a></h3>
<pre><code class="language-nix"># xieby1: 2022.05.16
let
  pkgs_mips_cross = import &lt;nixpkgs&gt; {
    crossSystem = &quot;mips-linux&quot;;
  };
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.mkShell {
  buildInputs = (with pkgs_mips_cross; [
    buildPackages.gdb
    buildPackages.gcc
  ]) ++ (with pkgs; [
    qemu
  ]);
}
</code></pre>
<h3 id="shell_cross_platformnix"><a class="header" href="#shell_cross_platformnix">shell_cross_platform.nix</a></h3>
<pre><code class="language-nix"># xieby1: 2022.04.26

let
  pkgs_arm_cross = import &lt;nixpkgs&gt; {
    # get this config on my android
    #   nix repl
    #   builtins.currentSystem
    crossSystem = &quot;aarch64-linux&quot;;
  };
  pkgs_arm_native = import &lt;nixpkgs&gt; {
    localSystem = &quot;aarch64-linux&quot;;
    crossSystem = &quot;aarch64-linux&quot;;
  };
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.mkShell {
  buildInputs = with pkgs_arm_cross; [
    # packages for cross compiling, run on local system (x86_64)
    stdenv.cc
    # here stdenv.cc is the same with buildPackages.gcc
  ] ++ (with pkgs_arm_native; [
    # packages run on aarch64
    figlet
  ]) ++ (with pkgs; [
    # packages run on local system (x86_64)
    qemu
  ]);
}
</code></pre>
<h3 id="shell_fhs_x11nix"><a class="header" href="#shell_fhs_x11nix">shell_fhs_x11.nix</a></h3>
<pre><code class="language-nix"># https://ryantm.github.io/nixpkgs/builders/special/fhs-environments/

{ pkgs ? import &lt;nixpkgs&gt; {} }:

(pkgs.buildFHSUserEnv {
  name = &quot;simple-x11-env&quot;;
  targetPkgs = pkgs: (with pkgs;
    [ udev
      alsa-lib
    ]) ++ (with pkgs.xorg;
    [ libX11
      libXcursor
      libXrandr
    ]);
  multiPkgs = pkgs: (with pkgs;
    [ udev
      alsa-lib
    ]);
  runScript = &quot;bash&quot;;
}).env
</code></pre>
<h3 id="shell_gem5nix"><a class="header" href="#shell_gem5nix">shell_gem5.nix</a></h3>
<pre><code class="language-nix"># xieby1 2022.06.10
# place this file in gem5 src dir root
{
  pkgs ? import &lt;nixpkgs&gt; {},
  clang ? false
}:
pkgs.mkShell {
  name = &quot;gem5-dev&quot;;
  packages = with pkgs; [
    # for compilation
    scons
    zlib
    m4
    gperftools
    protobuf
    libpng
    hdf5-cpp

    # for execution
    python3Packages.pydot

    # for commit
    python3Packages.pyyaml
  ] ++ lib.optionals clang [
    clangStdenv.cc
  ];

  _VIMRC = builtins.toString ./shell_gem5/vimrc;
  _CCLS = builtins.toString ./shell_gem5/ccls;
  _PYRIGHT = builtins.toString ./shell_gem5/pyrightconfig.json;
  _PSEDOIMPORT = builtins.toString ./shell_gem5/psedoImport.py;
  shellHook = ''
    # add nvim local config
    if [[ ! -f ./.vimrc ]]
    then
      echo &quot;set .vimrc&quot;
      ln -fs ''${_VIMRC} ./.vimrc
    fi

    # add ccls config
    if [[ ! -f ./.ccls ]]
    then
      echo &quot;set .ccls&quot;
      ln -fs ''${_CCLS} ./.ccls
    fi

    # add pyright config
    if [[ ! -f ./pyrightconfig.json ]]
    then
      echo &quot;set pyrightconfig.json&quot;
      ln -fs ''${_PYRIGHT} ./
    fi

    # add psedoImport
    if [[ ! -f ./psedoImport.py ]]
    then
      echo &quot;set psedoImport&quot;
      ln -fs ''${_PSEDOIMPORT} ./
    fi

    # add syncthing ignore
    if [[ ! -f ./.stignore ]]
    then
      echo &quot;set .stignore&quot;
      echo &quot;#include .gitignore&quot; &gt; .stignore
    fi

    # set python path for gem5
    echo &quot;set PYTHONPATH&quot;
    PYTHONPATH+=&quot;:''$(realpath src/python)&quot;
    PYTHONPATH+=&quot;:''$(realpath site_scons)&quot;
    export PYTHONPATH

    # for FS binaries
    echo &quot;set IMG_ROOT&quot;
    export IMG_ROOT=/home/xiebenyi/Img/aarch-system-20210904
  '' + pkgs.lib.optionalString clang ''

    # for clang
    export CC=${pkgs.clangStdenv.cc}/bin/clang
    export CXX=${pkgs.clangStdenv.cc}/bin/clang++
  ''
  ;
}
</code></pre>
<h3 id="shellnix"><a class="header" href="#shellnix">shell.nix</a></h3>
<pre><code class="language-nix">with import &lt;nixpkgs&gt; {};
# You will get a shell with hello executable,
# and environment variable $name, $miao.
mkShell {
  packages = [
    hello
  ];
  name = &quot;test-env&quot;;
  miao = &quot;miao!&quot;;
}
</code></pre>
<h3 id="shell_python_machnix"><a class="header" href="#shell_python_machnix">shell_python_mach.nix</a></h3>
<pre><code class="language-nix">let
  mach-nix = import (builtins.fetchGit {
    url = &quot;https://github.com/DavHau/mach-nix&quot;;
    ref = &quot;refs/tags/3.4.0&quot;;
  }) {
    pkgs = import &lt;nixpkgs&gt; {};
  };
in
mach-nix.mkPythonShell {
  requirements = ''
    expmcc
  '';
}
</code></pre>
<h3 id="shell_pythonnix"><a class="header" href="#shell_pythonnix">shell_python.nix</a></h3>
<pre><code class="language-nix"># --pure: start a pure reproducible shell
{ pkgs ? import &lt;nixpkgs&gt; {} }:
let
  name = &quot;nix&quot;;
  myPython = pkgs.python3.withPackages (
    p: with p; [
      ipython
    ]
  );
in
pkgs.mkShell {
  inherit name;
  buildInputs = with pkgs; [
    myPython
    hello
  ];
  shellHook = ''
    # install hello permenantly
    # nix-env -q &quot;${pkgs.hello.name}&quot;
    # if [[ ''$? -ne 0 ]]
    # then
    #   nix-env -i ${pkgs.hello}
    # fi

    # env
    export PYTHONPATH=${myPython}/${myPython.sitePackages}
    export debian_chroot=${name}

    ${pkgs.tmux}/bin/tmux
    exit
  '';
}
</code></pre>
<h3 id="shell_python_venvnix"><a class="header" href="#shell_python_venvnix">shell_python_venv.nix</a></h3>
<pre><code class="language-nix">#2022.05.18
# pip install is usable in venv
# e.g.
# $ nix-shell &lt;this_file&gt;
# $ pip install [--user] graphviz2drawio
let
  pkgs = import &lt;nixpkgs&gt; {};
in
pkgs.mkShell {
  propagatedBuildInputs = with pkgs.python3Packages; [
    pip
    pygraphviz
    venvShellHook
    ipython
  ] ++ (with pkgs; [
    graphviz
  ]);
  venvDir = &quot;venv&quot;;
}
</code></pre>
<h3 id="shell_qemu_tests_tcgnix"><a class="header" href="#shell_qemu_tests_tcgnix">shell_qemu_tests_tcg.nix</a></h3>
<pre><code class="language-nix"># --pure: start a pure reproducible shell
# 2022.04.24
# Compile qemu/tests/tcg/x86_64/
# env CFLAGS=-O make -e build-tcg-tests-x86_64-linux-user
{ pkgs ? import &lt;nixpkgs&gt; {} }:
let
  name = &quot;nix&quot;;
in
pkgs.mkShell {
  inherit name;
  buildInputs = with pkgs; [
    glibc.static
  ];
  inputsFrom = with pkgs; [
    qemu
  ];
}
</code></pre>
<h3 id="shell_spikenix"><a class="header" href="#shell_spikenix">shell_spike.nix</a></h3>
<pre><code class="language-nix">with import &lt;nixpkgs&gt; {};
mkShell {
  packages = [
    dtc
    pkgsCross.riscv64-embedded.stdenv.cc
  ];
  name = &quot;spike&quot;;
}
</code></pre>
<h3 id="shell_texlivenix"><a class="header" href="#shell_texlivenix">shell_texlive.nix</a></h3>
<pre><code class="language-nix"># --pure: start a pure reproducible shell
{ pkgs ? import &lt;nixpkgs&gt; {}
}:
pkgs.mkShell {
  name=&quot;dev-environment&quot;;
  buildInputs = with pkgs; [
    texlive.combined.scheme-full # HUGE SIZE!

    tmux
  ];
  shellHook = ''
    # install texlive permenant
    nix-env -q &quot;texlive.*&quot;
    if [[ ''$? -ne 0 ]]
    then
      nix-env -f '&lt;nixpkgs&gt;' -iA texlive.combined.scheme-full
    fi

    tmux
    exit
  '';
}
</code></pre>
<style>
.collapsible {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  width: 100%;
  height: 2em;
  border: none;
  text-align: left;
  outline: none;
}

.coll_active,
.collapsible:hover {
  background-color: #ccc;
}

.collapsible:after {
  content: "\25b6  Unfold"; /* > */
  float: left;
}

.coll_active:after {
  content: "\25bc  Fold"; /* V */
}
</style>
<script type="text/javascript">
let codes = document.getElementsByTagName("code");
for (let i = 0; i < codes.length; i++) {
    let code = codes[i];
    // folded by default
    code.style.height = "10em";
    let foldButton = document.createElement("button");
    foldButton.setAttribute("type", "button");
    foldButton.setAttribute("class", "collapsible");
    foldButton.addEventListener("click", function() {
        this.classList.toggle("coll_active");
        let code = this.nextElementSibling;
        if (code.style.height === "10em") {
            code.style.height = "100%";
        } else {
            code.style.height = "10em";
        }
    });
    code.parentNode.insertBefore(foldButton, code);
}
</script>

                    </main>
                    <script src="https://utteranc.es/client.js"
                        repo="xieby1/xieby1.github.io"
                        issue-term="pathname"
                        theme="github-light"
                        crossorigin="anonymous"
                        async>
                    </script>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
