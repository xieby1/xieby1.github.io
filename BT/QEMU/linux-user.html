<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>linux-user.md - xieby1&#x27;s notes</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
                <link rel="stylesheet" href="../../custom.css">
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../index.html">Welcome</a></li><li class="chapter-item "><a href="../../Essays.html">Essays</a></li><li class="chapter-item "><a href="../../abbreviations.html">abbreviations</a></li><li class="chapter-item affix "><li class="part-title">xieby1's notes</li><li class="chapter-item "><div>ABI</div></li><li class="chapter-item "><div>Algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Graph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Algo/Graph/1998.distance.bunke.prl.775.html">1998.distance.bunke.prl.775.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2002.inexact_match.bengoetxea.doc_thesis.107.html">2002.inexact_match.bengoetxea.doc_thesis.107.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2014.attributed.zhang.cvpr.19.html">2014.attributed.zhang.cvpr.19.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2016.survey.yan.icmr.108.html">2016.survey.yan.icmr.108.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2021.igraphmatch.qiao..0.html">2021.igraphmatch.qiao..0.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div></li><li class="chapter-item "><div>Arch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>HT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Arch/HT/2005.cell.kahle.ibmjrd.1093.html">2005.cell.kahle.ibmjrd.1093.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2012.process_migration.devuyst.asplos.83.html">2012.process_migration.devuyst.asplos.83.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2014.isa_explore.venkat.isca.112.html">2014.isa_explore.venkat.isca.112.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2015.overview.mitra.jip.15.html">2015.overview.mitra.jip.15.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2018.process_migration.venkat.doc_thesis.5.html">2018.process_migration.venkat.doc_thesis.5.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2019.composite_isa.venkat.hpca.17.html">2019.composite_isa.venkat.hpca.17.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2020.byoc_framework.balkind.asplos.3.html">2020.byoc_framework.balkind.asplos.3.md</a></li><li class="chapter-item "><a href="../../Arch/HT/doc_thoughts.html">doc_thoughts.md</a></li></ol></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Arch/reconf/1997.chimaera.hauck.fccm.461.html">1997.chimaera.hauck.fccm.461.md</a></li><li class="chapter-item "><a href="../../Arch/reconf/2008.reconf_acc.beck.date.97.html">2008.reconf_acc.beck.date.97.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div></li></ol></li><li class="chapter-item "><div>Benchmarks</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Benchmarks/coremark.html">coremark.md</a></li><li class="chapter-item "><div>herdtools7</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Benchmarks/herdtools7/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><a href="../../Benchmarks/spec/index.html">spec</a></li><li class="chapter-item "><a href="../../Benchmarks/spec2000.html">spec2000.md</a></li></ol></li><li class="chapter-item expanded "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/2006.lib.杨浩.计算机研究与发展.0.html">2006.lib.杨浩.计算机研究与发展.0.md</a></li><li class="chapter-item "><a href="../../BT/algo/2016.static_identify_jump_target.federico.cases.9.html">2016.static_identify_jump_target.federico.cases.9.md</a></li><li class="chapter-item "><div>bt_rules</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/bt_rules/2006.peephole_superopt.bansal.asplos.134.html">2006.peephole_superopt.bansal.asplos.134.md</a></li><li class="chapter-item "><a href="../../BT/algo/bt_rules/2018.learn.wwwang.asplos.11.html">2018.learn.wwwang.asplos.11.md</a></li></ol></li><li class="chapter-item "><div>offload</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/offload/2010.distribit.guan.hpdc.5.html">2010.distribit.guan.hpdc.5.md</a></li></ol></li><li class="chapter-item "><div>reg</div></li><li class="chapter-item "><div>smc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/smc/2015.detect.hawkins.cgo.24.html">2015.detect.hawkins.cgo.24.md</a></li></ol></li><li class="chapter-item "><div>trace</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/trace/1994.opt_profiling_tracing.ball.toplas.580.html">1994.opt_profiling_tracing.ball.toplas.580.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2000.net.duesterwald.asplos.141.html">2000.net.duesterwald.asplos.141.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2005.edge_profile.白童心.计算机工程.2.html">2005.edge_profile.白童心.计算机工程.2.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2005.lei_net.hiniker.micro.39.html">2005.lei_net.hiniker.micro.39.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/analysis/2014.simulators_harm.nowatki..19.html">2014.simulators_harm.nowatki..19.md</a></li><li class="chapter-item "><a href="../../BT/analysis/2020.perfdbt.wu.iccd.2.html">2020.perfdbt.wu.iccd.2.md</a></li></ol></li><li class="chapter-item "><div>application</div></li><li class="chapter-item "><div>Box86</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/Box86/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>dynamic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/dynamic/2017.mambox64.dantras.pldi.18.html">2017.mambox64.dantras.pldi.18.md</a></li></ol></li><li class="chapter-item "><div>Emulator</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Emulator_Design</div></li></ol></li><li class="chapter-item "><a href="../../BT/exagear.html">exagear.md</a></li><li class="chapter-item "><div>HQEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HQEMU/codeReading-deprecated.html">codeReading-deprecated.md</a></li><li class="chapter-item "><a href="../../BT/HQEMU/codeReading.html">codeReading.md</a></li></ol></li><li class="chapter-item "><div>HW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/2008.coprocessor.li.amasbt.3.html">2008.coprocessor.li.amasbt.3.md</a></li><li class="chapter-item "><a href="../../BT/HW/2009.godson3_x86_emu.hu.micro.84.html">2009.godson3_x86_emu.hu.micro.84.md</a></li><li class="chapter-item "><div>codeCache</div></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/reconf/2013.x86_mips_reconf.junior.jsa.4.html">2013.x86_mips_reconf.junior.jsa.4.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/VLIW/2015.denver.nvidia.micro.36.html">2015.denver.nvidia.micro.36.md</a></li><li class="chapter-item "><a href="../../BT/HW/VLIW/2019.hybrid_dbt.rokicki.cadics.2.html">2019.hybrid_dbt.rokicki.cadics.2.md</a></li><li class="chapter-item "><div>crusoe</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/VLIW/crusoe/2000.crusoe.klaiber.transmeta.118.html">2000.crusoe.klaiber.transmeta.118.md</a></li></ol></li><li class="chapter-item "><div>daisy</div></li></ol></li></ol></li><li class="chapter-item "><div>kernel</div></li><li class="chapter-item "><a href="../../BT/libDBT/index.html">libDBT</a></li><li class="chapter-item "><div>lift</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LLBT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/LLBT/LLBT调研.html">LLBT调研.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/LLBT/二进制翻译调研报告（LLBT相关）.html">二进制翻译调研报告（LLBT相关）.md</a></li></ol></li><li class="chapter-item "><div>mcsema</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/2019.mcsema_dyninst.korencik...html">2019.mcsema_dyninst.korencik...md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/2019.mcsema.researchLogs.html">2019.mcsema.researchLogs.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/remill.html">remill.md</a></li></ol></li><li class="chapter-item "><div>mctoll</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/2019.mctoll.yadavalli.lctes.5.html">2019.mctoll.yadavalli.lctes.5.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/codesReading.html">codesReading.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/run.html">run.md</a></li></ol></li><li class="chapter-item "><a href="../../BT/lift/IR/overview.html">overview.md</a></li><li class="chapter-item "><div>REVNG</div></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/Mem/2008.thread_safe_by_tm.chung.hpca.51.html">2008.thread_safe_by_tm.chung.hpca.51.md</a></li><li class="chapter-item "><a href="../../BT/Mem/2016.atomic.rigo.taco.6.html">2016.atomic.rigo.taco.6.md</a></li></ol></li><li class="chapter-item "><div>oldProj</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/oldProj/1993.mips2alphaaxp.sites.cacm.267.html">1993.mips2alphaaxp.sites.cacm.267.md</a></li><li class="chapter-item "><a href="../../BT/oldProj/1998.fx32.chernoff.micro.217.html">1998.fx32.chernoff.micro.217.md</a></li><li class="chapter-item "><div>dbt4AndStatic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/DBT4代码阅读笔记.html">DBT4代码阅读笔记.md</a></li><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/dbt-static.html">dbt-static.md</a></li><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/去除orc工作量和难度.html">去除orc工作量和难度.md</a></li></ol></li></ol></li><li class="chapter-item "><div>others</div></li><li class="chapter-item "><div>overview</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/overview/2001.bt_opt_challenges.altman.pieee.38.html">2001.bt_opt_challenges.altman.pieee.38.md</a></li><li class="chapter-item "><a href="../../BT/overview/2004.bibliography_of_simulators.html">2004.bibliography_of_simulators.md</a></li></ol></li><li class="chapter-item expanded "><div>QEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/QEMU/16k.html">16k.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/2005.qemu.bellard.usenix.2217.html">2005.qemu.bellard.usenix.2217.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/2017.qemu_multi_cores.cota.cgo.8.html">2017.qemu_multi_cores.cota.cgo.8.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/LA-backend.html">LA-backend.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/linux-user-32.html">linux-user-32.md</a></li><li class="chapter-item expanded "><a href="../../BT/QEMU/linux-user.html" class="active">linux-user.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/linux-user-memory_region.html">linux-user-memory_region.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/logs.html">logs.md</a></li><li class="chapter-item "><div>lx</div></li><li class="chapter-item "><a href="../../BT/QEMU/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/signal.html">signal.md</a></li><li class="chapter-item "><div>target</div></li><li class="chapter-item "><a href="../../BT/QEMU/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>rewrite</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/rewrite/2018.superset_disassembly.bauman.ndss.40.html">2018.superset_disassembly.bauman.ndss.40.md</a></li><li class="chapter-item "><div>instru</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/rewrite/instru/2009.mt.hazelwood.ismm.28.html">2009.mt.hazelwood.ismm.28.md</a></li><li class="chapter-item "><a href="../../BT/rewrite/instru/mem_count.html">mem_count.md</a></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>static</div></li><li class="chapter-item "><div>sys</div></li><li class="chapter-item "><div>Tarmac</div></li><li class="chapter-item "><div>test</div></li><li class="chapter-item "><div>x86-qemu-mips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/x86-qemu-mips/check_manual.html">check_manual.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/check.html">check.md</a></li><li class="chapter-item "><div>debugs</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/x86-qemu-mips/debugs/OPEN.unknown-loop-in-bios.html">OPEN.unknown-loop-in-bios.md</a></li></ol></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/linux-user.html">linux-user.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/mips-llvm.html">mips-llvm.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/tr_misc修改记录.html">tr_misc修改记录.md</a></li></ol></li><li class="chapter-item "><div>X86toMips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/X86toMips/dbt测试结果.html">dbt测试结果.md</a></li><li class="chapter-item "><a href="../../BT/X86toMips/Pseudo-README.html">Pseudo-README.md</a></li><li class="chapter-item "><a href="../../BT/X86toMips/X86toMips调研.html">X86toMips调研.md</a></li><li class="chapter-item "><a href="../../BT/X86toMips/X86toMips调研-续.html">X86toMips调研-续.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Build</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Autotools</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Autotools/2012.autotools_criticism.kamp..html">2012.autotools_criticism.kamp..md</a></li><li class="chapter-item "><a href="../../Build/Autotools/autotools.html">autotools.md</a></li></ol></li><li class="chapter-item "><div>CMake</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/CMake/Notes.html">Notes.md</a></li></ol></li><li class="chapter-item "><div>Compiler</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/1992.hyperblock.mahlke.micro.html">1992.hyperblock.mahlke.micro.md</a></li><li class="chapter-item "><div>llvm</div></li><li class="chapter-item "><div>mingw</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/mingw/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>ORC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/ORC/2004.ORC-LCPC04-Tutorial.html">2004.ORC-LCPC04-Tutorial.md</a></li><li class="chapter-item "><a href="../../Build/Compiler/ORC/2004.overview_orc.wuchengyong.iwlcpc.html">2004.overview_orc.wuchengyong.iwlcpc.md</a></li></ol></li><li class="chapter-item "><div>trans</div></li></ol></li><li class="chapter-item "><div>Disassemble</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Disassemble/2002.disassembly.bschwarz.pieee.html">2002.disassembly.bschwarz.pieee.md</a></li></ol></li><li class="chapter-item "><a href="../../Build/ELF/index.html">ELF</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/ELF/ELF调研.html">ELF调研.md</a></li><li class="chapter-item "><a href="../../Build/ELF/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Linker_Loader</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Linker_Loader/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Build/mingw.html">mingw.md</a></li></ol></li><li class="chapter-item "><a href="../../cheatsheet.html">cheatsheet.md</a></li><li class="chapter-item "><div>CLI</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CLI/term_pty_sh.html">term_pty_sh.md</a></li></ol></li><li class="chapter-item "><div>CompatLayer</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/2006.linuxulator.divacky.freebsd..html">2006.linuxulator.divacky.freebsd..md</a></li><li class="chapter-item "><a href="../../CompatLayer/Alky.html">Alky.md</a></li><li class="chapter-item "><div>UML</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/UML/user_mode_linux.html">user_mode_linux.md</a></li></ol></li><li class="chapter-item "><div>WINE</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/WINE/2020_6_25.emu_win_syscall.corbet.lwn.html">2020_6_25.emu_win_syscall.corbet.lwn.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Design_of_WINE.html">Design_of_WINE.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/optimizable.html">optimizable.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/others.html">others.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wine-logs.html">qemu-wine-logs.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-winetest_debug_logs.html">qemu-winetest_debug_logs.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wine环境搭建.html">qemu-wine环境搭建.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/References.html">References.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Winegcc调研.html">Winegcc调研.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Winelib调研报告.html">Winelib调研报告.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/WINE设备驱动调研.html">WINE设备驱动调研.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/WINE调研.html">WINE调研.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/二进制翻译调研报告_FX32_Wine.html">二进制翻译调研报告_FX32_Wine.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/二进制翻译调研报告_Wine.html">二进制翻译调研报告_Wine.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Connect</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/index.html">Bluetooth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bluez</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/bluez/profile_input.html">profile_input.md</a></li></ol></li><li class="chapter-item "><div>btkbdd</div></li><li class="chapter-item "><div>dbus</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/dbus/Overview.html">Overview.md</a></li></ol></li><li class="chapter-item "><div>Essays</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>2005.bluez_intro.albert</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/Essays/2005.bluez_intro.albert/An_Introduction_to_Bluetooth_Programming.html">An_Introduction_to_Bluetooth_Programming.md</a></li></ol></li><li class="chapter-item "><a href="../../Connect/Bluetooth/Essays/阅读记录.html">阅读记录.md</a></li></ol></li><li class="chapter-item "><div>hidclient</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/hidclient/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Network</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bittorrent</div></li><li class="chapter-item "><div>nginx</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Network/nginx/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><a href="../../Connect/Network/p2p.html">p2p.md</a></li><li class="chapter-item "><a href="../../Connect/Network/streaming_server.html">streaming_server.md</a></li></ol></li><li class="chapter-item "><div>NFC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Essays</div></li></ol></li></ol></li><li class="chapter-item "><div>dataViz</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dataViz/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Distro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Distro/JingOS.html">JingOS.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/index.html">Nix</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Distro/Nix/android.html">android.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/cross.html">cross.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/feishu.html">feishu.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/nixpkgs.html">nixpkgs.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/productivity.html">productivity.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/README-en.html">README-en.md</a></li></ol></li></ol></li><li class="chapter-item "><div>EPaper</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../EPaper/laptop.html">laptop.md</a></li></ol></li><li class="chapter-item "><div>FPGA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../FPGA/iverilog.html">iverilog.md</a></li></ol></li><li class="chapter-item "><div>hackthon</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../hackthon/Untitled.html">Untitled.md</a></li></ol></li><li class="chapter-item "><div>Input</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Input/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>ISA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/2013.power_of_risc_cisc.blem.hpca.144.html">2013.power_of_risc_cisc.blem.hpca.144.md</a></li><li class="chapter-item "><div>arm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/arm/aarch64.html">aarch64.md</a></li></ol></li><li class="chapter-item "><div>enhance</div></li><li class="chapter-item "><div>mips</div></li><li class="chapter-item "><div>mips_lx</div></li><li class="chapter-item "><div>riscv</div></li><li class="chapter-item "><a href="../../ISA/Semantics/index.html">Semantics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Semantics/2013.locate.lakhotia.pprew.75.html">2013.locate.lakhotia.pprew.75.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2014.lem.mulligan.icfp.79.html">2014.lem.mulligan.icfp.79.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2015.sail.gray.micro.31.html">2015.sail.gray.micro.31.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2016.learn.heule.pldi.56.html">2016.learn.heule.pldi.56.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2018.sail.armstrong..3.html">2018.sail.armstrong..3.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2019.x64_validation.dasgupta.sigplan.24.html">2019.x64_validation.dasgupta.sigplan.24.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2021.sail.armstrong.manual.html">2021.sail.armstrong.manual.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/asmjit.html">asmjit.md</a></li><li class="chapter-item "><div>k</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Semantics/k/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>ultrasparc</div></li><li class="chapter-item "><div>Uop</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Uop/1990.nec_intel.elkins...html">1990.nec_intel.elkins...md</a></li><li class="chapter-item "><a href="../../ISA/Uop/1996.palcode..manual..html">1996.palcode..manual..md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2003.ucache.solomon.tvlsi.13.html">2003.ucache.solomon.tvlsi.13.md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2019.reverse_engineer.koppe.usenix_security.16.html">2019.reverse_engineer.koppe.usenix_security.16.md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2020.improve_ucache.kotra.micro.1.html">2020.improve_ucache.kotra.micro.1.md</a></li></ol></li><li class="chapter-item "><div>x86</div></li></ol></li><li class="chapter-item "><div>JIT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../JIT/2008.llvm_sim.brandner..29.html">2008.llvm_sim.brandner..29.md</a></li><li class="chapter-item "><a href="../../JIT/2011.llvm_sim.helmstetter.imecs.6.html">2011.llvm_sim.helmstetter.imecs.6.md</a></li><li class="chapter-item "><div>dynarmic</div></li><li class="chapter-item "><div>opt</div></li></ol></li><li class="chapter-item "><div>Kernel</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/2020_9_9.prepare_new_feat.edge.lwn-lpc.html">2020_9_9.prepare_new_feat.edge.lwn-lpc.md</a></li><li class="chapter-item "><div>Driver</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Driver/2019.linux_win_printer.金融通.软件所硕士.html">2019.linux_win_printer.金融通.软件所硕士.md</a></li></ol></li><li class="chapter-item "><div>exo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/exo/1995.intro.engler.sosp.1259.html">1995.intro.engler.sosp.1259.md</a></li></ol></li><li class="chapter-item "><div>Linux</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/2002.rcu.mckenney..216.html">2002.rcu.mckenney..216.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2016.sched_bug.lozi.eurosys.120.html">2016.sched_bug.lozi.eurosys.120.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2018.concurrency.alglave.asplos.31.html">2018.concurrency.alglave.asplos.31.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2020.rcu.mckenney...html">2020.rcu.mckenney...md</a></li><li class="chapter-item "><div>Android</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/Android/anbox.html">anbox.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/to_mainline.html">to_mainline.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/Waydroid.html">Waydroid.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Linux/cache_alias.html">cache_alias.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/cache_alias_page_color.html">cache_alias_page_color.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/docsReading.html">docsReading.md</a></li><li class="chapter-item "><div>drivers</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/drivers/ioctl.html">ioctl.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/drivers/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Linux/idle.html">idle.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/lx.html">lx.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/memory_mapping.html">memory_mapping.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/module.logs.html">module.logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/mtlb.logs.html">mtlb.logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/page_fault.html">page_fault.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/page_size.html">page_size.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/QnA-alpine.html">QnA-alpine.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/startup.html">startup.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/syscalls.html">syscalls.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/memory.html">memory.md</a></li><li class="chapter-item "><div>micro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/micro/1995.u_kernel.lietdke.sosp.308.html">1995.u_kernel.lietdke.sosp.308.md</a></li><li class="chapter-item "><a href="../../Kernel/micro/2013.l3_sel4.elphinstone.sosp.126.html">2013.l3_sel4.elphinstone.sosp.126.md</a></li></ol></li><li class="chapter-item "><div>multi</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/multi/2009.intro.baumann.sosp.856.html">2009.intro.baumann.sosp.856.md</a></li></ol></li><li class="chapter-item "><div>syscall</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/syscall/2020_9_8.extensible_syscall.corbet.lwn-lpc.html">2020_9_8.extensible_syscall.corbet.lwn-lpc.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/transkernel.html">transkernel.md</a></li><li class="chapter-item "><div>unikernel</div></li><li class="chapter-item "><div>WinCmptbl</div></li><li class="chapter-item "><div>Windows</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Windows/compilation.html">compilation.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/index.html">driver</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Windows/driver/ddiwrapper.html">ddiwrapper.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/logs-1.html">logs-1.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/logs.html">logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/ndis.html">ndis.md</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>err</div></li></ol></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/printer.html">printer.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/types.html">types.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Windows/nameConventions.html">nameConventions.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/ReactOS/index.html">ReactOS</a></li><li class="chapter-item "><a href="../../Kernel/Windows/service.html">service.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/subsystem.html">subsystem.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/syscall.html">syscall.md</a></li></ol></li><li class="chapter-item "><div>XNU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Darling</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/XNU/Darling/overview.html">overview.md</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><div>Lang</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Asm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Asm/asm.html">asm.md</a></li><li class="chapter-item "><div>riscv</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Asm/riscv/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../Lang/awk.html">awk.md</a></li><li class="chapter-item "><a href="../../Lang/bc.html">bc.md</a></li><li class="chapter-item "><div>C.f</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/C.f/macro.html">macro.md</a></li></ol></li><li class="chapter-item "><div>Dot</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Dot/overview.html">overview.md</a></li><li class="chapter-item "><a href="../../Lang/Dot/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/IR/1999.JVM_Specification.html">1999.JVM_Specification.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2000.llvm.lattner.master_thesis.241.html">2000.llvm.lattner.master_thesis.241.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2004.llvm.lattner.cgo.4340.html">2004.llvm.lattner.cgo.4340.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2013.importance.chow...html">2013.importance.chow...md</a></li><li class="chapter-item "><div>Common2</div></li><li class="chapter-item "><a href="../../Lang/IR/LLVM-IR.html">LLVM-IR.md</a></li><li class="chapter-item "><a href="../../Lang/IR/MapleIRDesign.html">MapleIRDesign.md</a></li></ol></li><li class="chapter-item "><div>JS</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/JS/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Latex</div></li><li class="chapter-item "><div>Lisp</div></li><li class="chapter-item "><div>Py</div></li><li class="chapter-item "><div>SMT-LIB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/SMT-LIB/2012.smt_lib_v2.cok..47.html">2012.smt_lib_v2.cok..47.md</a></li></ol></li><li class="chapter-item "><div>WebAsm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/WebAsm/2017.intro.haas.pldi.194.html">2017.intro.haas.pldi.194.md</a></li><li class="chapter-item "><a href="../../Lang/WebAsm/overview.html">overview.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Lib</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Glibc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/Glibc/glibc.html">glibc.md</a></li><li class="chapter-item "><a href="../../Lib/Glibc/mmap.html">mmap.md</a></li><li class="chapter-item "><a href="../../Lib/Glibc/pthread.html">pthread.md</a></li><li class="chapter-item "><a href="../../Lib/Glibc/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>igraph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/igraph/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Libc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/Libc/Musl/index.html">Musl</a></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Mem/cat.html">cat.md</a></li><li class="chapter-item "><div>model</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Mem/model/2017.memalloy.wickerson.popl.77.html">2017.memalloy.wickerson.popl.77.md</a></li></ol></li><li class="chapter-item "><a href="../../Mem/order.html">order.md</a></li><li class="chapter-item "><a href="../../Mem/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>Opinions</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Opinions/notes.html">notes.md</a></li><li class="chapter-item "><a href="../../Opinions/openEcoSys.html">openEcoSys.md</a></li></ol></li><li class="chapter-item "><div>other_read_list</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other_read_list/cambridge.html">cambridge.md</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/index.html">stanford</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other_read_list/stanford/1999.codesigned_vm.smith.iwia.html">1999.codesigned_vm.smith.iwia.md</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/2001.vm_intro.smith.html">2001.vm_intro.smith.md</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/2002.vector_vs_ss.kozyrakis.micro.html">2002.vector_vs_ss.kozyrakis.micro.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Perf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Perf/flamegraph.html">flamegraph.md</a></li></ol></li><li class="chapter-item "><div>PoSh</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PoSh/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Proj/index.html">Proj</a></li><li class="chapter-item "><div>Pwr</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Pwr/2009.mcpat.li.micro.2319.html">2009.mcpat.li.micro.2319.md</a></li></ol></li><li class="chapter-item "><a href="../../QnA-Daliy.html">QnA-Daliy.md</a></li><li class="chapter-item "><div>Repos</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Repos/llvm-tutor.html">llvm-tutor.md</a></li></ol></li><li class="chapter-item "><div>Sandbox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Sandbox/chroot.html">chroot.md</a></li><li class="chapter-item "><div>Docker</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Sandbox/Docker/Overview.html">Overview.md</a></li><li class="chapter-item "><a href="../../Sandbox/Docker/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Sandbox/proot.html">proot.md</a></li></ol></li><li class="chapter-item "><a href="../../scripts/index.html">scripts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bash</div></li><li class="chapter-item "><div>nix</div></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>SftwStack</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../SftwStack/applications_arch.html">applications_arch.md</a></li><li class="chapter-item "><a href="../../SftwStack/linux_desktop.html">linux_desktop.md</a></li></ol></li><li class="chapter-item "><div>Sim</div></li><li class="chapter-item "><div>Softwares</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Softwares/ocrmypdf.html">ocrmypdf.md</a></li><li class="chapter-item "><a href="../../Softwares/pandoc.html">pandoc.md</a></li><li class="chapter-item "><a href="../../Softwares/tree_timeline_note.html">tree_timeline_note.md</a></li><li class="chapter-item "><div>Vim</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Softwares/Vim/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../SPIN.html">SPIN.md</a></li><li class="chapter-item "><div>SQL</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../SQL/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>SymExec</div></li><li class="chapter-item "><div>Temp</div></li><li class="chapter-item "><div>uArch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>TLB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../uArch/TLB/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Virt</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/1988.386.smith.programmers_journal..html">1988.386.smith.programmers_journal..md</a></li><li class="chapter-item "><a href="../../Virt/2002.esx.waldspurger.opsr.1402.html">2002.esx.waldspurger.opsr.1402.md</a></li><li class="chapter-item "><a href="../../Virt/2003.xen.barham.opsr.6475.html">2003.xen.barham.opsr.6475.md</a></li><li class="chapter-item "><a href="../../Virt/2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.html">2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.md</a></li><li class="chapter-item "><a href="../../Virt/2006.cmp_soft_hard_x86.adams.asplos.700.html">2006.cmp_soft_hard_x86.adams.asplos.700.md</a></li><li class="chapter-item "><a href="../../Virt/2012.dune.belay.osdi.215.html">2012.dune.belay.osdi.215.md</a></li><li class="chapter-item "><div>addr_trans</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/addr_trans/2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.html">2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/BT/2016.cross_arch_captive.spink.taco.3.html">2016.cross_arch_captive.spink.taco.3.md</a></li><li class="chapter-item "><a href="../../Virt/BT/2019.cross_arch_captive.spink.usenix.1.html">2019.cross_arch_captive.spink.usenix.1.md</a></li></ol></li><li class="chapter-item "><a href="../../Virt/overview.html">overview.md</a></li><li class="chapter-item "><div>virtualBox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/virtualBox/install.html">install.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../X11/index.html">X11</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../X11/windowManage.html">windowManage.md</a></li></ol></li><li class="chapter-item "><div>行业报告</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LF</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../行业报告/LF/2020-Linux-Foundation-Annual-Report_120520.html">2020-Linux-Foundation-Annual-Report_120520.md</a></li><li class="chapter-item "><a href="../../行业报告/LF/FINOS-business-value-of-open-source.html">FINOS-business-value-of-open-source.md</a></li></ol></li><li class="chapter-item "><div>Nix</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../行业报告/Nix/2021.summur.html">2021.summur.md</a></li></ol></li><li class="chapter-item "><div>企业年报</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>apple</div></li><li class="chapter-item "><div>华为</div></li><li class="chapter-item "><div>海信</div></li><li class="chapter-item "><div>联想</div></li></ol></li><li class="chapter-item "><div>网信自主创新</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../行业报告/网信自主创新/2020.html">2020.md</a></li></ol></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                            </div>

                    <h1 class="menu-title">xieby1&#x27;s notes</h1>

                    <div class="right-buttons">
                                                                        <a href="https://github.com/xieby1/xieby1.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>标记：<span style="background:red; font-weight:bold; color:white">架构相关</span>，<span style="background:green; font-weight:bold; color:white">架构无关</span></p>
<div style="font-size:3em; text-align:right;">2019.11.12</div>
上周四组会明确指出目前的工程方向是以QEMU的用户级模拟（linux-user）基础，去除其生成中间的过程，像X86toMips一样直接从X86到Mips。在我看来要完成这个工作，首先要熟悉QEMU linux-user的代码框架，然后才能分析如何去简化QEMU的翻译过程。所以首先去厘清QEMU linux-user的代码吧。8月份有做简单的调研，见[logs.md](logs.md)，可以供自己参考。
<h1 id="读代码前的准备"><a class="header" href="#读代码前的准备">读代码前的准备</a></h1>
<p>用clion打开之前用compiledb处理好的qemu，发现<code>i386/cpu_loop.c</code>里有未能找到定义而提示错误的函数，且git fetch发现已经落后了200+个commits，所以想清除掉之前make install的内容。</p>
<h2 id="清除之前的make-insall"><a class="header" href="#清除之前的make-insall">清除之前的make insall</a></h2>
<p>苦于qemu的Makefile没有提供make uninstall之类的，所以找到了stack overflow的一个问答<a href="https://stackoverflow.com/questions/1439950/whats-the-opposite-of-make-install-i-e-how-do-you-uninstall-a-library-in-li">What's the opposite of 'make install', i.e. how do you uninstall a library in Linux?</a>，给出了<strong>补救方案</strong>和<strong>预防方案</strong>来卸载作者没有给出make uninstall选项的源代码。</p>
<p>我选择放弃~~<strong>补救方案</strong>，<code>make -n install</code>，打印出install执行的步骤，然后手工删掉安装的文件即可。尝试这个方法发现显示出来的不全啊，Makefile里install的语句一大堆，这个方法暂时放弃了，以后注意预防这个make install问题好了。~~下面有人评论说，这样太繁琐，这正是<span style="font-size:1.5em;font-weight:bold;">包管理器</span>被发明出来的原因，所以需要一个良好的<strong>预防方案</strong>，<span style="font-size:1.5em;font-weight:bold;">checkinstall</span>，</p>
<pre><code class="language-shell">sudo apt install checkinstall
# 每次就不要用make install了，而是sudo checkinstall
# 这个回答还提到了可以用这个方法来删除用make install安装的包，那就不管咯，感觉我以后的安装应该是会覆盖的之前的，之后就用包管理器吧！
</code></pre>
<p>下面的评论有提到，最高票的答案不一定是最好的答案啊！我表示十分赞同！</p>
<h2 id="更新qemu"><a class="header" href="#更新qemu">更新QEMU</a></h2>
<p><strong>我使用的是4.1.0版本</strong>。是直接参考<a href="logs.html">logs.md</a>即可，不需要建build目录在根目录下搞即可，不赘述。（中间遇到了SRC_PATH和BUILD_DIR not found的问题，我直接无视了，好像行的通？）之前存在的clion里<code>i386/cpu_loop.c</code>里有未能找到定义而提示错误的函数还是一样。ლ(╹◡╹ლ)</p>
<h1 id="代码框架"><a class="header" href="#代码框架">代码框架</a></h1>
<div style="font-size:3em; text-align:right;">2019.11.13</div>
## `cpu_loop`
<p>做完了<code>cpu_loop</code>的代码框架图，回去对照<a href="logs.html">logs.md</a>里的结构图（贴在下面了），我才发现之前的自己已经把linux-user的大体框架搞清楚了的。</p>
<p><img src="pictures/QEMU-user.svg" alt="QEMU-user" /></p>
<p><code>cpu_loop</code>（i386）的代码框架图<span style="background:red; font-weight:bold; color:white">架构相关</span>，</p>
<p><img src="pictures/linux-user-cpu_loop.svg" alt="linux-user-cpu_loop" /></p>
<p>所以现在我要做的事很清楚了，<strong>弄清细节</strong>，尤其是QEMU哪些部分是架构相关的，哪些部分是架构无关的，这对理解处理器设计的共性很有帮助！</p>
<div style="font-size:3em; text-align:right;">2019.11.18</div>
# 系统调用
<h2 id="do_syscall"><a class="header" href="#do_syscall"><code>do_syscall</code></a></h2>
<p>由<a href="#%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6">代码框架</a>可知函数<code>abi_long do_syscall</code>来处理系统调用。QEMU将这个函数放置在<code>linux-user/syscall.c</code>中可见QEMU希望对系统调用的处理是<span style="background:green; font-weight:bold; color:white">架构无关</span>的，<code>do_syscall</code>框架图如下，</p>
<p><img src="pictures/syscall.svg" alt="syscall" /></p>
<p>所以接下来需要搞清楚的问题很明显了，需要知道这些switch case里是如何处理系统调用的，有两种可能，</p>
<ol>
<li>翻译成TCG执行（这样的话，要变成x86tomips的框架就有点麻烦了）；</li>
<li>QEMU解释执行（这样的话，直接把do_syscall的接口对齐x86tomips里的translate_int的接口就好了）。</li>
</ol>
<h2 id="如何修改x86-qemu-mips的系统调用的思考"><a class="header" href="#如何修改x86-qemu-mips的系统调用的思考">如何修改x86-qemu-mips的系统调用的思考</a></h2>
<p><strong>太长不看</strong>：我决定选用QEMU对系统调用的处理方法（<code>cpu_exec</code>遇到中断则返回处理中断），放弃X86toMips对系统调用的处理方法（<code>translate_int</code>）。</p>
<p>目前版本的x86-qemu-mips（git SHA1 ID: fff3667068ff762899fbe6f63723c56d456b0c44）既有QEMU的那一套处理系统调用的方法，也有X86toMips那一套系统调用的方法。这两套处理方法如下（目前版本实际使用的X86toMips的系统调用的处理代码，QEMU的系统调用处理代码是“死代码”），</p>
<ul>
<li>
<p><strong>X86toMips处理系统调用的方法</strong></p>
<p><strong>太长不看</strong>：X86toMips是将“解释执行嵌在了动态翻译里”。</p>
<p>动态翻译时（<code>-t</code>选项）X86toMips是通过<code>translate_int</code>函数来处理系统调用，流程大致如下：</p>
<ul>
<li>先在TB里插入保存上下文的语句（保存寄存器和返回地址）；</li>
<li>然后在TB里插入一条跳转指令，这条跳转指令会跳到X86toMips提供的函数<code>interpret_int</code>里，位于<code>syscall/sc_syscall.cpp: 806~813</code>，完成解释执行系统调用的工作；</li>
<li>最后在TB里插入还原上下文的语句。</li>
</ul>
<p>需要回顾X86toMips对系统调用的处理代码的分析，需要区分<strong>静态翻译</strong>，<strong>动态翻译</strong>，<strong>解释执行</strong>可以参考<a href="../X86toMips/X86toMips%E8%B0%83%E7%A0%94.html">X86toMips调研.md</a>中的“X86toMips对系统调用的处理”。</p>
</li>
<li>
<p><strong>QEMU处理系统调用的方法</strong></p>
<p><strong>太长不看</strong>：纯粹的解释执行。</p>
<p>上上面的<code>cpu_loop</code>的框架图可以看出当<code>cpu_exec</code>执行TB时遇到了中断指令的话就会返回中断号，然后后续代码来处理中断，若中断号是<code>0x80</code>则会调用<code>do_syscall</code>。上面的<code>do_syscall</code>的代码框架图里巨大的switch case就是QEMU解释执行系统的地方。目前之研究了write的case，看来是纯的解释执行。所以可以大胆的猜想QEMU的对系统调用是纯粹的解释执行，即完全不会涉及TCG也不会涉及TB。这个猜想可以由实验来验证或者打破。</p>
</li>
</ul>
<p>我自己更倾向于采用QEMU处理系统调用的方法。因为毕竟QEMU是一个比X86toMips拓展性更强的翻译框架，所以我担心QEMU会切换程序内存空间或者翻译程序和执行TB的程序是俩不同的进程，那么X86toMips的处理方式就会出现根本不在同一地址空间无法寻址无法跳转的问题了。</p>
<p>且，我们现在要做的是动态翻译，还不需要考虑静态翻译，所以要如何把解释执行的代码合理地“打包”进TB现在还不用考虑。</p>
<div style="font-size:3em; text-align:right;">2019.11.19</div>
## 研读QEMU的系统调用的处理方法
<p>目前看来是要搞清楚<code>cpu_loop.c: 94 trapnr = cpu_exec(cs)</code>这个函数。</p>
<h3 id="cpu_exec"><a class="header" href="#cpu_exec"><code>cpu_exec</code></a></h3>
<p><code>cpu_exec</code>这个函数的代码框架图如下，<span style="background:green; font-weight:bold; color:white">架构无关</span></p>
<p><img src="pictures/linux-user-cpu-exec-formatted.svg" alt="linux-user-cpu-exec" /></p>
<p>✔️🤔<span style="color:red;">cflags的含义？</span><strong>答</strong>：通过grep<code>CF_INVALID</code>找到了cflags的定义和其相关宏数值定义在<code>include/exec/exec-all.h: 350~361</code>，<code>cflags</code>是compiler flags的简写，是<code>TranslationBlock</code>结构的成员变量。有空时可以把<code>TranslationBlock</code>结构研究研究。</p>
<div style="font-size:3em; text-align:right;">2019.11.20</div>
在我的x86电脑上测试了一下QEMU的这一段代码，用GDB发现了与预期的不太一样的控制流变化。本来期待QEMU遇到系统调用（特殊的interrupt）时cpu_tb_exec返回的额外信息是TB_EXIT_REQUESTED，然后回到第一层循环执行`cpu_handle_excption`函数。**然而**事实是`cpu_tb_exec`还没正常退出，控制流就如上图<span style="font-size:1.5em;font-weight:bold;color:red;">红线</span>所示，**出乎意料地跳**到被我忽略的代码里去了，如下，
<pre><code class="language-c">if (sigsetjmp(cpu-&gt;jmp_env, 0) != 0) {
</code></pre>
<p><span style="font-weight:bold; color:red;">✔️🤔猜想是QEMU在翻译TB时遇到中断指令就会在翻译的指令里“埋”入一条setjmp的指令。接下来就想办法搞清楚这个意想不到的控制流跳转吧！</span><strong>答</strong>：是间接地“埋入”了<code>longjmp</code>函数。将系统调用翻译成TCG时QEMU埋入<code>helper_raise_exception</code>函数，这个会调用<code>longjmp</code>函数，跳转到<code>qemu/accel/tcg/cpu-exec.c: 689</code>，即所谓的“出乎意料”的跳转。</p>
<div style="font-size:3em; text-align:right;">2019.11.22</div>
猜测`tb_find`若发现tb没有翻译，则会进行翻译，所以在此去详细看看`tb_find`函数，
<h3 id="tb_find"><a class="header" href="#tb_find"><code>tb_find</code></a></h3>
<p><span style="background:green; font-weight:bold; color:white">架构无关</span><img src="pictures/linux-user-tb_find.svg" alt="linux-user-tb_find" /></p>
<p>上面的代码反映出两个<strong>TB的特性</strong>：</p>
<h4 id="tb的两个特性jmp-tb查找表tb-chain"><a class="header" href="#tb的两个特性jmp-tb查找表tb-chain">TB的两个特性：jmp-TB查找表，TB chain</a></h4>
<ol>
<li>
<p>存在<strong>jmp地址-TB地址查找表</strong>，存在<code>CPUState</code>的<code>tb_jmp_cache</code>里；</p>
</li>
<li>
<p><strong>TB之间的连接关系</strong>（TB chain）由<code>TranslationBlock</code>的<code>jmp_list_head</code>、<code>jmp_list_next</code>和<code>jmp_dest</code>实现，见<code>include/exec/exec-all.h：386~402</code>注释，下面为精炼的注释传达的信息，</p>
<ol>
<li>
<pre><code class="language-c">uintptr_t jmp_list_head; // incoming jumps
</code></pre>
</li>
<li>
<pre><code class="language-c">uintptr_t jmp_list_next[2]; // two sibling TB lists // 通过看accel/tcg/cpu-exec.c: 381 行tb_add_jump的语句tb-&gt;jmp_list_next[n] = tb_next-&gt;jmp_list_head;可以知道jmp_list_next里存的是**后继TB的jmp_list_head**，因为最多可能有2个后继TB，所以这里这个链表数组大小为2.
</code></pre>
</li>
<li>
<pre><code class="language-c">uintptr_t jmp_dest[2]; // destination TB of each outgoing jump, tagged pointers, The LSB is set when the TB is being invalidated // 因为地址是4字节对齐，所以最低两位可以保存额外信息，若最低位（LSB）为1则表示TB无效。
</code></pre>
</li>
</ol>
</li>
</ol>
<p><strong>注</strong>：在bing里搜索qemu translation block相关资料时发现了2009年的<a href="https://lugatgt.org/content/qemu_internals/downloads/slides.pdf">QEMU internals</a>（看了一下QEMU的git仓库2009年大概是0.11或0.10版本的QEMU）讲述了QEMU的总体设计框架，其中有讲到Basic block chaining，虽然版本久远但有可以帮助理解现在版本的QEMU，将一张QEMU执行TB框架图放在下面，</p>
<p><img src="pictures/QEMU_internals_exec_TB.svg" alt="QEMU_internals_exec_TB" /></p>
<h4 id="tb的两个特性结束"><a class="header" href="#tb的两个特性结束">TB的两个特性[结束]</a></h4>
<p>回到主题上来，由<code>tb_find</code>的代码框架图可知确实是<code>tb_find</code>若发现tb没有翻译，则会进行翻译，这是通过<code>tb_gen_code</code>函数完成的，接下来仔细看看这个<code>tb_gen_code</code>函数，</p>
<h3 id="tb_gen_code"><a class="header" href="#tb_gen_code"><code>tb_gen_code</code></a></h3>
<p>总体看来<code>tb_gen_code</code>的框架是<span style="background:green; font-weight:bold; color:white">架构无关</span>的，但是实际从这里开始调用<span style="background:red; font-weight:bold; color:white">架构相关</span>的函数了，</p>
<p><img src="pictures/linux-user-tb_gen_code.svg" alt="linux-user-tb_gen_code" /></p>
<p>这里看的出来进行了tb的分配，从guest代码生产中间表示（TCG），然后由中间表示生产host代码。因此想要了解QEMU是如何将setjmp指令埋入翻译好的指令，需要去详细了解<code>gen_intermediate_code</code>里是如何处理x86的系统调用的，然后<code>tcg_gen_code</code>又是如何配合TCG处理系统调用的。<strong>注</strong>：x86-qemu-mips改了的这里。</p>
<div style="font-size:3em; text-align:right;">2019.11.25</div>
#### guest=>TCG: `translate_insn`=`i386_tr_translate_insn`
<p>上图中的<code>translator_loop</code>很明显地看出每次循环反汇编一条x86指令。“反汇编一条x86指令”这个动作由<code>translate_insn</code>函数完成，这个函数是<span style="background:green; font-weight:bold; color:white">架构无关</span>，但其指向的函数<code>i386_tr_translate_insn</code>是<span style="background:red; font-weight:bold; color:white">架构相关</span>，其代码框架如下，</p>
<p><img src="pictures/translate_insn-formatted.svg" alt="translate_insn-formatted" /></p>
<p>感觉QEMU是吃了C语言没有“类”的亏，<code>DisasContext</code>是<code>DisasContextBase</code>的子类，<code>DisasContextBase</code>是<code>DisasContext</code>的基类。</p>
<p>接下来详细看看<code>gen_exception</code>和<code>gen_interrupt</code>函数。</p>
<h5 id="gen_exception和gen_interrupt"><a class="header" href="#gen_exception和gen_interrupt"><code>gen_exception</code>和<code>gen_interrupt</code></a></h5>
<p>在看的过程中遇到了<code>gen_update_cc_op</code>函数，所以我去简要调研了一下QEMU中对eflags的处理。</p>
<h6 id="qemu对eflags的处理简要调研"><a class="header" href="#qemu对eflags的处理简要调研">QEMU对eflags的处理简要调研</a></h6>
<p>eflags是x86的概念，QEMU的TCG抽象出来的符号位的通用概念被成为conditional codes（简称cc）。</p>
<p>按照<code>target/i386/cpu.h: 806~812</code>对<code>CCop</code>的注释，QEMU只会保存<code>cc_op</code>，然后在需要cc时根据<code>cc_op</code>和<code>cc_op</code>作用的<code>cc_src</code>来算出需要的cc。</p>
<p><strong>保存<code>cc_op</code>的场景</strong></p>
<p>QEMU在反汇编i386指令生成TCG时，对于会操作eflags的指令（比如算数逻辑操作，处理的代码位于<code>target/i386/translate.c: 4666~4725</code>）用<code>set_cc_op (line: 234)</code>来保存<code>cc_op</code>到<code>DisasContext</code>结构的<code>cc_op</code>里，并将<code>cc_op_dirty</code>置true表示写入了<code>cc_op</code>。</p>
<p>这里自然而然会产生下面的问题：</p>
<ol>
<li>
<p><code>DisasContext</code>里只有一个<code>cc_op</code>，所以<code>set_cc_op</code>函数肯定需要考虑如何清理老的<code>cc_op</code>：</p>
<p>由常量数组<code>cc_op_live</code>完成（<code>target/i386/translate.c: 242~255</code>）。<code>cc_op_live</code>记录的是每个<code>cc_op</code>是否需要用到<code>cpu_cc_dst</code>, <code>cpu_cc_src</code>, <code>cpu_cc_src2</code>, <code>cc_srcT</code>。将不再需要的变量清理掉即可。</p>
</li>
<li>
<p>🤔从上面的问题衍生而来，在<code>set_cc_op</code>函数里并没有看到用<code>cc_op_live</code>来设置新的<code>cc_op</code>需要的<code>cpu_cc_dst</code>, <code>cpu_cc_src</code>, <code>cpu_cc_src2</code>, <code>cc_srcT</code>，那么这些设置代码在哪？</p>
<p>猜测，需要的时候再设置。</p>
</li>
</ol>
<p><strong>使用<code>cc_op</code>的场景</strong></p>
<p>当指令需要用到cc时（比如x86的cmov指令）会调用<code>target/i386/translate.c: 2269~2296: gen_prepare_cc</code>来计算cc，这个函数里就会用到<code>cc_op</code>。暂时没有详细去看这个函数。</p>
<h6 id="qemu对eflags的处理简要调研结束"><a class="header" href="#qemu对eflags的处理简要调研结束">QEMU对eflags的处理简要调研[结束]</a></h6>
<p>接下来接着看<code>gen_exception</code>和<code>gen_interrupt</code>函数，</p>
<p><strong>注</strong>：<code>gen_exception</code>和<code>gen_interrupt</code>类似，就看<code>gen_exception</code>好了。</p>
<p>其中<code>gen_helper_raise_exception</code>是个通过复杂宏定义的函数。🤔这有必要研究研究嵌套的宏函数的展开顺序！</p>
<p><code>include/exec/helper-head.h: 65</code>提到了</p>
<blockquote>
<p>We can't use glue() here because it falls foul of C preprocessor recursive expansion rules.</p>
</blockquote>
<p>是什么意思？</p>
<p>唯一的一处定义<code>dh_retvar_decl_void</code>在此，但是是空的。没有影响，只是为了好看而已，仔细看<code>include/exec/helper-gen.h:24</code>行尾展开<code>dh_retvar_decl_void</code>是没有逗号的。</p>
<p><code>gen_helper_raise_exception</code>的宏大体涉及到的宏函数如下，</p>
<p><img src="pictures/gen_exception-macro.svg" alt="gen_exception-macro" /></p>
<p><code>gen_helper_raise_exception</code>的宏全部展开后如下，（<strong>注</strong>：可以尝试一下用<code>gcc -E</code>来自动展开宏，不过QEMU的include关系很多是靠Makefile建立的，所以需要在configure时加参数才行）</p>
<pre><code class="language-c">static inline void gen_helper_raise_exception(TCGv_ptr arg1, TCGv_i32 arg2)
{
    TCGTemp *args[2] = {tcgv_ptr_temp(arg1), tcgv_i32_temp(arg2)};
    tcg_gen_callN(helper_raise_exception, ((void *)0), 2, args)
}
</code></pre>
<p>最后完成梳理的<code>gen_exception</code>如下，<span style="background:red; font-weight:bold; color:white">架构相关</span><img src="pictures/gen_exception.svg" alt="gen_exception" /></p>
<p>从上图看出，<code>tcg_gen_callN</code>是一个很长的处理过程，其中还调用了实质的helper函数<code>raise_interrupt2</code>，接下来就看这俩函数。</p>
<div style="font-size:3em; text-align:right;">2019.11.26</div>
##### `tcg_gen_callN`
<p>在<code>tcg_gen_callN</code>函数里发现了有趣的地方，这个函数开头的注释写的是将64位函数参数转化为32位函数参数并处理对其和尾端，<del>这样看来莫非中间语言TCG是一个32位的指令集？</del></p>
<p>在看<code>TCGOp</code>的定义时<code>tcg/tcg.h: 616~634</code>参数最大数量的宏<code>MAX_OPC_PARAM</code>的注释<code>tcg/tcg.h: 48~50</code>，</p>
<blockquote>
<p>A Call op needs up to 4 + 2N parameters on 32-bit archs, and up to 4 + N parameters on 64-bit archs (N = number of input arguments + output arguments).</p>
</blockquote>
<p>这样看来更应该<strong>把TCG理解成一个64位的指令集</strong>才更合理吧！</p>
<p>且要注意的是TCG的target和QEMU的target并不指向同一机器，参考TCG的<a href="../../../../Codes/qemu/tcg/README">README</a>第2部分Definitions，</p>
<ul>
<li>
<p>TCG的target是指用TCG生成的机器码的平台，<strong>TCG是原本C语言编译的中间语言</strong>，QEMU里的TCG保留了这些术语；</p>
<p>举个例子<code>tcg/tcg.c: 1751</code>出现的宏<code>TCG_TARGET_REG_BITS</code>对应的是我的笔记本REG_BITS即64位。</p>
</li>
<li>
<p>QEMU的target是被模拟的平台；</p>
</li>
</ul>
<p>所以<code>tcg_gen_callN</code>函数的开头的注释便能够理解了，比如<code>tcg/tcg.c: 1756~1757</code>，</p>
<pre><code class="language-c">            op-&gt;args[pi++] = temp_arg(ret);
            op-&gt;args[pi++] = temp_arg(ret + 1);
</code></pre>
<p>当TCG的目标平台是32位时则需要把TCG参数分成2个32位参数存进TCG目标平台，这自然而然形成了这样的代码<code>ret</code>是指向64位参数的低32位的指针，<code>ret+1</code>是指向64位参数的高32位的指针。</p>
<p>总的来说<code>tcg_gen_callN</code>函数完成了以下动作，<span style="background:green; font-weight:bold; color:white">架构无关</span>，</p>
<p><img src="pictures/tcg_gen_callN-formatted.svg" alt="tcg_gen_callN-formatted" /></p>
<h5 id="helper_raise_exceptionraise_interrupt2"><a class="header" href="#helper_raise_exceptionraise_interrupt2"><code>helper_raise_exception</code>（<code>raise_interrupt2</code>）</a></h5>
<p>目前想要搞清楚的问题是<code>cpu_exec</code>里那个“出乎意料的跳转”。目前已经看到了如何把调用<code>helper_raise_exception</code>的TCG指令放入了<code>tcg_ctx_ops</code>里，且<code>helper_raise_exception</code>实际为<code>target/i386/excp_helper.c: 88~108:raise_interrupt2</code>其返回类型为宏定义<code>QEMU_NORETURN</code>，很有可能那个“出乎意料的跳转”就是<code>raise_interrupt2</code>的no return的效果。</p>
<p><span style="background:red; font-weight:bold; color:white">架构相关</span></p>
<p>exception和interrupt都会调用到<code>target/i386/excp_helper.c: 88~108: raise_interrupt2</code>函数其中第3个参数<code>int is_int</code>是0则是exception，1则是interrupt。其主要操作如下，</p>
<p><img src="pictures/raise_interrupt2.svg" alt="raise_interrupt2" /></p>
<p>最后调用到了<code>siglongjmp</code>，这个函数会跳到最近一次执行的<code>sigsetjmp</code>处去，即<code>qemu/accel/tcg/cpu-exec.c: 689</code>。<code>setjmp</code>和<code>longjmp</code>的详细用法和功能可以参考manual page，下面是抽象出来的图，</p>
<p><img src="pictures/setjmp_longjmp.svg" alt="setjmp_longjmp" /></p>
<p>2020.8.21 v：以下笔记来自<a href="../x86-qemu-mips/check.html">xqm的check笔记</a>，</p>
<p>以<code>movl %ebx,(%eax) #8918</code>为例，</p>
<h4 id="tcghost-tcg_gen_code"><a class="header" href="#tcghost-tcg_gen_code">TCG=&gt;host: <code>tcg_gen_code</code></a></h4>
<p><img src="../x86-qemu-mips/pictures/tcg_gen_code-x86-formatted.svg" alt="tcg_gen_code-x86-formatted" /></p>
<p>2020.8.21 ^</p>
<p>2021.06.08: qemu-master (5.2.92) 存/取TCG指令被放到了<code>tcg_reg_alloc_op</code>=&gt;<code>tcg_out_op</code>中一起处理，后者位于<code>tcg/i386/tcg-target.c.inc</code>文件。<code>tcg_out_ldst_finalize</code>来生成系统态的访存慢路径。参考博士论文《Acceleration of memory accesses in dynamic binary
translation》。</p>
<h2 id="研读qemu的系统调用的处理方法结束"><a class="header" href="#研读qemu的系统调用的处理方法结束">研读QEMU的系统调用的处理方法[结束]</a></h2>
<p>现在的问题是QEMU执行翻译好的代码时遇到了系统调用需要调用helper函数跳出<code>cpu_exec</code>然后再来处理系统调用，而不是就在遇到系统调用的地方调用helper函数直接处理系统调用？X86toMips采用的方法是后者。</p>
<p>用汇编hello做实验发现int指令也是QEMU的TB的标志，所以用helper函数跳出<code>cpu_exec</code>和用helper函数直接处理系统调用然后TB结束回感觉没差别啊？</p>
<div style="font-size:3em; text-align:right;">2019.12.5</div>
🤔QEMU里guest转TCG时用到的TCG临时变量如何翻译成native代码的？临时变量数组在`tcg/tcg.h: 666 TCGContext`结构里。
<p>这个问题看TCG如何翻译成native的代码就好了，在<code>tb_gen_code</code>函数里调用的<code>tcg_gen_code</code>完成。</p>
<h1 id="cpustatecpuarchstatecpux86state之间的关系"><a class="header" href="#cpustatecpuarchstatecpux86state之间的关系">✔️🤔<code>CPUState</code>，<code>CPUArchState</code>，<code>CPUX86State</code>之间的关系？</a></h1>
<p><strong>答</strong>：</p>
<pre><code class="language-c">// target/i386/cpu.h: 1781~1782
typedef CPUX86State CPUArchState;
typedef X86CPU ArchCPU;
// 在其他架构里都有类似的声明，比如target/nios2/cpu.h: 240~241
typedef CPUNios2State CPUArchState;
typedef Nios2CPU ArchCPU;
</code></pre>
<p>可见<code>CPUArchState</code>和<code>ArchState</code>是<span style="background:green; font-weight:bold; color:white">架构无关</span>的类型，<strong>等价于</strong>，其<span style="background:red; font-weight:bold; color:white">架构相关</span>的<strong>别名</strong><code>CPUX86State</code>和<code>X86State</code>。</p>
<p><code>X86State</code>像是多继承了<code>CPUState</code>和<code>CPUX86State</code>，UML图如下，</p>
<p><img src="pictures/X86CPU-formatted.svg" alt="X86CPU-formatted" /></p>
<h1 id="qemu-i386操作寄存器的方式-cpuarchstate"><a class="header" href="#qemu-i386操作寄存器的方式-cpuarchstate">QEMU-i386操作寄存器的方式-CPUArchState</a></h1>
<p>在<a href="../%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BF%BB%E8%AF%91%E8%B0%83%E7%A0%94%E6%8A%A5%E5%91%8A%EF%BC%88LLBT%E7%9B%B8%E5%85%B3%EF%BC%89.html">二进制翻译调研报告（LLBT相关）.md</a>里用qemu打印出了汇编hello程序的TCG，在此做个拓展，以便验证一些猜想（免去花费长时间去看TCG）。✔️<strong>猜想</strong>：QEMU没有映射x86寄存器，而是每次去和CPUX86State里的寄存器变量打交道，</p>
<pre><code class="language-shell">qemu-ARCH -d help # 可以显示qemu-ARCH支持的输出内容
# 下面表格用到了的是out_asm、op
</code></pre>
<table><thead><tr><th align="left">源代码</th><th>未优化的QEMU IR（op）</th><th>out_asm</th></tr></thead><tbody>
<tr><td align="left">.section .data<br/>	output:	.ascii  &quot;Hello World\n&quot;<br/>.section .text<br/>.globl _start<br/>_start:</td><td></td><td></td></tr>
<tr><td align="left"></td><td></td><td>PROLOGUE略</td></tr>
<tr><td align="left"><strong>注</strong>：右边的代码用于统计信息见<code>include/exec/gen-icount.h: gen_tb_start</code>（by刘先喆）</td><td>ld_i32 tmp11,env,$0xfffffffffffffff0<br/>movi_i32 tmp12,$0x0<br/>brcond_i32 tmp11,tmp12,lt,$L0</td><td>mov    -0x14(%r14),%ebp<br/>test   %ebp,%ebp<br/>jl     0x562e2d6ce105</td></tr>
<tr><td align="left">movl	$4, %eax</td><td>movi_i32 tmp0,$0x4<br/>mov_i32 eax,tmp0</td><td>movl   $0x4,(%r14)</td></tr>
<tr><td align="left">movl	$1, %ebx</td><td>movi_i32 tmp0,$0x1<br/>mov_i32 ebx,tmp0gen_helper_</td><td>movl   $0x1,0xc(%r14)</td></tr>
<tr><td align="left">movl	$output, %ecx</td><td>movi_i32 tmp0,$0x8049096<br/>mov_i32 ecx,tmp0</td><td>movl   $0x8049096,0x4(%r14)</td></tr>
<tr><td align="left">movl	$12, %edx</td><td>movi_i32 tmp0,$0xc<br/>mov_i32 edx,tmp0</td><td>movl   $0xc,0x8(%r14)</td></tr>
<tr><td align="left">int	$0x80</td><td>movi_i32 tmp3,$0x8048088<br/>st_i32 tmp3,env,$0x20<br/>movi_i32 tmp11,$0x2<br/>movi_i32 tmp12,$0x80<br/>call raise_interrupt,$0x0,$0,env,tmp12,tmp11<br/>set_label $L0<br/>exit_tb $0x5597a136a043</td><td>movl   0x8048088,0x20(%r14)<br/>mov    %r14,%rdi<br/>mov 0x80,%esi<br/>mov 0x2,%edx<br/>callq 0x562e2d3a4870<br/>lea -0xc9(%rip),%rax<br/>jmpq   0x562e2d6ce018</td></tr>
<tr><td align="left"></td><td>ld_i32 tmp11,env,$0xfffffffffffffff0<br/>movi_i32 tmp12,$0x0<br/>brcond_i32 tmp11,tmp12,lt,$L0</td><td>mov    -0x14(%r14),%ebp<br/>test   %ebp,%ebp<br/>jl     0x562e2d6ce1f5</td></tr>
<tr><td align="left">movl	$1, %eax</td><td>movi_i32 tmp0,$0x1<br/>mov_i32 eax,tmp0</td><td>movl   $0x1,(%r14)</td></tr>
<tr><td align="left">movl	$0, %ebx</td><td>movi_i32 tmp0,$0x0<br/>mov_i32 ebx,tmp0</td><td>movl   $0x0,0xc(%r14)</td></tr>
<tr><td align="left">int	$0x80</td><td>movi_i32 tmp3,$0x8048094<br/>st_i32 tmp3,env,$0x20<br/>movi_i32 tmp11,$0x2<br/>movi_i32 tmp12,$0x80<br/>call raise_interrupt,$0x0,$0,env,tmp12,tmp11<br/>set_label $L0<br/>exit_tb $0x5597a136a183</td><td>movl   0x8048094,0x20(%r14)<br/>mov    %r14,%rdi<br/>mov    0x80,%esi<br/>mov    0x2,%edx<br/>callq  0x562e2d3a4870<br/>lea    -0xb9(%rip),%rax<br/>jmpq   0x562e2d6ce018</td></tr>
</tbody></table>
<p>这里可以很明显的看出，r14寄存器存的是指向<code>CPUArchState env</code>的指针，且<code>target_ulong regs[CPU_NB_REG]</code>变量刚好位于<code>CPUX86State</code>开头，一个寄存器32bit，完美对齐。所以QEMU确实没有映射x86寄存器，而是每次去和CPUX86State里的寄存器变量打交道。上面的猜想这样看来是正确。</p>
<p><strong>所以，QEMU在切换上下文时不再需要像X86toMips将映射寄存器的内容保存进env变量里！</strong></p>
<h1 id="qemu多进程和系统调用"><a class="header" href="#qemu多进程和系统调用">QEMU多进程和系统调用</a></h1>
<div style="font-size:3em; text-align:right;">2019.12.11</div>
## `do_fork`
<p>用汇编写的fork程序，可以正常运行，QEMU通过<code>do_fork</code>实现模拟fork函数，代码框架如下，<span style="background:green; font-weight:bold; color:white">架构无关</span>，</p>
<p><img src="pictures/do_fork-formatted.svg" alt="do_fork-formatted" /></p>
<h2 id="测试进程间通讯"><a class="header" href="#测试进程间通讯">测试进程间通讯</a></h2>
<p><code>mq_overview</code>的man page十分详细地介绍了message queue的用法，包括相关的系统调用。以下关于mq的信息均来自相关man page。</p>
<p>参考<a href="https://stackoverflow.com/questions/3056307/how-do-i-use-mqueue-in-a-c-program-on-a-linux-based-system">How do I use mqueue in a c program on a Linux based system?</a></p>
<p><strong>注</strong>：</p>
<ul>
<li><code>mq_open</code>的name参数必须是以<code>/</code>开头的字符串。来自<code>mq_overview</code>的man page</li>
<li>若<code>mq_open</code>里使用了<code>O_CREAT</code>标志，则必须提供<code>mode</code>和<code>attr</code>，其中<code>mode</code>的可选值参考open(2)的man page。来自<code>mq_overview</code>的man page。</li>
</ul>
<h3 id="相关的系统调用"><a class="header" href="#相关的系统调用">相关的系统调用</a></h3>
<p>来源<code>mq_overview</code>的man page，</p>
<blockquote>
<p><strong>Library interfaces and system calls</strong></p>
<p>In most cases the <code>mq_*()</code> library interfaces listed above are implemented on top of underlying system calls of the same  name. Deviations from this scheme are indicated in the following table:</p>
<table><thead><tr><th align="center">Library interface</th><th align="center">System call</th></tr></thead><tbody>
<tr><td align="center">mq_close(3)</td><td align="center">close(2)</td></tr>
<tr><td align="center">mq_getattr(3)</td><td align="center">mq_getsetattr(2)</td></tr>
<tr><td align="center">mq_notify(3)</td><td align="center">mq_notify(2)</td></tr>
<tr><td align="center">mq_open(3)</td><td align="center">mq_open(2)</td></tr>
<tr><td align="center">mq_receive(3)</td><td align="center">mq_timedreceive(2)</td></tr>
<tr><td align="center">mq_send(3)</td><td align="center">mq_timedsend(2)</td></tr>
<tr><td align="center">mq_setattr(3)</td><td align="center">mq_getsetattr(2)</td></tr>
<tr><td align="center">mq_timedreceive(3)</td><td align="center">mq_timedreceive(2)</td></tr>
<tr><td align="center">mq_timedsend(3)</td><td align="center">mq_timedsend(2)</td></tr>
<tr><td align="center">mq_unlink(3)</td><td align="center">mq_unlink(2)</td></tr>
</tbody></table>
</blockquote>

                    </main>
                    <script src="https://utteranc.es/client.js"
                        repo="xieby1/xieby1.github.io"
                        issue-term="pathname"
                        theme="github-light"
                        crossorigin="anonymous"
                        async>
                    </script>
                </div>
            </div>
        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
