<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>linux-user.md - xieby1&#x27;s notes</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../..//fonts/lxgwwenkai-regular.css" />
        <link rel="stylesheet" href="../..//fonts/lxgwwenkaimono-regular.css" />
        <link rel="stylesheet" href="../../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../custom.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../index.html">Welcome</a></li><li class="chapter-item "><a href="../../Essays.html">Essays</a></li><li class="chapter-item "><a href="../../abbreviations.html">abbreviations</a></li><li class="chapter-item affix "><li class="part-title">xieby1's notes</li><li class="chapter-item "><div>ABI</div></li><li class="chapter-item "><div>Algo</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Graph</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Algo/Graph/1998.distance.bunke.prl.775.html">1998.distance.bunke.prl.775.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2002.inexact_match.bengoetxea.doc_thesis.107.html">2002.inexact_match.bengoetxea.doc_thesis.107.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2014.attributed.zhang.cvpr.19.html">2014.attributed.zhang.cvpr.19.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2016.survey.yan.icmr.108.html">2016.survey.yan.icmr.108.md</a></li><li class="chapter-item "><a href="../../Algo/Graph/2021.igraphmatch.qiao..0.html">2021.igraphmatch.qiao..0.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div></li><li class="chapter-item "><div>Arch</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Cache</div></li><li class="chapter-item "><div>HT</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Arch/HT/2005.cell.kahle.ibmjrd.1093.html">2005.cell.kahle.ibmjrd.1093.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2012.process_migration.devuyst.asplos.83.html">2012.process_migration.devuyst.asplos.83.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2014.isa_explore.venkat.isca.112.html">2014.isa_explore.venkat.isca.112.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2015.overview.mitra.jip.15.html">2015.overview.mitra.jip.15.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2018.process_migration.venkat.doc_thesis.5.html">2018.process_migration.venkat.doc_thesis.5.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2019.composite_isa.venkat.hpca.17.html">2019.composite_isa.venkat.hpca.17.md</a></li><li class="chapter-item "><a href="../../Arch/HT/2020.byoc_framework.balkind.asplos.3.html">2020.byoc_framework.balkind.asplos.3.md</a></li><li class="chapter-item "><a href="../../Arch/HT/doc_thoughts.html">doc_thoughts.md</a></li></ol></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Arch/reconf/1997.chimaera.hauck.fccm.461.html">1997.chimaera.hauck.fccm.461.md</a></li><li class="chapter-item "><a href="../../Arch/reconf/2008.reconf_acc.beck.date.97.html">2008.reconf_acc.beck.date.97.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div></li></ol></li><li class="chapter-item "><div>Benchmarks</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Benchmarks/coremark.html">coremark.md</a></li><li class="chapter-item "><div>herdtools7</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Benchmarks/herdtools7/overview.html">å†…å­˜æ¨¡å‹æµ‹è¯•â€”â€”DIYï¼ˆHerdtoolsï¼‰</a></li></ol></li><li class="chapter-item "><a href="../../Benchmarks/spec/index.html">spec</a></li><li class="chapter-item "><a href="../../Benchmarks/spec2000.html">spec2000.md</a></li></ol></li><li class="chapter-item expanded "><div>BT</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>algo</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/2006.lib.æ¨æµ©.è®¡ç®—æœºç ”ç©¶ä¸å‘å±•.0.html">2006.lib.æ¨æµ©.è®¡ç®—æœºç ”ç©¶ä¸å‘å±•.0.md</a></li><li class="chapter-item "><a href="../../BT/algo/2016.static_identify_jump_target.federico.cases.9.html">2016.static_identify_jump_target.federico.cases.9.md</a></li><li class="chapter-item "><div>bt_rules</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/bt_rules/2006.peephole_superopt.bansal.asplos.134.html">2006.peephole_superopt.bansal.asplos.134.md</a></li><li class="chapter-item "><a href="../../BT/algo/bt_rules/2018.learn.wwwang.asplos.11.html">2018.learn.wwwang.asplos.11.md</a></li></ol></li><li class="chapter-item "><div>offload</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/offload/2010.distribit.guan.hpdc.5.html">2010.distribit.guan.hpdc.5.md</a></li></ol></li><li class="chapter-item "><div>reg</div></li><li class="chapter-item "><div>smc</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/smc/2015.detect.hawkins.cgo.24.html">2015.detect.hawkins.cgo.24.md</a></li></ol></li><li class="chapter-item "><div>trace</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/algo/trace/1994.opt_profiling_tracing.ball.toplas.580.html">1994.opt_profiling_tracing.ball.toplas.580.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2000.net.duesterwald.asplos.141.html">2000.net.duesterwald.asplos.141.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2005.edge_profile.ç™½ç«¥å¿ƒ.è®¡ç®—æœºå·¥ç¨‹.2.html">2005.edge_profile.ç™½ç«¥å¿ƒ.è®¡ç®—æœºå·¥ç¨‹.2.md</a></li><li class="chapter-item "><a href="../../BT/algo/trace/2005.lei_net.hiniker.micro.39.html">2005.lei_net.hiniker.micro.39.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/analysis/2014.simulators_harm.nowatki..19.html">2014.simulators_harm.nowatki..19.md</a></li><li class="chapter-item "><a href="../../BT/analysis/2020.perfdbt.wu.iccd.2.html">2020.perfdbt.wu.iccd.2.md</a></li></ol></li><li class="chapter-item "><div>application</div></li><li class="chapter-item "><div>Box86</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/Box86/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>dynamic</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/dynamic/2017.mambox64.dantras.pldi.18.html">2017.mambox64.dantras.pldi.18.md</a></li></ol></li><li class="chapter-item "><a href="../../BT/exagear.html">exagear.md</a></li><li class="chapter-item "><div>HQEMU</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HQEMU/codeReading-deprecated.html">codeReading-deprecated.md</a></li><li class="chapter-item "><a href="../../BT/HQEMU/codeReading.html">codeReading.md</a></li></ol></li><li class="chapter-item "><div>HW</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/2008.coprocessor.li.amasbt.3.html">2008.coprocessor.li.amasbt.3.md</a></li><li class="chapter-item "><a href="../../BT/HW/2009.godson3_x86_emu.hu.micro.84.html">2009.godson3_x86_emu.hu.micro.84.md</a></li><li class="chapter-item "><div>codeCache</div></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/reconf/2013.x86_mips_reconf.junior.jsa.4.html">2013.x86_mips_reconf.junior.jsa.4.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/VLIW/2015.denver.nvidia.micro.36.html">2015.denver.nvidia.micro.36.md</a></li><li class="chapter-item "><a href="../../BT/HW/VLIW/2019.hybrid_dbt.rokicki.cadics.2.html">2019.hybrid_dbt.rokicki.cadics.2.md</a></li><li class="chapter-item "><div>crusoe</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/HW/VLIW/crusoe/2000.crusoe.klaiber.transmeta.118.html">2000.crusoe.klaiber.transmeta.118.md</a></li></ol></li><li class="chapter-item "><div>daisy</div></li></ol></li></ol></li><li class="chapter-item "><div>kernel</div></li><li class="chapter-item "><a href="../../BT/libDBT/index.html">libDBT</a></li><li class="chapter-item "><div>lift</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>IR</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>LLBT</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/LLBT/LLBTè°ƒç ”.html">LLBTè°ƒç ”</a></li><li class="chapter-item "><a href="../../BT/lift/IR/LLBT/äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Šï¼ˆLLBTç›¸å…³ï¼‰.html">äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Šï¼ˆLLBTç›¸å…³ï¼‰.md</a></li></ol></li><li class="chapter-item "><div>mcsema</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/2019.mcsema_dyninst.korencik...html">2019.mcsema_dyninst.korencik...md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/2019.mcsema.researchLogs.html">2019.mcsema.researchLogs.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mcsema/remill.html">remill.md</a></li></ol></li><li class="chapter-item "><div>mctoll</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/2019.mctoll.yadavalli.lctes.5.html">2019.mctoll.yadavalli.lctes.5.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/codesReading.html">codesReading.md</a></li><li class="chapter-item "><a href="../../BT/lift/IR/mctoll/run.html">run.md</a></li></ol></li><li class="chapter-item "><a href="../../BT/lift/IR/overview.html">overview.md</a></li><li class="chapter-item "><div>REVNG</div></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/Mem/2008.thread_safe_by_tm.chung.hpca.51.html">2008.thread_safe_by_tm.chung.hpca.51.md</a></li><li class="chapter-item "><a href="../../BT/Mem/2016.atomic.rigo.taco.6.html">2016.atomic.rigo.taco.6.md</a></li></ol></li><li class="chapter-item "><div>oldProj</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/oldProj/1993.mips2alphaaxp.sites.cacm.267.html">1993.mips2alphaaxp.sites.cacm.267.md</a></li><li class="chapter-item "><a href="../../BT/oldProj/1998.fx32.chernoff.micro.217.html">1998.fx32.chernoff.micro.217.md</a></li><li class="chapter-item "><div>dbt4AndStatic</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/DBT4ä»£ç é˜…è¯»ç¬”è®°.html">DBT4ä»£ç é˜…è¯»ç¬”è®°</a></li><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/dbt-static.html">dbt-static.md</a></li><li class="chapter-item "><a href="../../BT/oldProj/dbt4AndStatic/å»é™¤orcå·¥ä½œé‡å’Œéš¾åº¦.html">ORCçš„CGIR</a></li></ol></li></ol></li><li class="chapter-item "><div>others</div></li><li class="chapter-item "><div>overview</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/overview/2001.bt_opt_challenges.altman.pieee.38.html">2001.bt_opt_challenges.altman.pieee.38.md</a></li><li class="chapter-item "><a href="../../BT/overview/2004.bibliography_of_simulators.html">2004.bibliography_of_simulators.md</a></li></ol></li><li class="chapter-item expanded "><div>QEMU</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/QEMU/16k.html">16k.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/2005.qemu.bellard.usenix.2217.html">2005.qemu.bellard.usenix.2217.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/2017.qemu_multi_cores.cota.cgo.8.html">2017.qemu_multi_cores.cota.cgo.8.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/LA-backend.html">LA-backend.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/linux-user-32.html">linux-user-32.md</a></li><li class="chapter-item expanded "><a href="../../BT/QEMU/linux-user.html" class="active">linux-user.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/linux-user-memory_region.html">linux-user-memory_region.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/logs.html">logs.md</a></li><li class="chapter-item "><div>lx</div></li><li class="chapter-item "><a href="../../BT/QEMU/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../BT/QEMU/signal.html">signal.md</a></li><li class="chapter-item "><div>target</div></li><li class="chapter-item "><a href="../../BT/QEMU/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>rewrite</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/rewrite/2018.superset_disassembly.bauman.ndss.40.html">2018.superset_disassembly.bauman.ndss.40.md</a></li><li class="chapter-item "><div>instru</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/rewrite/instru/2009.mt.hazelwood.ismm.28.html">2009.mt.hazelwood.ismm.28.md</a></li><li class="chapter-item "><a href="../../BT/rewrite/instru/mem_count.html">mem_count.md</a></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>static</div></li><li class="chapter-item "><div>sys</div></li><li class="chapter-item "><div>Tarmac</div></li><li class="chapter-item "><div>test</div></li><li class="chapter-item "><div>x86-qemu-mips</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/x86-qemu-mips/check_manual.html">x86-qemu-mips checkæ‰‹å†Œ</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/check.html">check.md</a></li><li class="chapter-item "><div>debugs</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/x86-qemu-mips/debugs/OPEN.unknown-loop-in-bios.html">OPEN.unknown-loop-in-bios.md</a></li></ol></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/linux-user.html">x86-qemu-mipsåšå‡ºçš„ä¿®æ”¹</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/mips-llvm.html">mips-llvm.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../BT/x86-qemu-mips/tr_miscä¿®æ”¹è®°å½•.html">tr_miscä¿®æ”¹è®°å½•.md</a></li></ol></li><li class="chapter-item "><div>X86toMips</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../BT/X86toMips/dbtæµ‹è¯•ç»“æœ.html">dbtæµ‹è¯•ç»“æœ.md</a></li><li class="chapter-item "><a href="../../BT/X86toMips/Pseudo-README.html">Pseudo-README.md</a></li><li class="chapter-item "><a href="../../BT/X86toMips/X86toMipsè°ƒç ”.html">æ­¦æˆå²—</a></li><li class="chapter-item "><a href="../../BT/X86toMips/X86toMipsè°ƒç ”-ç»­.html">X86toMipsè°ƒç ”-ç»­.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Build</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Autotools</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Autotools/2012.autotools_criticism.kamp..html">2012.autotools_criticism.kamp..md</a></li><li class="chapter-item "><a href="../../Build/Autotools/autotools.html">autotools.md</a></li></ol></li><li class="chapter-item "><div>CMake</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/CMake/Notes.html">CMkake Notes</a></li></ol></li><li class="chapter-item "><div>Compiler</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/1992.hyperblock.mahlke.micro.html">1992.hyperblock.mahlke.micro.md</a></li><li class="chapter-item "><div>llvm</div></li><li class="chapter-item "><div>mingw</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/mingw/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>ORC</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Compiler/ORC/2004.ORC-LCPC04-Tutorial.html">2004.ORC-LCPC04-Tutorial.md</a></li><li class="chapter-item "><a href="../../Build/Compiler/ORC/2004.overview_orc.wuchengyong.iwlcpc.html">2004.overview_orc.wuchengyong.iwlcpc.md</a></li></ol></li><li class="chapter-item "><div>trans</div></li></ol></li><li class="chapter-item "><div>Disassemble</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Disassemble/2002.disassembly.bschwarz.pieee.html">2002.disassembly.bschwarz.pieee.md</a></li></ol></li><li class="chapter-item "><a href="../../Build/ELF/index.html">ELF</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/ELF/ELFè°ƒç ”.html">å‰æ²¿</a></li><li class="chapter-item "><a href="../../Build/ELF/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Linker_Loader</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Build/Linker_Loader/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Build/mingw.html">Windows Development Environment on Linux</a></li></ol></li><li class="chapter-item "><a href="../../cheatsheet.html">cheatsheet.md</a></li><li class="chapter-item "><div>CLI</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CLI/term_pty_sh.html">term_pty_sh.md</a></li></ol></li><li class="chapter-item "><div>CompatLayer</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/2006.linuxulator.divacky.freebsd..html">2006.linuxulator.divacky.freebsd..md</a></li><li class="chapter-item "><a href="../../CompatLayer/Alky.html">Alky.md</a></li><li class="chapter-item "><div>UML</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/UML/user_mode_linux.html">user_mode_linux.md</a></li></ol></li><li class="chapter-item "><div>WINE</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../CompatLayer/WINE/2020_6_25.emu_win_syscall.corbet.lwn.html">2020_6_25.emu_win_syscall.corbet.lwn.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Design_of_WINE.html">wineä¸­çš„å„ç±»è®¾è®¡</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/optimizable.html">optimizable.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/others.html">others.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wine-logs.html">qemu-wine-logs.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-winetest_debug_logs.html">qemu-winetest_debug_logs.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/qemu-wineç¯å¢ƒæ­å»º.html">qemu-wineç¯å¢ƒæ­å»º.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/References.html">Wineç›¸å…³èµ„æ–™</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Winegccè°ƒç ”.html">æœ€ç»ˆç›®æ ‡</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/Winelibè°ƒç ”æŠ¥å‘Š.html">Winelibè°ƒç ”æŠ¥å‘Š.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/WINEè®¾å¤‡é©±åŠ¨è°ƒç ”.html">èƒŒæ™¯</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/WINEè°ƒç ”.html">Wineè°ƒç ”</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Š_FX32_Wine.html">äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Š_FX32_Wine.md</a></li><li class="chapter-item "><a href="../../CompatLayer/WINE/äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Š_Wine.html">äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Š_Wine.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Connect</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/index.html">Bluetooth</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>bluez</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/bluez/profile_input.html">æ€»ä½“æ¶æ„</a></li></ol></li><li class="chapter-item "><div>btkbdd</div></li><li class="chapter-item "><div>dbus</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/dbus/Overview.html">Overview.md</a></li></ol></li><li class="chapter-item "><div>Essays</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>2005.bluez_intro.albert</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/Essays/2005.bluez_intro.albert/An_Introduction_to_Bluetooth_Programming.html">An Introduction to Bluetooth Programming</a></li></ol></li><li class="chapter-item "><a href="../../Connect/Bluetooth/Essays/é˜…è¯»è®°å½•.html">HID_v1.1.1</a></li></ol></li><li class="chapter-item "><div>hidclient</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Bluetooth/hidclient/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Network</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>bittorrent</div></li><li class="chapter-item "><div>nginx</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Connect/Network/nginx/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><a href="../../Connect/Network/p2p.html">p2p.md</a></li><li class="chapter-item "><a href="../../Connect/Network/streaming_server.html">streaming_server.md</a></li></ol></li><li class="chapter-item "><div>NFC</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Essays</div></li></ol></li></ol></li><li class="chapter-item "><div>dataViz</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../dataViz/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Distro</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Distro/JingOS.html">JingOS.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/index.html">Nix</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Distro/Nix/32bit.html">æ‰“åŒ…/ç¼–è¯‘32ä½ç¨‹åº</a></li><li class="chapter-item "><a href="../../Distro/Nix/android.html">åœ¨NixOSä¸Šä½¿ç”¨Androidç¨‹åº</a></li><li class="chapter-item "><a href="../../Distro/Nix/backup_binary_cache.html">å¤‡ä»½binary cache</a></li><li class="chapter-item "><a href="../../Distro/Nix/cross.html">Nixäº¤å‰ç¼–è¯‘å’Œè·¨å¹³å°ç¨‹åº</a></li><li class="chapter-item "><a href="../../Distro/Nix/deb_feishu.html">å®‰è£…debåŒ…ï¼Œä»¥é£ä¹¦ä¸ºä¾‹</a></li><li class="chapter-item "><a href="../../Distro/Nix/gnome.html">Gnome in NixOS</a></li><li class="chapter-item "><a href="../../Distro/Nix/nixpkgs.html">nixpkgs.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/node.html">node.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/productivity.html">productivity.md</a></li><li class="chapter-item "><a href="../../Distro/Nix/python.html">Python in Nix/NixOS</a></li><li class="chapter-item "><a href="../../Distro/Nix/README-en.html">Nix/NixOS</a></li><li class="chapter-item "><a href="../../Distro/Nix/static_qemu.html">é™æ€é“¾æ¥ï¼Œä»¥qemuä¸ºä¾‹</a></li><li class="chapter-item "><a href="../../Distro/Nix/vim.html">Vim in Nix/NixOS</a></li><li class="chapter-item "><a href="../../Distro/Nix/wayland.html">Currently, Not Wayland, But X11</a></li><li class="chapter-item "><a href="../../Distro/Nix/weird.html">Weird Things in Nix/NixOS</a></li></ol></li></ol></li><li class="chapter-item "><div>Emulator</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Emulator_Design</div></li><li class="chapter-item "><div>gem5</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Emulator/gem5/logs.html">logs.md</a></li><li class="chapter-item "><a href="../../Emulator/gem5/python.html">Python in Gem5</a></li></ol></li></ol></li><li class="chapter-item "><div>EPaper</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../EPaper/laptop.html">laptop.md</a></li></ol></li><li class="chapter-item "><div>fonts</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>files</div></li></ol></li><li class="chapter-item "><div>FPGA</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../FPGA/iverilog.html">iverilog.md</a></li></ol></li><li class="chapter-item "><div>hackthon</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../hackthon/Untitled.html">Untitled.md</a></li></ol></li><li class="chapter-item "><div>Input</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Input/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>ISA</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/2013.power_of_risc_cisc.blem.hpca.144.html">2013.power_of_risc_cisc.blem.hpca.144.md</a></li><li class="chapter-item "><div>arm</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/arm/aarch64.html">aarch64.md</a></li></ol></li><li class="chapter-item "><div>enhance</div></li><li class="chapter-item "><div>mips</div></li><li class="chapter-item "><div>mips_lx</div></li><li class="chapter-item "><div>riscv</div></li><li class="chapter-item "><a href="../../ISA/Semantics/index.html">Semantics</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Semantics/2013.locate.lakhotia.pprew.75.html">2013.locate.lakhotia.pprew.75.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2014.lem.mulligan.icfp.79.html">2014.lem.mulligan.icfp.79.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2015.sail.gray.micro.31.html">2015.sail.gray.micro.31.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2016.learn.heule.pldi.56.html">2016.learn.heule.pldi.56.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2018.sail.armstrong..3.html">2018.sail.armstrong..3.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2019.x64_validation.dasgupta.sigplan.24.html">2019.x64_validation.dasgupta.sigplan.24.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/2021.sail.armstrong.manual.html">2021.sail.armstrong.manual.md</a></li><li class="chapter-item "><a href="../../ISA/Semantics/asmjit.html">AsmJit</a></li><li class="chapter-item "><div>k</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Semantics/k/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>ultrasparc</div></li><li class="chapter-item "><div>Uop</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../ISA/Uop/1990.nec_intel.elkins...html">1990.nec_intel.elkins...md</a></li><li class="chapter-item "><a href="../../ISA/Uop/1996.palcode..manual..html">1996.palcode..manual..md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2003.ucache.solomon.tvlsi.13.html">2003.ucache.solomon.tvlsi.13.md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2019.reverse_engineer.koppe.usenix_security.16.html">2019.reverse_engineer.koppe.usenix_security.16.md</a></li><li class="chapter-item "><a href="../../ISA/Uop/2020.improve_ucache.kotra.micro.1.html">2020.improve_ucache.kotra.micro.1.md</a></li></ol></li><li class="chapter-item "><div>x86</div></li></ol></li><li class="chapter-item "><div>JIT</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../JIT/2008.llvm_sim.brandner..29.html">2008.llvm_sim.brandner..29.md</a></li><li class="chapter-item "><a href="../../JIT/2011.llvm_sim.helmstetter.imecs.6.html">2011.llvm_sim.helmstetter.imecs.6.md</a></li><li class="chapter-item "><div>dynarmic</div></li><li class="chapter-item "><div>opt</div></li></ol></li><li class="chapter-item "><a href="../../Kernel/index.html">Kernel</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/2020_9_9.prepare_new_feat.edge.lwn-lpc.html">2020_9_9.prepare_new_feat.edge.lwn-lpc.md</a></li><li class="chapter-item "><div>Driver</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Driver/2019.linux_win_printer.é‡‘èé€š.è½¯ä»¶æ‰€ç¡•å£«.html">2019.linux_win_printer.é‡‘èé€š.è½¯ä»¶æ‰€ç¡•å£«.md</a></li></ol></li><li class="chapter-item "><div>exo</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/exo/1995.intro.engler.sosp.1259.html">1995.intro.engler.sosp.1259.md</a></li></ol></li><li class="chapter-item "><div>Linux</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/2002.rcu.mckenney..216.html">2002.rcu.mckenney..216.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2016.sched_bug.lozi.eurosys.120.html">2016.sched_bug.lozi.eurosys.120.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2018.concurrency.alglave.asplos.31.html">2018.concurrency.alglave.asplos.31.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/2020.rcu.mckenney...html">2020.rcu.mckenney...md</a></li><li class="chapter-item "><div>Android</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/Android/anbox.html">anbox.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/to_mainline.html">to_mainline.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/Android/Waydroid.html">Waydroid.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Linux/cache_alias.html">ğŸš§cacheåˆ«åã€é¡µç€è‰²</a></li><li class="chapter-item "><a href="../../Kernel/Linux/cache_alias_page_color.html">cache_alias_page_color.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/docsReading.html">docsReading.md</a></li><li class="chapter-item "><div>drivers</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Linux/drivers/ioctl.html">ioctl.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/drivers/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Linux/idle.html">idle.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/lx.html">lx.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/memory_mapping.html">memory_mapping.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/module.logs.html">module.logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/mtlb.logs.html">mtlb.logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/page_fault.html">do_page_faultæºç åˆ†æ</a></li><li class="chapter-item "><a href="../../Kernel/Linux/page_size.html">page_size.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/QnA-alpine.html">QnA-alpine.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/startup.html">startup.md</a></li><li class="chapter-item "><a href="../../Kernel/Linux/syscalls.html">syscalls.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/memory.html">memory.md</a></li><li class="chapter-item "><div>micro</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/micro/1995.u_kernel.lietdke.sosp.308.html">1995.u_kernel.lietdke.sosp.308.md</a></li><li class="chapter-item "><a href="../../Kernel/micro/2013.l3_sel4.elphinstone.sosp.126.html">2013.l3_sel4.elphinstone.sosp.126.md</a></li></ol></li><li class="chapter-item "><div>multi</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/multi/2009.intro.baumann.sosp.856.html">2009.intro.baumann.sosp.856.md</a></li></ol></li><li class="chapter-item "><div>syscall</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/syscall/2020_9_8.extensible_syscall.corbet.lwn-lpc.html">2020_9_8.extensible_syscall.corbet.lwn-lpc.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/transkernel.html">transkernel.md</a></li><li class="chapter-item "><div>unikernel</div></li><li class="chapter-item "><div>WinCmptbl</div></li><li class="chapter-item "><div>Windows</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Windows/compilation.html">compilation.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/index.html">driver</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/Windows/driver/ddiwrapper.html">ddiwrapper.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/logs-1.html">logs-1.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/logs.html">logs.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/ndis.html">ndis.md</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>err</div></li></ol></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/printer.html">é©±åŠ¨å®‰è£…åŒ…æ„æˆ</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/driver/types.html">types.md</a></li></ol></li><li class="chapter-item "><a href="../../Kernel/Windows/nameConventions.html">Windowså‘½åé£æ ¼</a></li><li class="chapter-item "><a href="../../Kernel/Windows/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/ReactOS/index.html">ReactOS</a></li><li class="chapter-item "><a href="../../Kernel/Windows/service.html">service.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/subsystem.html">subsystem.md</a></li><li class="chapter-item "><a href="../../Kernel/Windows/syscall.html">syscall.md</a></li></ol></li><li class="chapter-item "><div>XNU</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Darling</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Kernel/XNU/Darling/overview.html">overview.md</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><div>Lang</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Asm</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Asm/asm.html">asm.md</a></li><li class="chapter-item "><div>riscv</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Asm/riscv/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../Lang/awk.html">AWK</a></li><li class="chapter-item "><a href="../../Lang/bc.html">BC</a></li><li class="chapter-item "><div>C.f</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/C.f/macro.html">macro.md</a></li></ol></li><li class="chapter-item "><div>Dot</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/Dot/overview.html">overview.md</a></li><li class="chapter-item "><a href="../../Lang/Dot/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>IR</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/IR/1999.JVM_Specification.html">1999.JVM_Specification.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2000.llvm.lattner.master_thesis.241.html">2000.llvm.lattner.master_thesis.241.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2004.llvm.lattner.cgo.4340.html">2004.llvm.lattner.cgo.4340.md</a></li><li class="chapter-item "><a href="../../Lang/IR/2013.importance.chow...html">2013.importance.chow...md</a></li><li class="chapter-item "><div>Common2</div></li><li class="chapter-item "><a href="../../Lang/IR/LLVM-IR.html">LLVM-IR.md</a></li><li class="chapter-item "><a href="../../Lang/IR/MapleIRDesign.html">Introduction </a></li></ol></li><li class="chapter-item "><div>JS</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/JS/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Latex</div></li><li class="chapter-item "><div>Lisp</div></li><li class="chapter-item "><div>Py</div></li><li class="chapter-item "><div>SMT-LIB</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/SMT-LIB/2012.smt_lib_v2.cok..47.html">2012.smt_lib_v2.cok..47.md</a></li></ol></li><li class="chapter-item "><div>WebAsm</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lang/WebAsm/2017.intro.haas.pldi.194.html">2017.intro.haas.pldi.194.md</a></li><li class="chapter-item "><a href="../../Lang/WebAsm/overview.html">overview.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Lib</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>Glibc</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/Glibc/glibc.html">glibc.md</a></li><li class="chapter-item "><a href="../../Lib/Glibc/mmap.html">mmapç‰¹æ€§</a></li><li class="chapter-item "><a href="../../Lib/Glibc/pthread.html">pthread.md</a></li><li class="chapter-item "><a href="../../Lib/Glibc/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>igraph</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/igraph/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Libc</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Lib/Libc/Musl/index.html">Musl</a></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Mem/cat.html">cat.md</a></li><li class="chapter-item "><div>model</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Mem/model/2017.memalloy.wickerson.popl.77.html">2017.memalloy.wickerson.popl.77.md</a></li></ol></li><li class="chapter-item "><a href="../../Mem/order.html">C++11è®¿å­˜é¡ºåº</a></li><li class="chapter-item "><a href="../../Mem/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>Opinions</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Opinions/notes.html">notes.md</a></li><li class="chapter-item "><a href="../../Opinions/openEcoSys.html">openEcoSys.md</a></li></ol></li><li class="chapter-item "><div>other_read_list</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other_read_list/cambridge.html">Cambrige Advanced Topics in Computer Architecture Reading List</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/index.html">stanford</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other_read_list/stanford/1999.codesigned_vm.smith.iwia.html">1999.codesigned_vm.smith.iwia.md</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/2001.vm_intro.smith.html">2001.vm_intro.smith.md</a></li><li class="chapter-item "><a href="../../other_read_list/stanford/2002.vector_vs_ss.kozyrakis.micro.html">2002.vector_vs_ss.kozyrakis.micro.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Perf</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Perf/flamegraph.html">flamegraph.md</a></li></ol></li><li class="chapter-item "><div>PoSh</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../PoSh/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Proj/index.html">Proj</a></li><li class="chapter-item "><div>Pwr</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Pwr/2009.mcpat.li.micro.2319.html">2009.mcpat.li.micro.2319.md</a></li></ol></li><li class="chapter-item "><a href="../../QnA-Daliy.html">QnA-Daliy.md</a></li><li class="chapter-item "><div>Repos</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Repos/llvm-tutor.html">llvm-tutor.md</a></li></ol></li><li class="chapter-item "><div>Sandbox</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Sandbox/chroot.html">chroot.md</a></li><li class="chapter-item "><div>Docker</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Sandbox/Docker/Overview.html">Overview.md</a></li><li class="chapter-item "><a href="../../Sandbox/Docker/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../Sandbox/proot.html">proot.md</a></li></ol></li><li class="chapter-item "><a href="../../scripts/index.html">scripts</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>bash</div></li><li class="chapter-item "><div>nix</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>shell_gem5</div></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>SftwStack</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../SftwStack/applications_arch.html">applications_arch.md</a></li><li class="chapter-item "><a href="../../SftwStack/linux_desktop.html">linux_desktop.md</a></li></ol></li><li class="chapter-item "><div>Sim</div></li><li class="chapter-item "><div>Softwares</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Softwares/ocrmypdf.html">ocrmypdf.md</a></li><li class="chapter-item "><a href="../../Softwares/pandoc.html">pandoc.md</a></li><li class="chapter-item "><a href="../../Softwares/tree_timeline_note.html">tree_timeline_note.md</a></li><li class="chapter-item "><div>Vim</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Softwares/Vim/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../SPIN.html">SPIN.md</a></li><li class="chapter-item "><div>SQL</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../SQL/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>SymExec</div></li><li class="chapter-item "><div>Temp</div></li><li class="chapter-item "><div>uArch</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>TLB</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../uArch/TLB/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Virt</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/1988.386.smith.programmers_journal..html">1988.386.smith.programmers_journal..md</a></li><li class="chapter-item "><a href="../../Virt/2002.esx.waldspurger.opsr.1402.html">2002.esx.waldspurger.opsr.1402.md</a></li><li class="chapter-item "><a href="../../Virt/2003.xen.barham.opsr.6475.html">2003.xen.barham.opsr.6475.md</a></li><li class="chapter-item "><a href="../../Virt/2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.html">2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.md</a></li><li class="chapter-item "><a href="../../Virt/2006.cmp_soft_hard_x86.adams.asplos.700.html">2006.cmp_soft_hard_x86.adams.asplos.700.md</a></li><li class="chapter-item "><a href="../../Virt/2012.dune.belay.osdi.215.html">2012.dune.belay.osdi.215.md</a></li><li class="chapter-item "><div>addr_trans</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/addr_trans/2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.html">2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/BT/2016.cross_arch_captive.spink.taco.3.html">2016.cross_arch_captive.spink.taco.3.md</a></li><li class="chapter-item "><a href="../../Virt/BT/2019.cross_arch_captive.spink.usenix.1.html">2019.cross_arch_captive.spink.usenix.1.md</a></li></ol></li><li class="chapter-item "><a href="../../Virt/overview.html">overview.md</a></li><li class="chapter-item "><div>virtualBox</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../Virt/virtualBox/install.html">install.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Write</div></li><li class="chapter-item "><a href="../../X11/index.html">X11</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../X11/windowManage.html">windowManage.md</a></li></ol></li><li class="chapter-item "><div>è¡Œä¸šæŠ¥å‘Š</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>LF</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../è¡Œä¸šæŠ¥å‘Š/LF/2020-Linux-Foundation-Annual-Report_120520.html">2020-Linux-Foundation-Annual-Report_120520.md</a></li><li class="chapter-item "><a href="../../è¡Œä¸šæŠ¥å‘Š/LF/FINOS-business-value-of-open-source.html">FINOS-business-value-of-open-source.md</a></li></ol></li><li class="chapter-item "><div>Nix</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../è¡Œä¸šæŠ¥å‘Š/Nix/2021.summur.html">2021.summur.md</a></li></ol></li><li class="chapter-item "><div>ä¼ä¸šå¹´æŠ¥</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><div>apple</div></li><li class="chapter-item "><div>åä¸º</div></li><li class="chapter-item "><div>æµ·ä¿¡</div></li><li class="chapter-item "><div>è”æƒ³</div></li></ol></li><li class="chapter-item "><div>ä¿¡é€šé™¢</div></li><li class="chapter-item "><div>å›½å®¶</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../è¡Œä¸šæŠ¥å‘Š/å›½å®¶/2006_2022.å›½å®¶ä¸­é•¿æœŸç§‘å­¦å’ŒæŠ€æœ¯å‘å±•è§„åˆ’çº²è¦.html">å›½å®¶ä¸­é•¿æœŸç§‘å­¦å’ŒæŠ€æœ¯å‘å±•è§„åˆ’çº²è¦ï¼ˆ2006â”2020å¹´ï¼‰</a></li></ol></li><li class="chapter-item "><div>ç½‘ä¿¡è‡ªä¸»åˆ›æ–°</div><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../è¡Œä¸šæŠ¥å‘Š/ç½‘ä¿¡è‡ªä¸»åˆ›æ–°/2020.html">2020.md</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="shuimitao">æ°´èœœæ¡ƒ</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title">xieby1&#x27;s notes</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/xieby1/xieby1.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>æ ‡è®°ï¼š<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span>ï¼Œ<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span></p>
<div style="font-size:3em; text-align:right;">2019.11.12</div>
ä¸Šå‘¨å››ç»„ä¼šæ˜ç¡®æŒ‡å‡ºç›®å‰çš„å·¥ç¨‹æ–¹å‘æ˜¯ä»¥QEMUçš„ç”¨æˆ·çº§æ¨¡æ‹Ÿï¼ˆlinux-userï¼‰åŸºç¡€ï¼Œå»é™¤å…¶ç”Ÿæˆä¸­é—´çš„è¿‡ç¨‹ï¼ŒåƒX86toMipsä¸€æ ·ç›´æ¥ä»X86åˆ°Mipsã€‚åœ¨æˆ‘çœ‹æ¥è¦å®Œæˆè¿™ä¸ªå·¥ä½œï¼Œé¦–å…ˆè¦ç†Ÿæ‚‰QEMU linux-userçš„ä»£ç æ¡†æ¶ï¼Œç„¶åæ‰èƒ½åˆ†æå¦‚ä½•å»ç®€åŒ–QEMUçš„ç¿»è¯‘è¿‡ç¨‹ã€‚æ‰€ä»¥é¦–å…ˆå»å˜æ¸…QEMU linux-userçš„ä»£ç å§ã€‚8æœˆä»½æœ‰åšç®€å•çš„è°ƒç ”ï¼Œè§[logs.md](logs.md)ï¼Œå¯ä»¥ä¾›è‡ªå·±å‚è€ƒã€‚
<h1 id="è¯»ä»£ç å‰çš„å‡†å¤‡"><a class="header" href="#è¯»ä»£ç å‰çš„å‡†å¤‡">è¯»ä»£ç å‰çš„å‡†å¤‡</a></h1>
<p>ç”¨clionæ‰“å¼€ä¹‹å‰ç”¨compiledbå¤„ç†å¥½çš„qemuï¼Œå‘ç°<code>i386/cpu_loop.c</code>é‡Œæœ‰æœªèƒ½æ‰¾åˆ°å®šä¹‰è€Œæç¤ºé”™è¯¯çš„å‡½æ•°ï¼Œä¸”git fetchå‘ç°å·²ç»è½åäº†200+ä¸ªcommitsï¼Œæ‰€ä»¥æƒ³æ¸…é™¤æ‰ä¹‹å‰make installçš„å†…å®¹ã€‚</p>
<h2 id="æ¸…é™¤ä¹‹å‰çš„make-insall"><a class="header" href="#æ¸…é™¤ä¹‹å‰çš„make-insall">æ¸…é™¤ä¹‹å‰çš„make insall</a></h2>
<p>è‹¦äºqemuçš„Makefileæ²¡æœ‰æä¾›make uninstallä¹‹ç±»çš„ï¼Œæ‰€ä»¥æ‰¾åˆ°äº†stack overflowçš„ä¸€ä¸ªé—®ç­”<a href="https://stackoverflow.com/questions/1439950/whats-the-opposite-of-make-install-i-e-how-do-you-uninstall-a-library-in-li">What's the opposite of 'make install', i.e. how do you uninstall a library in Linux?</a>ï¼Œç»™å‡ºäº†<strong>è¡¥æ•‘æ–¹æ¡ˆ</strong>å’Œ<strong>é¢„é˜²æ–¹æ¡ˆ</strong>æ¥å¸è½½ä½œè€…æ²¡æœ‰ç»™å‡ºmake uninstallé€‰é¡¹çš„æºä»£ç ã€‚</p>
<p>æˆ‘é€‰æ‹©æ”¾å¼ƒ~~<strong>è¡¥æ•‘æ–¹æ¡ˆ</strong>ï¼Œ<code>make -n install</code>ï¼Œæ‰“å°å‡ºinstallæ‰§è¡Œçš„æ­¥éª¤ï¼Œç„¶åæ‰‹å·¥åˆ æ‰å®‰è£…çš„æ–‡ä»¶å³å¯ã€‚å°è¯•è¿™ä¸ªæ–¹æ³•å‘ç°æ˜¾ç¤ºå‡ºæ¥çš„ä¸å…¨å•Šï¼ŒMakefileé‡Œinstallçš„è¯­å¥ä¸€å¤§å †ï¼Œè¿™ä¸ªæ–¹æ³•æš‚æ—¶æ”¾å¼ƒäº†ï¼Œä»¥åæ³¨æ„é¢„é˜²è¿™ä¸ªmake installé—®é¢˜å¥½äº†ã€‚~~ä¸‹é¢æœ‰äººè¯„è®ºè¯´ï¼Œè¿™æ ·å¤ªç¹çï¼Œè¿™æ­£æ˜¯<span style="font-size:1.5em;font-weight:bold;">åŒ…ç®¡ç†å™¨</span>è¢«å‘æ˜å‡ºæ¥çš„åŸå› ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªè‰¯å¥½çš„<strong>é¢„é˜²æ–¹æ¡ˆ</strong>ï¼Œ<span style="font-size:1.5em;font-weight:bold;">checkinstall</span>ï¼Œ</p>
<pre><code class="language-shell">sudo apt install checkinstall
# æ¯æ¬¡å°±ä¸è¦ç”¨make installäº†ï¼Œè€Œæ˜¯sudo checkinstall
# è¿™ä¸ªå›ç­”è¿˜æåˆ°äº†å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥åˆ é™¤ç”¨make installå®‰è£…çš„åŒ…ï¼Œé‚£å°±ä¸ç®¡å’¯ï¼Œæ„Ÿè§‰æˆ‘ä»¥åçš„å®‰è£…åº”è¯¥æ˜¯ä¼šè¦†ç›–çš„ä¹‹å‰çš„ï¼Œä¹‹åå°±ç”¨åŒ…ç®¡ç†å™¨å§ï¼
</code></pre>
<p>ä¸‹é¢çš„è¯„è®ºæœ‰æåˆ°ï¼Œæœ€é«˜ç¥¨çš„ç­”æ¡ˆä¸ä¸€å®šæ˜¯æœ€å¥½çš„ç­”æ¡ˆå•Šï¼æˆ‘è¡¨ç¤ºååˆ†èµåŒï¼</p>
<h2 id="æ›´æ–°qemu"><a class="header" href="#æ›´æ–°qemu">æ›´æ–°QEMU</a></h2>
<p><strong>æˆ‘ä½¿ç”¨çš„æ˜¯4.1.0ç‰ˆæœ¬</strong>ã€‚æ˜¯ç›´æ¥å‚è€ƒ<a href="logs.html">logs.md</a>å³å¯ï¼Œä¸éœ€è¦å»ºbuildç›®å½•åœ¨æ ¹ç›®å½•ä¸‹æå³å¯ï¼Œä¸èµ˜è¿°ã€‚ï¼ˆä¸­é—´é‡åˆ°äº†SRC_PATHå’ŒBUILD_DIR not foundçš„é—®é¢˜ï¼Œæˆ‘ç›´æ¥æ— è§†äº†ï¼Œå¥½åƒè¡Œçš„é€šï¼Ÿï¼‰ä¹‹å‰å­˜åœ¨çš„clioné‡Œ<code>i386/cpu_loop.c</code>é‡Œæœ‰æœªèƒ½æ‰¾åˆ°å®šä¹‰è€Œæç¤ºé”™è¯¯çš„å‡½æ•°è¿˜æ˜¯ä¸€æ ·ã€‚áƒš(â•¹â—¡â•¹áƒš)</p>
<h1 id="ä»£ç æ¡†æ¶"><a class="header" href="#ä»£ç æ¡†æ¶">ä»£ç æ¡†æ¶</a></h1>
<div style="font-size:3em; text-align:right;">2019.11.13</div>
## `cpu_loop`
<p>åšå®Œäº†<code>cpu_loop</code>çš„ä»£ç æ¡†æ¶å›¾ï¼Œå›å»å¯¹ç…§<a href="logs.html">logs.md</a>é‡Œçš„ç»“æ„å›¾ï¼ˆè´´åœ¨ä¸‹é¢äº†ï¼‰ï¼Œæˆ‘æ‰å‘ç°ä¹‹å‰çš„è‡ªå·±å·²ç»æŠŠlinux-userçš„å¤§ä½“æ¡†æ¶ææ¸…æ¥šäº†çš„ã€‚</p>
<p><img src="pictures/QEMU-user.svg" alt="QEMU-user" /></p>
<p><code>cpu_loop</code>ï¼ˆi386ï¼‰çš„ä»£ç æ¡†æ¶å›¾<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span>ï¼Œ</p>
<p><img src="pictures/linux-user-cpu_loop.svg" alt="linux-user-cpu_loop" /></p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘è¦åšçš„äº‹å¾ˆæ¸…æ¥šäº†ï¼Œ<strong>å¼„æ¸…ç»†èŠ‚</strong>ï¼Œå°¤å…¶æ˜¯QEMUå“ªäº›éƒ¨åˆ†æ˜¯æ¶æ„ç›¸å…³çš„ï¼Œå“ªäº›éƒ¨åˆ†æ˜¯æ¶æ„æ— å…³çš„ï¼Œè¿™å¯¹ç†è§£å¤„ç†å™¨è®¾è®¡çš„å…±æ€§å¾ˆæœ‰å¸®åŠ©ï¼</p>
<div style="font-size:3em; text-align:right;">2019.11.18</div>
# ç³»ç»Ÿè°ƒç”¨
<h2 id="do_syscall"><a class="header" href="#do_syscall"><code>do_syscall</code></a></h2>
<p>ç”±<a href="#%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6">ä»£ç æ¡†æ¶</a>å¯çŸ¥å‡½æ•°<code>abi_long do_syscall</code>æ¥å¤„ç†ç³»ç»Ÿè°ƒç”¨ã€‚QEMUå°†è¿™ä¸ªå‡½æ•°æ”¾ç½®åœ¨<code>linux-user/syscall.c</code>ä¸­å¯è§QEMUå¸Œæœ›å¯¹ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ˜¯<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>çš„ï¼Œ<code>do_syscall</code>æ¡†æ¶å›¾å¦‚ä¸‹ï¼Œ</p>
<p><img src="pictures/syscall.svg" alt="syscall" /></p>
<p>æ‰€ä»¥æ¥ä¸‹æ¥éœ€è¦ææ¸…æ¥šçš„é—®é¢˜å¾ˆæ˜æ˜¾äº†ï¼Œéœ€è¦çŸ¥é“è¿™äº›switch caseé‡Œæ˜¯å¦‚ä½•å¤„ç†ç³»ç»Ÿè°ƒç”¨çš„ï¼Œæœ‰ä¸¤ç§å¯èƒ½ï¼Œ</p>
<ol>
<li>ç¿»è¯‘æˆTCGæ‰§è¡Œï¼ˆè¿™æ ·çš„è¯ï¼Œè¦å˜æˆx86tomipsçš„æ¡†æ¶å°±æœ‰ç‚¹éº»çƒ¦äº†ï¼‰ï¼›</li>
<li>QEMUè§£é‡Šæ‰§è¡Œï¼ˆè¿™æ ·çš„è¯ï¼Œç›´æ¥æŠŠdo_syscallçš„æ¥å£å¯¹é½x86tomipsé‡Œçš„translate_intçš„æ¥å£å°±å¥½äº†ï¼‰ã€‚</li>
</ol>
<h2 id="å¦‚ä½•ä¿®æ”¹x86-qemu-mipsçš„ç³»ç»Ÿè°ƒç”¨çš„æ€è€ƒ"><a class="header" href="#å¦‚ä½•ä¿®æ”¹x86-qemu-mipsçš„ç³»ç»Ÿè°ƒç”¨çš„æ€è€ƒ">å¦‚ä½•ä¿®æ”¹x86-qemu-mipsçš„ç³»ç»Ÿè°ƒç”¨çš„æ€è€ƒ</a></h2>
<p><strong>å¤ªé•¿ä¸çœ‹</strong>ï¼šæˆ‘å†³å®šé€‰ç”¨QEMUå¯¹ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•ï¼ˆ<code>cpu_exec</code>é‡åˆ°ä¸­æ–­åˆ™è¿”å›å¤„ç†ä¸­æ–­ï¼‰ï¼Œæ”¾å¼ƒX86toMipså¯¹ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•ï¼ˆ<code>translate_int</code>ï¼‰ã€‚</p>
<p>ç›®å‰ç‰ˆæœ¬çš„x86-qemu-mipsï¼ˆgit SHA1 ID: fff3667068ff762899fbe6f63723c56d456b0c44ï¼‰æ—¢æœ‰QEMUçš„é‚£ä¸€å¥—å¤„ç†ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•ï¼Œä¹Ÿæœ‰X86toMipsé‚£ä¸€å¥—ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•ã€‚è¿™ä¸¤å¥—å¤„ç†æ–¹æ³•å¦‚ä¸‹ï¼ˆç›®å‰ç‰ˆæœ¬å®é™…ä½¿ç”¨çš„X86toMipsçš„ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†ä»£ç ï¼ŒQEMUçš„ç³»ç»Ÿè°ƒç”¨å¤„ç†ä»£ç æ˜¯â€œæ­»ä»£ç â€ï¼‰ï¼Œ</p>
<ul>
<li>
<p><strong>X86toMipså¤„ç†ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•</strong></p>
<p><strong>å¤ªé•¿ä¸çœ‹</strong>ï¼šX86toMipsæ˜¯å°†â€œè§£é‡Šæ‰§è¡ŒåµŒåœ¨äº†åŠ¨æ€ç¿»è¯‘é‡Œâ€ã€‚</p>
<p>åŠ¨æ€ç¿»è¯‘æ—¶ï¼ˆ<code>-t</code>é€‰é¡¹ï¼‰X86toMipsæ˜¯é€šè¿‡<code>translate_int</code>å‡½æ•°æ¥å¤„ç†ç³»ç»Ÿè°ƒç”¨ï¼Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ul>
<li>å…ˆåœ¨TBé‡Œæ’å…¥ä¿å­˜ä¸Šä¸‹æ–‡çš„è¯­å¥ï¼ˆä¿å­˜å¯„å­˜å™¨å’Œè¿”å›åœ°å€ï¼‰ï¼›</li>
<li>ç„¶ååœ¨TBé‡Œæ’å…¥ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œè¿™æ¡è·³è½¬æŒ‡ä»¤ä¼šè·³åˆ°X86toMipsæä¾›çš„å‡½æ•°<code>interpret_int</code>é‡Œï¼Œä½äº<code>syscall/sc_syscall.cpp: 806~813</code>ï¼Œå®Œæˆè§£é‡Šæ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„å·¥ä½œï¼›</li>
<li>æœ€ååœ¨TBé‡Œæ’å…¥è¿˜åŸä¸Šä¸‹æ–‡çš„è¯­å¥ã€‚</li>
</ul>
<p>éœ€è¦å›é¡¾X86toMipså¯¹ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†ä»£ç çš„åˆ†æï¼Œéœ€è¦åŒºåˆ†<strong>é™æ€ç¿»è¯‘</strong>ï¼Œ<strong>åŠ¨æ€ç¿»è¯‘</strong>ï¼Œ<strong>è§£é‡Šæ‰§è¡Œ</strong>å¯ä»¥å‚è€ƒ<a href="../X86toMips/X86toMips%E8%B0%83%E7%A0%94.html">X86toMipsè°ƒç ”.md</a>ä¸­çš„â€œX86toMipså¯¹ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†â€ã€‚</p>
</li>
<li>
<p><strong>QEMUå¤„ç†ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•</strong></p>
<p><strong>å¤ªé•¿ä¸çœ‹</strong>ï¼šçº¯ç²¹çš„è§£é‡Šæ‰§è¡Œã€‚</p>
<p>ä¸Šä¸Šé¢çš„<code>cpu_loop</code>çš„æ¡†æ¶å›¾å¯ä»¥çœ‹å‡ºå½“<code>cpu_exec</code>æ‰§è¡ŒTBæ—¶é‡åˆ°äº†ä¸­æ–­æŒ‡ä»¤çš„è¯å°±ä¼šè¿”å›ä¸­æ–­å·ï¼Œç„¶ååç»­ä»£ç æ¥å¤„ç†ä¸­æ–­ï¼Œè‹¥ä¸­æ–­å·æ˜¯<code>0x80</code>åˆ™ä¼šè°ƒç”¨<code>do_syscall</code>ã€‚ä¸Šé¢çš„<code>do_syscall</code>çš„ä»£ç æ¡†æ¶å›¾é‡Œå·¨å¤§çš„switch caseå°±æ˜¯QEMUè§£é‡Šæ‰§è¡Œç³»ç»Ÿçš„åœ°æ–¹ã€‚ç›®å‰ä¹‹ç ”ç©¶äº†writeçš„caseï¼Œçœ‹æ¥æ˜¯çº¯çš„è§£é‡Šæ‰§è¡Œã€‚æ‰€ä»¥å¯ä»¥å¤§èƒ†çš„çŒœæƒ³QEMUçš„å¯¹ç³»ç»Ÿè°ƒç”¨æ˜¯çº¯ç²¹çš„è§£é‡Šæ‰§è¡Œï¼Œå³å®Œå…¨ä¸ä¼šæ¶‰åŠTCGä¹Ÿä¸ä¼šæ¶‰åŠTBã€‚è¿™ä¸ªçŒœæƒ³å¯ä»¥ç”±å®éªŒæ¥éªŒè¯æˆ–è€…æ‰“ç ´ã€‚</p>
</li>
</ul>
<p>æˆ‘è‡ªå·±æ›´å€¾å‘äºé‡‡ç”¨QEMUå¤„ç†ç³»ç»Ÿè°ƒç”¨çš„æ–¹æ³•ã€‚å› ä¸ºæ¯•ç«ŸQEMUæ˜¯ä¸€ä¸ªæ¯”X86toMipsæ‹“å±•æ€§æ›´å¼ºçš„ç¿»è¯‘æ¡†æ¶ï¼Œæ‰€ä»¥æˆ‘æ‹…å¿ƒQEMUä¼šåˆ‡æ¢ç¨‹åºå†…å­˜ç©ºé—´æˆ–è€…ç¿»è¯‘ç¨‹åºå’Œæ‰§è¡ŒTBçš„ç¨‹åºæ˜¯ä¿©ä¸åŒçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆX86toMipsçš„å¤„ç†æ–¹å¼å°±ä¼šå‡ºç°æ ¹æœ¬ä¸åœ¨åŒä¸€åœ°å€ç©ºé—´æ— æ³•å¯»å€æ— æ³•è·³è½¬çš„é—®é¢˜äº†ã€‚</p>
<p>ä¸”ï¼Œæˆ‘ä»¬ç°åœ¨è¦åšçš„æ˜¯åŠ¨æ€ç¿»è¯‘ï¼Œè¿˜ä¸éœ€è¦è€ƒè™‘é™æ€ç¿»è¯‘ï¼Œæ‰€ä»¥è¦å¦‚ä½•æŠŠè§£é‡Šæ‰§è¡Œçš„ä»£ç åˆç†åœ°â€œæ‰“åŒ…â€è¿›TBç°åœ¨è¿˜ä¸ç”¨è€ƒè™‘ã€‚</p>
<div style="font-size:3em; text-align:right;">2019.11.19</div>
## ç ”è¯»QEMUçš„ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•
<p>ç›®å‰çœ‹æ¥æ˜¯è¦ææ¸…æ¥š<code>cpu_loop.c: 94 trapnr = cpu_exec(cs)</code>è¿™ä¸ªå‡½æ•°ã€‚</p>
<h3 id="cpu_exec"><a class="header" href="#cpu_exec"><code>cpu_exec</code></a></h3>
<p><code>cpu_exec</code>è¿™ä¸ªå‡½æ•°çš„ä»£ç æ¡†æ¶å›¾å¦‚ä¸‹ï¼Œ<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span></p>
<p><img src="pictures/linux-user-cpu-exec-formatted.svg" alt="linux-user-cpu-exec" /></p>
<p>âœ”ï¸ğŸ¤”<span style="color:red;">cflagsçš„å«ä¹‰ï¼Ÿ</span><strong>ç­”</strong>ï¼šé€šè¿‡grep<code>CF_INVALID</code>æ‰¾åˆ°äº†cflagsçš„å®šä¹‰å’Œå…¶ç›¸å…³å®æ•°å€¼å®šä¹‰åœ¨<code>include/exec/exec-all.h: 350~361</code>ï¼Œ<code>cflags</code>æ˜¯compiler flagsçš„ç®€å†™ï¼Œæ˜¯<code>TranslationBlock</code>ç»“æ„çš„æˆå‘˜å˜é‡ã€‚æœ‰ç©ºæ—¶å¯ä»¥æŠŠ<code>TranslationBlock</code>ç»“æ„ç ”ç©¶ç ”ç©¶ã€‚</p>
<div style="font-size:3em; text-align:right;">2019.11.20</div>
åœ¨æˆ‘çš„x86ç”µè„‘ä¸Šæµ‹è¯•äº†ä¸€ä¸‹QEMUçš„è¿™ä¸€æ®µä»£ç ï¼Œç”¨GDBå‘ç°äº†ä¸é¢„æœŸçš„ä¸å¤ªä¸€æ ·çš„æ§åˆ¶æµå˜åŒ–ã€‚æœ¬æ¥æœŸå¾…QEMUé‡åˆ°ç³»ç»Ÿè°ƒç”¨ï¼ˆç‰¹æ®Šçš„interruptï¼‰æ—¶cpu_tb_execè¿”å›çš„é¢å¤–ä¿¡æ¯æ˜¯TB_EXIT_REQUESTEDï¼Œç„¶åå›åˆ°ç¬¬ä¸€å±‚å¾ªç¯æ‰§è¡Œ`cpu_handle_excption`å‡½æ•°ã€‚**ç„¶è€Œ**äº‹å®æ˜¯`cpu_tb_exec`è¿˜æ²¡æ­£å¸¸é€€å‡ºï¼Œæ§åˆ¶æµå°±å¦‚ä¸Šå›¾<span style="font-size:1.5em;font-weight:bold;color:red;">çº¢çº¿</span>æ‰€ç¤ºï¼Œ**å‡ºä¹æ„æ–™åœ°è·³**åˆ°è¢«æˆ‘å¿½ç•¥çš„ä»£ç é‡Œå»äº†ï¼Œå¦‚ä¸‹ï¼Œ
<pre><code class="language-c">if (sigsetjmp(cpu-&gt;jmp_env, 0) != 0) {
</code></pre>
<p><span style="font-weight:bold; color:red;">âœ”ï¸ğŸ¤”çŒœæƒ³æ˜¯QEMUåœ¨ç¿»è¯‘TBæ—¶é‡åˆ°ä¸­æ–­æŒ‡ä»¤å°±ä¼šåœ¨ç¿»è¯‘çš„æŒ‡ä»¤é‡Œâ€œåŸ‹â€å…¥ä¸€æ¡setjmpçš„æŒ‡ä»¤ã€‚æ¥ä¸‹æ¥å°±æƒ³åŠæ³•ææ¸…æ¥šè¿™ä¸ªæ„æƒ³ä¸åˆ°çš„æ§åˆ¶æµè·³è½¬å§ï¼</span><strong>ç­”</strong>ï¼šæ˜¯é—´æ¥åœ°â€œåŸ‹å…¥â€äº†<code>longjmp</code>å‡½æ•°ã€‚å°†ç³»ç»Ÿè°ƒç”¨ç¿»è¯‘æˆTCGæ—¶QEMUåŸ‹å…¥<code>helper_raise_exception</code>å‡½æ•°ï¼Œè¿™ä¸ªä¼šè°ƒç”¨<code>longjmp</code>å‡½æ•°ï¼Œè·³è½¬åˆ°<code>qemu/accel/tcg/cpu-exec.c: 689</code>ï¼Œå³æ‰€è°“çš„â€œå‡ºä¹æ„æ–™â€çš„è·³è½¬ã€‚</p>
<div style="font-size:3em; text-align:right;">2019.11.22</div>
çŒœæµ‹`tb_find`è‹¥å‘ç°tbæ²¡æœ‰ç¿»è¯‘ï¼Œåˆ™ä¼šè¿›è¡Œç¿»è¯‘ï¼Œæ‰€ä»¥åœ¨æ­¤å»è¯¦ç»†çœ‹çœ‹`tb_find`å‡½æ•°ï¼Œ
<h3 id="tb_find"><a class="header" href="#tb_find"><code>tb_find</code></a></h3>
<p><span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span><img src="pictures/linux-user-tb_find.svg" alt="linux-user-tb_find" /></p>
<p>ä¸Šé¢çš„ä»£ç åæ˜ å‡ºä¸¤ä¸ª<strong>TBçš„ç‰¹æ€§</strong>ï¼š</p>
<h4 id="tbçš„ä¸¤ä¸ªç‰¹æ€§jmp-tbæŸ¥æ‰¾è¡¨tb-chain"><a class="header" href="#tbçš„ä¸¤ä¸ªç‰¹æ€§jmp-tbæŸ¥æ‰¾è¡¨tb-chain">TBçš„ä¸¤ä¸ªç‰¹æ€§ï¼šjmp-TBæŸ¥æ‰¾è¡¨ï¼ŒTB chain</a></h4>
<ol>
<li>
<p>å­˜åœ¨<strong>jmpåœ°å€-TBåœ°å€æŸ¥æ‰¾è¡¨</strong>ï¼Œå­˜åœ¨<code>CPUState</code>çš„<code>tb_jmp_cache</code>é‡Œï¼›</p>
</li>
<li>
<p><strong>TBä¹‹é—´çš„è¿æ¥å…³ç³»</strong>ï¼ˆTB chainï¼‰ç”±<code>TranslationBlock</code>çš„<code>jmp_list_head</code>ã€<code>jmp_list_next</code>å’Œ<code>jmp_dest</code>å®ç°ï¼Œè§<code>include/exec/exec-all.hï¼š386~402</code>æ³¨é‡Šï¼Œä¸‹é¢ä¸ºç²¾ç‚¼çš„æ³¨é‡Šä¼ è¾¾çš„ä¿¡æ¯ï¼Œ</p>
<ol>
<li>
<pre><code class="language-c">uintptr_t jmp_list_head; // incoming jumps
</code></pre>
</li>
<li>
<pre><code class="language-c">uintptr_t jmp_list_next[2]; // two sibling TB lists // é€šè¿‡çœ‹accel/tcg/cpu-exec.c: 381 è¡Œtb_add_jumpçš„è¯­å¥tb-&gt;jmp_list_next[n] = tb_next-&gt;jmp_list_head;å¯ä»¥çŸ¥é“jmp_list_nexté‡Œå­˜çš„æ˜¯**åç»§TBçš„jmp_list_head**ï¼Œå› ä¸ºæœ€å¤šå¯èƒ½æœ‰2ä¸ªåç»§TBï¼Œæ‰€ä»¥è¿™é‡Œè¿™ä¸ªé“¾è¡¨æ•°ç»„å¤§å°ä¸º2.
</code></pre>
</li>
<li>
<pre><code class="language-c">uintptr_t jmp_dest[2]; // destination TB of each outgoing jump, tagged pointers, The LSB is set when the TB is being invalidated // å› ä¸ºåœ°å€æ˜¯4å­—èŠ‚å¯¹é½ï¼Œæ‰€ä»¥æœ€ä½ä¸¤ä½å¯ä»¥ä¿å­˜é¢å¤–ä¿¡æ¯ï¼Œè‹¥æœ€ä½ä½ï¼ˆLSBï¼‰ä¸º1åˆ™è¡¨ç¤ºTBæ— æ•ˆã€‚
</code></pre>
</li>
</ol>
</li>
</ol>
<p><strong>æ³¨</strong>ï¼šåœ¨bingé‡Œæœç´¢qemu translation blockç›¸å…³èµ„æ–™æ—¶å‘ç°äº†2009å¹´çš„<a href="https://lugatgt.org/content/qemu_internals/downloads/slides.pdf">QEMU internals</a>ï¼ˆçœ‹äº†ä¸€ä¸‹QEMUçš„gitä»“åº“2009å¹´å¤§æ¦‚æ˜¯0.11æˆ–0.10ç‰ˆæœ¬çš„QEMUï¼‰è®²è¿°äº†QEMUçš„æ€»ä½“è®¾è®¡æ¡†æ¶ï¼Œå…¶ä¸­æœ‰è®²åˆ°Basic block chainingï¼Œè™½ç„¶ç‰ˆæœ¬ä¹…è¿œä½†æœ‰å¯ä»¥å¸®åŠ©ç†è§£ç°åœ¨ç‰ˆæœ¬çš„QEMUï¼Œå°†ä¸€å¼ QEMUæ‰§è¡ŒTBæ¡†æ¶å›¾æ”¾åœ¨ä¸‹é¢ï¼Œ</p>
<p><img src="pictures/QEMU_internals_exec_TB.svg" alt="QEMU_internals_exec_TB" /></p>
<h4 id="tbçš„ä¸¤ä¸ªç‰¹æ€§ç»“æŸ"><a class="header" href="#tbçš„ä¸¤ä¸ªç‰¹æ€§ç»“æŸ">TBçš„ä¸¤ä¸ªç‰¹æ€§[ç»“æŸ]</a></h4>
<p>å›åˆ°ä¸»é¢˜ä¸Šæ¥ï¼Œç”±<code>tb_find</code>çš„ä»£ç æ¡†æ¶å›¾å¯çŸ¥ç¡®å®æ˜¯<code>tb_find</code>è‹¥å‘ç°tbæ²¡æœ‰ç¿»è¯‘ï¼Œåˆ™ä¼šè¿›è¡Œç¿»è¯‘ï¼Œè¿™æ˜¯é€šè¿‡<code>tb_gen_code</code>å‡½æ•°å®Œæˆçš„ï¼Œæ¥ä¸‹æ¥ä»”ç»†çœ‹çœ‹è¿™ä¸ª<code>tb_gen_code</code>å‡½æ•°ï¼Œ</p>
<h3 id="tb_gen_code"><a class="header" href="#tb_gen_code"><code>tb_gen_code</code></a></h3>
<p>æ€»ä½“çœ‹æ¥<code>tb_gen_code</code>çš„æ¡†æ¶æ˜¯<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>çš„ï¼Œä½†æ˜¯å®é™…ä»è¿™é‡Œå¼€å§‹è°ƒç”¨<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span>çš„å‡½æ•°äº†ï¼Œ</p>
<p><img src="pictures/linux-user-tb_gen_code.svg" alt="linux-user-tb_gen_code" /></p>
<p>è¿™é‡Œçœ‹çš„å‡ºæ¥è¿›è¡Œäº†tbçš„åˆ†é…ï¼Œä»guestä»£ç ç”Ÿäº§ä¸­é—´è¡¨ç¤ºï¼ˆTCGï¼‰ï¼Œç„¶åç”±ä¸­é—´è¡¨ç¤ºç”Ÿäº§hostä»£ç ã€‚å› æ­¤æƒ³è¦äº†è§£QEMUæ˜¯å¦‚ä½•å°†setjmpæŒ‡ä»¤åŸ‹å…¥ç¿»è¯‘å¥½çš„æŒ‡ä»¤ï¼Œéœ€è¦å»è¯¦ç»†äº†è§£<code>gen_intermediate_code</code>é‡Œæ˜¯å¦‚ä½•å¤„ç†x86çš„ç³»ç»Ÿè°ƒç”¨çš„ï¼Œç„¶å<code>tcg_gen_code</code>åˆæ˜¯å¦‚ä½•é…åˆTCGå¤„ç†ç³»ç»Ÿè°ƒç”¨çš„ã€‚<strong>æ³¨</strong>ï¼šx86-qemu-mipsæ”¹äº†çš„è¿™é‡Œã€‚</p>
<div style="font-size:3em; text-align:right;">2019.11.25</div>
#### guest=>TCG: `translate_insn`=`i386_tr_translate_insn`
<p>ä¸Šå›¾ä¸­çš„<code>translator_loop</code>å¾ˆæ˜æ˜¾åœ°çœ‹å‡ºæ¯æ¬¡å¾ªç¯åæ±‡ç¼–ä¸€æ¡x86æŒ‡ä»¤ã€‚â€œåæ±‡ç¼–ä¸€æ¡x86æŒ‡ä»¤â€è¿™ä¸ªåŠ¨ä½œç”±<code>translate_insn</code>å‡½æ•°å®Œæˆï¼Œè¿™ä¸ªå‡½æ•°æ˜¯<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>ï¼Œä½†å…¶æŒ‡å‘çš„å‡½æ•°<code>i386_tr_translate_insn</code>æ˜¯<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span>ï¼Œå…¶ä»£ç æ¡†æ¶å¦‚ä¸‹ï¼Œ</p>
<p><img src="pictures/translate_insn-formatted.svg" alt="translate_insn-formatted" /></p>
<p>æ„Ÿè§‰QEMUæ˜¯åƒäº†Cè¯­è¨€æ²¡æœ‰â€œç±»â€çš„äºï¼Œ<code>DisasContext</code>æ˜¯<code>DisasContextBase</code>çš„å­ç±»ï¼Œ<code>DisasContextBase</code>æ˜¯<code>DisasContext</code>çš„åŸºç±»ã€‚</p>
<p>æ¥ä¸‹æ¥è¯¦ç»†çœ‹çœ‹<code>gen_exception</code>å’Œ<code>gen_interrupt</code>å‡½æ•°ã€‚</p>
<h5 id="gen_exceptionå’Œgen_interrupt"><a class="header" href="#gen_exceptionå’Œgen_interrupt"><code>gen_exception</code>å’Œ<code>gen_interrupt</code></a></h5>
<p>åœ¨çœ‹çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†<code>gen_update_cc_op</code>å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘å»ç®€è¦è°ƒç ”äº†ä¸€ä¸‹QEMUä¸­å¯¹eflagsçš„å¤„ç†ã€‚</p>
<h6 id="qemuå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”"><a class="header" href="#qemuå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”">QEMUå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”</a></h6>
<p>eflagsæ˜¯x86çš„æ¦‚å¿µï¼ŒQEMUçš„TCGæŠ½è±¡å‡ºæ¥çš„ç¬¦å·ä½çš„é€šç”¨æ¦‚å¿µè¢«æˆä¸ºconditional codesï¼ˆç®€ç§°ccï¼‰ã€‚</p>
<p>æŒ‰ç…§<code>target/i386/cpu.h: 806~812</code>å¯¹<code>CCop</code>çš„æ³¨é‡Šï¼ŒQEMUåªä¼šä¿å­˜<code>cc_op</code>ï¼Œç„¶ååœ¨éœ€è¦ccæ—¶æ ¹æ®<code>cc_op</code>å’Œ<code>cc_op</code>ä½œç”¨çš„<code>cc_src</code>æ¥ç®—å‡ºéœ€è¦çš„ccã€‚</p>
<p><strong>ä¿å­˜<code>cc_op</code>çš„åœºæ™¯</strong></p>
<p>QEMUåœ¨åæ±‡ç¼–i386æŒ‡ä»¤ç”ŸæˆTCGæ—¶ï¼Œå¯¹äºä¼šæ“ä½œeflagsçš„æŒ‡ä»¤ï¼ˆæ¯”å¦‚ç®—æ•°é€»è¾‘æ“ä½œï¼Œå¤„ç†çš„ä»£ç ä½äº<code>target/i386/translate.c: 4666~4725</code>ï¼‰ç”¨<code>set_cc_op (line: 234)</code>æ¥ä¿å­˜<code>cc_op</code>åˆ°<code>DisasContext</code>ç»“æ„çš„<code>cc_op</code>é‡Œï¼Œå¹¶å°†<code>cc_op_dirty</code>ç½®trueè¡¨ç¤ºå†™å…¥äº†<code>cc_op</code>ã€‚</p>
<p>è¿™é‡Œè‡ªç„¶è€Œç„¶ä¼šäº§ç”Ÿä¸‹é¢çš„é—®é¢˜ï¼š</p>
<ol>
<li>
<p><code>DisasContext</code>é‡Œåªæœ‰ä¸€ä¸ª<code>cc_op</code>ï¼Œæ‰€ä»¥<code>set_cc_op</code>å‡½æ•°è‚¯å®šéœ€è¦è€ƒè™‘å¦‚ä½•æ¸…ç†è€çš„<code>cc_op</code>ï¼š</p>
<p>ç”±å¸¸é‡æ•°ç»„<code>cc_op_live</code>å®Œæˆï¼ˆ<code>target/i386/translate.c: 242~255</code>ï¼‰ã€‚<code>cc_op_live</code>è®°å½•çš„æ˜¯æ¯ä¸ª<code>cc_op</code>æ˜¯å¦éœ€è¦ç”¨åˆ°<code>cpu_cc_dst</code>, <code>cpu_cc_src</code>, <code>cpu_cc_src2</code>, <code>cc_srcT</code>ã€‚å°†ä¸å†éœ€è¦çš„å˜é‡æ¸…ç†æ‰å³å¯ã€‚</p>
</li>
<li>
<p>ğŸ¤”ä»ä¸Šé¢çš„é—®é¢˜è¡ç”Ÿè€Œæ¥ï¼Œåœ¨<code>set_cc_op</code>å‡½æ•°é‡Œå¹¶æ²¡æœ‰çœ‹åˆ°ç”¨<code>cc_op_live</code>æ¥è®¾ç½®æ–°çš„<code>cc_op</code>éœ€è¦çš„<code>cpu_cc_dst</code>, <code>cpu_cc_src</code>, <code>cpu_cc_src2</code>, <code>cc_srcT</code>ï¼Œé‚£ä¹ˆè¿™äº›è®¾ç½®ä»£ç åœ¨å“ªï¼Ÿ</p>
<p>çŒœæµ‹ï¼Œéœ€è¦çš„æ—¶å€™å†è®¾ç½®ã€‚</p>
</li>
</ol>
<p><strong>ä½¿ç”¨<code>cc_op</code>çš„åœºæ™¯</strong></p>
<p>å½“æŒ‡ä»¤éœ€è¦ç”¨åˆ°ccæ—¶ï¼ˆæ¯”å¦‚x86çš„cmovæŒ‡ä»¤ï¼‰ä¼šè°ƒç”¨<code>target/i386/translate.c: 2269~2296: gen_prepare_cc</code>æ¥è®¡ç®—ccï¼Œè¿™ä¸ªå‡½æ•°é‡Œå°±ä¼šç”¨åˆ°<code>cc_op</code>ã€‚æš‚æ—¶æ²¡æœ‰è¯¦ç»†å»çœ‹è¿™ä¸ªå‡½æ•°ã€‚</p>
<h6 id="qemuå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”ç»“æŸ"><a class="header" href="#qemuå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”ç»“æŸ">QEMUå¯¹eflagsçš„å¤„ç†ç®€è¦è°ƒç ”[ç»“æŸ]</a></h6>
<p>æ¥ä¸‹æ¥æ¥ç€çœ‹<code>gen_exception</code>å’Œ<code>gen_interrupt</code>å‡½æ•°ï¼Œ</p>
<p><strong>æ³¨</strong>ï¼š<code>gen_exception</code>å’Œ<code>gen_interrupt</code>ç±»ä¼¼ï¼Œå°±çœ‹<code>gen_exception</code>å¥½äº†ã€‚</p>
<p>å…¶ä¸­<code>gen_helper_raise_exception</code>æ˜¯ä¸ªé€šè¿‡å¤æ‚å®å®šä¹‰çš„å‡½æ•°ã€‚ğŸ¤”è¿™æœ‰å¿…è¦ç ”ç©¶ç ”ç©¶åµŒå¥—çš„å®å‡½æ•°çš„å±•å¼€é¡ºåºï¼</p>
<p><code>include/exec/helper-head.h: 65</code>æåˆ°äº†</p>
<blockquote>
<p>We can't use glue() here because it falls foul of C preprocessor recursive expansion rules.</p>
</blockquote>
<p>æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<p>å”¯ä¸€çš„ä¸€å¤„å®šä¹‰<code>dh_retvar_decl_void</code>åœ¨æ­¤ï¼Œä½†æ˜¯æ˜¯ç©ºçš„ã€‚æ²¡æœ‰å½±å“ï¼Œåªæ˜¯ä¸ºäº†å¥½çœ‹è€Œå·²ï¼Œä»”ç»†çœ‹<code>include/exec/helper-gen.h:24</code>è¡Œå°¾å±•å¼€<code>dh_retvar_decl_void</code>æ˜¯æ²¡æœ‰é€—å·çš„ã€‚</p>
<p><code>gen_helper_raise_exception</code>çš„å®å¤§ä½“æ¶‰åŠåˆ°çš„å®å‡½æ•°å¦‚ä¸‹ï¼Œ</p>
<p><img src="pictures/gen_exception-macro.svg" alt="gen_exception-macro" /></p>
<p><code>gen_helper_raise_exception</code>çš„å®å…¨éƒ¨å±•å¼€åå¦‚ä¸‹ï¼Œï¼ˆ<strong>æ³¨</strong>ï¼šå¯ä»¥å°è¯•ä¸€ä¸‹ç”¨<code>gcc -E</code>æ¥è‡ªåŠ¨å±•å¼€å®ï¼Œä¸è¿‡QEMUçš„includeå…³ç³»å¾ˆå¤šæ˜¯é Makefileå»ºç«‹çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨configureæ—¶åŠ å‚æ•°æ‰è¡Œï¼‰</p>
<pre><code class="language-c">static inline void gen_helper_raise_exception(TCGv_ptr arg1, TCGv_i32 arg2)
{
    TCGTemp *args[2] = {tcgv_ptr_temp(arg1), tcgv_i32_temp(arg2)};
    tcg_gen_callN(helper_raise_exception, ((void *)0), 2, args)
}
</code></pre>
<p>æœ€åå®Œæˆæ¢³ç†çš„<code>gen_exception</code>å¦‚ä¸‹ï¼Œ<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span><img src="pictures/gen_exception.svg" alt="gen_exception" /></p>
<p>ä»ä¸Šå›¾çœ‹å‡ºï¼Œ<code>tcg_gen_callN</code>æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å¤„ç†è¿‡ç¨‹ï¼Œå…¶ä¸­è¿˜è°ƒç”¨äº†å®è´¨çš„helperå‡½æ•°<code>raise_interrupt2</code>ï¼Œæ¥ä¸‹æ¥å°±çœ‹è¿™ä¿©å‡½æ•°ã€‚</p>
<div style="font-size:3em; text-align:right;">2019.11.26</div>
##### `tcg_gen_callN`
<p>åœ¨<code>tcg_gen_callN</code>å‡½æ•°é‡Œå‘ç°äº†æœ‰è¶£çš„åœ°æ–¹ï¼Œè¿™ä¸ªå‡½æ•°å¼€å¤´çš„æ³¨é‡Šå†™çš„æ˜¯å°†64ä½å‡½æ•°å‚æ•°è½¬åŒ–ä¸º32ä½å‡½æ•°å‚æ•°å¹¶å¤„ç†å¯¹å…¶å’Œå°¾ç«¯ï¼Œ<del>è¿™æ ·çœ‹æ¥è«éä¸­é—´è¯­è¨€TCGæ˜¯ä¸€ä¸ª32ä½çš„æŒ‡ä»¤é›†ï¼Ÿ</del></p>
<p>åœ¨çœ‹<code>TCGOp</code>çš„å®šä¹‰æ—¶<code>tcg/tcg.h: 616~634</code>å‚æ•°æœ€å¤§æ•°é‡çš„å®<code>MAX_OPC_PARAM</code>çš„æ³¨é‡Š<code>tcg/tcg.h: 48~50</code>ï¼Œ</p>
<blockquote>
<p>A Call op needs up to 4 + 2N parameters on 32-bit archs, and up to 4 + N parameters on 64-bit archs (N = number of input arguments + output arguments).</p>
</blockquote>
<p>è¿™æ ·çœ‹æ¥æ›´åº”è¯¥<strong>æŠŠTCGç†è§£æˆä¸€ä¸ª64ä½çš„æŒ‡ä»¤é›†</strong>æ‰æ›´åˆç†å§ï¼</p>
<p>ä¸”è¦æ³¨æ„çš„æ˜¯TCGçš„targetå’ŒQEMUçš„targetå¹¶ä¸æŒ‡å‘åŒä¸€æœºå™¨ï¼Œå‚è€ƒTCGçš„<a href="../../../../Codes/qemu/tcg/README">README</a>ç¬¬2éƒ¨åˆ†Definitionsï¼Œ</p>
<ul>
<li>
<p>TCGçš„targetæ˜¯æŒ‡ç”¨TCGç”Ÿæˆçš„æœºå™¨ç çš„å¹³å°ï¼Œ<strong>TCGæ˜¯åŸæœ¬Cè¯­è¨€ç¼–è¯‘çš„ä¸­é—´è¯­è¨€</strong>ï¼ŒQEMUé‡Œçš„TCGä¿ç•™äº†è¿™äº›æœ¯è¯­ï¼›</p>
<p>ä¸¾ä¸ªä¾‹å­<code>tcg/tcg.c: 1751</code>å‡ºç°çš„å®<code>TCG_TARGET_REG_BITS</code>å¯¹åº”çš„æ˜¯æˆ‘çš„ç¬”è®°æœ¬REG_BITSå³64ä½ã€‚</p>
</li>
<li>
<p>QEMUçš„targetæ˜¯è¢«æ¨¡æ‹Ÿçš„å¹³å°ï¼›</p>
</li>
</ul>
<p>æ‰€ä»¥<code>tcg_gen_callN</code>å‡½æ•°çš„å¼€å¤´çš„æ³¨é‡Šä¾¿èƒ½å¤Ÿç†è§£äº†ï¼Œæ¯”å¦‚<code>tcg/tcg.c: 1756~1757</code>ï¼Œ</p>
<pre><code class="language-c">            op-&gt;args[pi++] = temp_arg(ret);
            op-&gt;args[pi++] = temp_arg(ret + 1);
</code></pre>
<p>å½“TCGçš„ç›®æ ‡å¹³å°æ˜¯32ä½æ—¶åˆ™éœ€è¦æŠŠTCGå‚æ•°åˆ†æˆ2ä¸ª32ä½å‚æ•°å­˜è¿›TCGç›®æ ‡å¹³å°ï¼Œè¿™è‡ªç„¶è€Œç„¶å½¢æˆäº†è¿™æ ·çš„ä»£ç <code>ret</code>æ˜¯æŒ‡å‘64ä½å‚æ•°çš„ä½32ä½çš„æŒ‡é’ˆï¼Œ<code>ret+1</code>æ˜¯æŒ‡å‘64ä½å‚æ•°çš„é«˜32ä½çš„æŒ‡é’ˆã€‚</p>
<p>æ€»çš„æ¥è¯´<code>tcg_gen_callN</code>å‡½æ•°å®Œæˆäº†ä»¥ä¸‹åŠ¨ä½œï¼Œ<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>ï¼Œ</p>
<p><img src="pictures/tcg_gen_callN-formatted.svg" alt="tcg_gen_callN-formatted" /></p>
<h5 id="helper_raise_exceptionraise_interrupt2"><a class="header" href="#helper_raise_exceptionraise_interrupt2"><code>helper_raise_exception</code>ï¼ˆ<code>raise_interrupt2</code>ï¼‰</a></h5>
<p>ç›®å‰æƒ³è¦ææ¸…æ¥šçš„é—®é¢˜æ˜¯<code>cpu_exec</code>é‡Œé‚£ä¸ªâ€œå‡ºä¹æ„æ–™çš„è·³è½¬â€ã€‚ç›®å‰å·²ç»çœ‹åˆ°äº†å¦‚ä½•æŠŠè°ƒç”¨<code>helper_raise_exception</code>çš„TCGæŒ‡ä»¤æ”¾å…¥äº†<code>tcg_ctx_ops</code>é‡Œï¼Œä¸”<code>helper_raise_exception</code>å®é™…ä¸º<code>target/i386/excp_helper.c: 88~108:raise_interrupt2</code>å…¶è¿”å›ç±»å‹ä¸ºå®å®šä¹‰<code>QEMU_NORETURN</code>ï¼Œå¾ˆæœ‰å¯èƒ½é‚£ä¸ªâ€œå‡ºä¹æ„æ–™çš„è·³è½¬â€å°±æ˜¯<code>raise_interrupt2</code>çš„no returnçš„æ•ˆæœã€‚</p>
<p><span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span></p>
<p>exceptionå’Œinterruptéƒ½ä¼šè°ƒç”¨åˆ°<code>target/i386/excp_helper.c: 88~108: raise_interrupt2</code>å‡½æ•°å…¶ä¸­ç¬¬3ä¸ªå‚æ•°<code>int is_int</code>æ˜¯0åˆ™æ˜¯exceptionï¼Œ1åˆ™æ˜¯interruptã€‚å…¶ä¸»è¦æ“ä½œå¦‚ä¸‹ï¼Œ</p>
<p><img src="pictures/raise_interrupt2.svg" alt="raise_interrupt2" /></p>
<p>æœ€åè°ƒç”¨åˆ°äº†<code>siglongjmp</code>ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè·³åˆ°æœ€è¿‘ä¸€æ¬¡æ‰§è¡Œçš„<code>sigsetjmp</code>å¤„å»ï¼Œå³<code>qemu/accel/tcg/cpu-exec.c: 689</code>ã€‚<code>setjmp</code>å’Œ<code>longjmp</code>çš„è¯¦ç»†ç”¨æ³•å’ŒåŠŸèƒ½å¯ä»¥å‚è€ƒmanual pageï¼Œä¸‹é¢æ˜¯æŠ½è±¡å‡ºæ¥çš„å›¾ï¼Œ</p>
<p><img src="pictures/setjmp_longjmp.svg" alt="setjmp_longjmp" /></p>
<p>2020.8.21 vï¼šä»¥ä¸‹ç¬”è®°æ¥è‡ª<a href="../x86-qemu-mips/check.html">xqmçš„checkç¬”è®°</a>ï¼Œ</p>
<p>ä»¥<code>movl %ebx,(%eax) #8918</code>ä¸ºä¾‹ï¼Œ</p>
<h4 id="tcghost-tcg_gen_code"><a class="header" href="#tcghost-tcg_gen_code">TCG=&gt;host: <code>tcg_gen_code</code></a></h4>
<p><img src="../x86-qemu-mips/pictures/tcg_gen_code-x86-formatted.svg" alt="tcg_gen_code-x86-formatted" /></p>
<p>2020.8.21 ^</p>
<p>2021.06.08: qemu-master (5.2.92) å­˜/å–TCGæŒ‡ä»¤è¢«æ”¾åˆ°äº†<code>tcg_reg_alloc_op</code>=&gt;<code>tcg_out_op</code>ä¸­ä¸€èµ·å¤„ç†ï¼Œåè€…ä½äº<code>tcg/i386/tcg-target.c.inc</code>æ–‡ä»¶ã€‚<code>tcg_out_ldst_finalize</code>æ¥ç”Ÿæˆç³»ç»Ÿæ€çš„è®¿å­˜æ…¢è·¯å¾„ã€‚å‚è€ƒåšå£«è®ºæ–‡ã€ŠAcceleration of memory accesses in dynamic binary
translationã€‹ã€‚</p>
<h2 id="ç ”è¯»qemuçš„ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•ç»“æŸ"><a class="header" href="#ç ”è¯»qemuçš„ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•ç»“æŸ">ç ”è¯»QEMUçš„ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†æ–¹æ³•[ç»“æŸ]</a></h2>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯QEMUæ‰§è¡Œç¿»è¯‘å¥½çš„ä»£ç æ—¶é‡åˆ°äº†ç³»ç»Ÿè°ƒç”¨éœ€è¦è°ƒç”¨helperå‡½æ•°è·³å‡º<code>cpu_exec</code>ç„¶åå†æ¥å¤„ç†ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸æ˜¯å°±åœ¨é‡åˆ°ç³»ç»Ÿè°ƒç”¨çš„åœ°æ–¹è°ƒç”¨helperå‡½æ•°ç›´æ¥å¤„ç†ç³»ç»Ÿè°ƒç”¨ï¼ŸX86toMipsé‡‡ç”¨çš„æ–¹æ³•æ˜¯åè€…ã€‚</p>
<p>ç”¨æ±‡ç¼–helloåšå®éªŒå‘ç°intæŒ‡ä»¤ä¹Ÿæ˜¯QEMUçš„TBçš„æ ‡å¿—ï¼Œæ‰€ä»¥ç”¨helperå‡½æ•°è·³å‡º<code>cpu_exec</code>å’Œç”¨helperå‡½æ•°ç›´æ¥å¤„ç†ç³»ç»Ÿè°ƒç”¨ç„¶åTBç»“æŸå›æ„Ÿè§‰æ²¡å·®åˆ«å•Šï¼Ÿ</p>
<div style="font-size:3em; text-align:right;">2019.12.5</div>
ğŸ¤”QEMUé‡Œguestè½¬TCGæ—¶ç”¨åˆ°çš„TCGä¸´æ—¶å˜é‡å¦‚ä½•ç¿»è¯‘æˆnativeä»£ç çš„ï¼Ÿä¸´æ—¶å˜é‡æ•°ç»„åœ¨`tcg/tcg.h: 666 TCGContext`ç»“æ„é‡Œã€‚
<p>è¿™ä¸ªé—®é¢˜çœ‹TCGå¦‚ä½•ç¿»è¯‘æˆnativeçš„ä»£ç å°±å¥½äº†ï¼Œåœ¨<code>tb_gen_code</code>å‡½æ•°é‡Œè°ƒç”¨çš„<code>tcg_gen_code</code>å®Œæˆã€‚</p>
<h1 id="cpustatecpuarchstatecpux86stateä¹‹é—´çš„å…³ç³»"><a class="header" href="#cpustatecpuarchstatecpux86stateä¹‹é—´çš„å…³ç³»">âœ”ï¸ğŸ¤”<code>CPUState</code>ï¼Œ<code>CPUArchState</code>ï¼Œ<code>CPUX86State</code>ä¹‹é—´çš„å…³ç³»ï¼Ÿ</a></h1>
<p><strong>ç­”</strong>ï¼š</p>
<pre><code class="language-c">// target/i386/cpu.h: 1781~1782
typedef CPUX86State CPUArchState;
typedef X86CPU ArchCPU;
// åœ¨å…¶ä»–æ¶æ„é‡Œéƒ½æœ‰ç±»ä¼¼çš„å£°æ˜ï¼Œæ¯”å¦‚target/nios2/cpu.h: 240~241
typedef CPUNios2State CPUArchState;
typedef Nios2CPU ArchCPU;
</code></pre>
<p>å¯è§<code>CPUArchState</code>å’Œ<code>ArchState</code>æ˜¯<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>çš„ç±»å‹ï¼Œ<strong>ç­‰ä»·äº</strong>ï¼Œå…¶<span style="background:red; font-weight:bold; color:white">æ¶æ„ç›¸å…³</span>çš„<strong>åˆ«å</strong><code>CPUX86State</code>å’Œ<code>X86State</code>ã€‚</p>
<p><code>X86State</code>åƒæ˜¯å¤šç»§æ‰¿äº†<code>CPUState</code>å’Œ<code>CPUX86State</code>ï¼ŒUMLå›¾å¦‚ä¸‹ï¼Œ</p>
<p><img src="pictures/X86CPU-formatted.svg" alt="X86CPU-formatted" /></p>
<h1 id="qemu-i386æ“ä½œå¯„å­˜å™¨çš„æ–¹å¼-cpuarchstate"><a class="header" href="#qemu-i386æ“ä½œå¯„å­˜å™¨çš„æ–¹å¼-cpuarchstate">QEMU-i386æ“ä½œå¯„å­˜å™¨çš„æ–¹å¼-CPUArchState</a></h1>
<p>åœ¨<a href="../%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BF%BB%E8%AF%91%E8%B0%83%E7%A0%94%E6%8A%A5%E5%91%8A%EF%BC%88LLBT%E7%9B%B8%E5%85%B3%EF%BC%89.html">äºŒè¿›åˆ¶ç¿»è¯‘è°ƒç ”æŠ¥å‘Šï¼ˆLLBTç›¸å…³ï¼‰.md</a>é‡Œç”¨qemuæ‰“å°å‡ºäº†æ±‡ç¼–helloç¨‹åºçš„TCGï¼Œåœ¨æ­¤åšä¸ªæ‹“å±•ï¼Œä»¥ä¾¿éªŒè¯ä¸€äº›çŒœæƒ³ï¼ˆå…å»èŠ±è´¹é•¿æ—¶é—´å»çœ‹TCGï¼‰ã€‚âœ”ï¸<strong>çŒœæƒ³</strong>ï¼šQEMUæ²¡æœ‰æ˜ å°„x86å¯„å­˜å™¨ï¼Œè€Œæ˜¯æ¯æ¬¡å»å’ŒCPUX86Stateé‡Œçš„å¯„å­˜å™¨å˜é‡æ‰“äº¤é“ï¼Œ</p>
<pre><code class="language-shell">qemu-ARCH -d help # å¯ä»¥æ˜¾ç¤ºqemu-ARCHæ”¯æŒçš„è¾“å‡ºå†…å®¹
# ä¸‹é¢è¡¨æ ¼ç”¨åˆ°äº†çš„æ˜¯out_asmã€op
</code></pre>
<table><thead><tr><th style="text-align: left">æºä»£ç </th><th>æœªä¼˜åŒ–çš„QEMU IRï¼ˆopï¼‰</th><th>out_asm</th></tr></thead><tbody>
<tr><td style="text-align: left">.section .data<br/>	output:	.ascii  &quot;Hello World\n&quot;<br/>.section .text<br/>.globl _start<br/>_start:</td><td></td><td></td></tr>
<tr><td style="text-align: left"></td><td></td><td>PROLOGUEç•¥</td></tr>
<tr><td style="text-align: left"><strong>æ³¨</strong>ï¼šå³è¾¹çš„ä»£ç ç”¨äºç»Ÿè®¡ä¿¡æ¯è§<code>include/exec/gen-icount.h: gen_tb_start</code>ï¼ˆbyåˆ˜å…ˆå–†ï¼‰</td><td>ld_i32 tmp11,env,$0xfffffffffffffff0<br/>movi_i32 tmp12,$0x0<br/>brcond_i32 tmp11,tmp12,lt,$L0</td><td>mov    -0x14(%r14),%ebp<br/>test   %ebp,%ebp<br/>jl     0x562e2d6ce105</td></tr>
<tr><td style="text-align: left">movl	$4, %eax</td><td>movi_i32 tmp0,$0x4<br/>mov_i32 eax,tmp0</td><td>movl   $0x4,(%r14)</td></tr>
<tr><td style="text-align: left">movl	$1, %ebx</td><td>movi_i32 tmp0,$0x1<br/>mov_i32 ebx,tmp0gen_helper_</td><td>movl   $0x1,0xc(%r14)</td></tr>
<tr><td style="text-align: left">movl	$output, %ecx</td><td>movi_i32 tmp0,$0x8049096<br/>mov_i32 ecx,tmp0</td><td>movl   $0x8049096,0x4(%r14)</td></tr>
<tr><td style="text-align: left">movl	$12, %edx</td><td>movi_i32 tmp0,$0xc<br/>mov_i32 edx,tmp0</td><td>movl   $0xc,0x8(%r14)</td></tr>
<tr><td style="text-align: left">int	$0x80</td><td>movi_i32 tmp3,$0x8048088<br/>st_i32 tmp3,env,$0x20<br/>movi_i32 tmp11,$0x2<br/>movi_i32 tmp12,$0x80<br/>call raise_interrupt,$0x0,$0,env,tmp12,tmp11<br/>set_label $L0<br/>exit_tb $0x5597a136a043</td><td>movl   0x8048088,0x20(%r14)<br/>mov    %r14,%rdi<br/>mov 0x80,%esi<br/>mov 0x2,%edx<br/>callq 0x562e2d3a4870<br/>lea -0xc9(%rip),%rax<br/>jmpq   0x562e2d6ce018</td></tr>
<tr><td style="text-align: left"></td><td>ld_i32 tmp11,env,$0xfffffffffffffff0<br/>movi_i32 tmp12,$0x0<br/>brcond_i32 tmp11,tmp12,lt,$L0</td><td>mov    -0x14(%r14),%ebp<br/>test   %ebp,%ebp<br/>jl     0x562e2d6ce1f5</td></tr>
<tr><td style="text-align: left">movl	$1, %eax</td><td>movi_i32 tmp0,$0x1<br/>mov_i32 eax,tmp0</td><td>movl   $0x1,(%r14)</td></tr>
<tr><td style="text-align: left">movl	$0, %ebx</td><td>movi_i32 tmp0,$0x0<br/>mov_i32 ebx,tmp0</td><td>movl   $0x0,0xc(%r14)</td></tr>
<tr><td style="text-align: left">int	$0x80</td><td>movi_i32 tmp3,$0x8048094<br/>st_i32 tmp3,env,$0x20<br/>movi_i32 tmp11,$0x2<br/>movi_i32 tmp12,$0x80<br/>call raise_interrupt,$0x0,$0,env,tmp12,tmp11<br/>set_label $L0<br/>exit_tb $0x5597a136a183</td><td>movl   0x8048094,0x20(%r14)<br/>mov    %r14,%rdi<br/>mov    0x80,%esi<br/>mov    0x2,%edx<br/>callq  0x562e2d3a4870<br/>lea    -0xb9(%rip),%rax<br/>jmpq   0x562e2d6ce018</td></tr>
</tbody></table>
<p>è¿™é‡Œå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºï¼Œr14å¯„å­˜å™¨å­˜çš„æ˜¯æŒ‡å‘<code>CPUArchState env</code>çš„æŒ‡é’ˆï¼Œä¸”<code>target_ulong regs[CPU_NB_REG]</code>å˜é‡åˆšå¥½ä½äº<code>CPUX86State</code>å¼€å¤´ï¼Œä¸€ä¸ªå¯„å­˜å™¨32bitï¼Œå®Œç¾å¯¹é½ã€‚æ‰€ä»¥QEMUç¡®å®æ²¡æœ‰æ˜ å°„x86å¯„å­˜å™¨ï¼Œè€Œæ˜¯æ¯æ¬¡å»å’ŒCPUX86Stateé‡Œçš„å¯„å­˜å™¨å˜é‡æ‰“äº¤é“ã€‚ä¸Šé¢çš„çŒœæƒ³è¿™æ ·çœ‹æ¥æ˜¯æ­£ç¡®ã€‚</p>
<p><strong>æ‰€ä»¥ï¼ŒQEMUåœ¨åˆ‡æ¢ä¸Šä¸‹æ–‡æ—¶ä¸å†éœ€è¦åƒX86toMipså°†æ˜ å°„å¯„å­˜å™¨çš„å†…å®¹ä¿å­˜è¿›envå˜é‡é‡Œï¼</strong></p>
<h1 id="qemuå¤šè¿›ç¨‹å’Œç³»ç»Ÿè°ƒç”¨"><a class="header" href="#qemuå¤šè¿›ç¨‹å’Œç³»ç»Ÿè°ƒç”¨">QEMUå¤šè¿›ç¨‹å’Œç³»ç»Ÿè°ƒç”¨</a></h1>
<div style="font-size:3em; text-align:right;">2019.12.11</div>
## `do_fork`
<p>ç”¨æ±‡ç¼–å†™çš„forkç¨‹åºï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œï¼ŒQEMUé€šè¿‡<code>do_fork</code>å®ç°æ¨¡æ‹Ÿforkå‡½æ•°ï¼Œä»£ç æ¡†æ¶å¦‚ä¸‹ï¼Œ<span style="background:green; font-weight:bold; color:white">æ¶æ„æ— å…³</span>ï¼Œ</p>
<p><img src="pictures/do_fork-formatted.svg" alt="do_fork-formatted" /></p>
<h2 id="æµ‹è¯•è¿›ç¨‹é—´é€šè®¯"><a class="header" href="#æµ‹è¯•è¿›ç¨‹é—´é€šè®¯">æµ‹è¯•è¿›ç¨‹é—´é€šè®¯</a></h2>
<p><code>mq_overview</code>çš„man pageååˆ†è¯¦ç»†åœ°ä»‹ç»äº†message queueçš„ç”¨æ³•ï¼ŒåŒ…æ‹¬ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ã€‚ä»¥ä¸‹å…³äºmqçš„ä¿¡æ¯å‡æ¥è‡ªç›¸å…³man pageã€‚</p>
<p>å‚è€ƒ<a href="https://stackoverflow.com/questions/3056307/how-do-i-use-mqueue-in-a-c-program-on-a-linux-based-system">How do I use mqueue in a c program on a Linux based system?</a></p>
<p><strong>æ³¨</strong>ï¼š</p>
<ul>
<li><code>mq_open</code>çš„nameå‚æ•°å¿…é¡»æ˜¯ä»¥<code>/</code>å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚æ¥è‡ª<code>mq_overview</code>çš„man page</li>
<li>è‹¥<code>mq_open</code>é‡Œä½¿ç”¨äº†<code>O_CREAT</code>æ ‡å¿—ï¼Œåˆ™å¿…é¡»æä¾›<code>mode</code>å’Œ<code>attr</code>ï¼Œå…¶ä¸­<code>mode</code>çš„å¯é€‰å€¼å‚è€ƒopen(2)çš„man pageã€‚æ¥è‡ª<code>mq_overview</code>çš„man pageã€‚</li>
</ul>
<h3 id="ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨"><a class="header" href="#ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨">ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨</a></h3>
<p>æ¥æº<code>mq_overview</code>çš„man pageï¼Œ</p>
<blockquote>
<p><strong>Library interfaces and system calls</strong></p>
<p>In most cases the <code>mq_*()</code> library interfaces listed above are implemented on top of underlying system calls of the same  name. Deviations from this scheme are indicated in the following table:</p>
<table><thead><tr><th style="text-align: center">Library interface</th><th style="text-align: center">System call</th></tr></thead><tbody>
<tr><td style="text-align: center">mq_close(3)</td><td style="text-align: center">close(2)</td></tr>
<tr><td style="text-align: center">mq_getattr(3)</td><td style="text-align: center">mq_getsetattr(2)</td></tr>
<tr><td style="text-align: center">mq_notify(3)</td><td style="text-align: center">mq_notify(2)</td></tr>
<tr><td style="text-align: center">mq_open(3)</td><td style="text-align: center">mq_open(2)</td></tr>
<tr><td style="text-align: center">mq_receive(3)</td><td style="text-align: center">mq_timedreceive(2)</td></tr>
<tr><td style="text-align: center">mq_send(3)</td><td style="text-align: center">mq_timedsend(2)</td></tr>
<tr><td style="text-align: center">mq_setattr(3)</td><td style="text-align: center">mq_getsetattr(2)</td></tr>
<tr><td style="text-align: center">mq_timedreceive(3)</td><td style="text-align: center">mq_timedreceive(2)</td></tr>
<tr><td style="text-align: center">mq_timedsend(3)</td><td style="text-align: center">mq_timedsend(2)</td></tr>
<tr><td style="text-align: center">mq_unlink(3)</td><td style="text-align: center">mq_unlink(2)</td></tr>
</tbody></table>
</blockquote>

                    </main>
                    <script src="https://utteranc.es/client.js"
                        repo="xieby1/xieby1.github.io"
                        issue-term="pathname"
                        theme="github-light"
                        crossorigin="anonymous"
                        async>
                    </script>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
