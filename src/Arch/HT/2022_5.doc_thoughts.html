<!DOCTYPE html>
<!-- Export by pandoc -D revealjs, pandoc version 2.14.03 -->
<!-- pandoc-types 1.22.1, texmath 0.12.3.2, skylighting 0.10.5.2, -->
<!-- citeproc 0.4.0.1, ipynb 0.1.0.2 -->
<!-- delete /dist after revealjs-url -->
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="🤓xieby1">
  <title>Doc Thoughts</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/reset.css">
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/theme/white.css" id="theme">
  <style>
  .reveal section img {
      margin: 0 0;
      /* override default border color */
      border: transparent;
  }

  .reveal p {
      margin: 0 0;
  }

  /* no margin in styled code div, the same to unstyled code */
  div.sourceCode {
      margin: 0;
  }
  .reveal pre {
      display: flex;
      justify-content: center;
  }

  .reveal pre code {
      max-height: none;
  }

  a.sourceLine {
      /* styled code line is higher than unstyled, make them the same */
      line-height: 0;
  }

  [role="doc-toc"] > ul {
      /* multiple column in first level TOC */
      column-width: 290px;
      width: 100%;
      column-rule-style: solid;
      /* no margin in first level TOC */
      margin: 0 0 0 0;
  }

  #TOC ul {
      /* no bullet */
      list-style-type: none;
      /* no margin, no padding in TOC ul */
      margin-block-start: 0;
      margin-block-end: 0;
      padding-inline-start: 0;
  }

  table {
      /* 42px / sprt 2 */
      font-size: 30px;
  }

  /* enable multiple columns */
  /* https://stackoverflow.com/questions/30861845 */
  .container {
    display: flex;
    align-items: center;
  }
  .col {
    flex: auto;
  }

  /* not to capitalise my titles */
  /* https://stackoverflow.com/questions/47057398 */
  .reveal h1,
  .reveal h2,
  .reveal h3,
  .reveal h4,
  .reveal h5 {
      text-transform: none;
  }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins@4.1.5/chalkboard/style.css">
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-plugins@4.1.5/customcontrols/style.css">
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Doc Thoughts</h1>
  <p class="author">🤓xieby1</p>
  <p class="date">2022.5.?</p>
</section>
<section id="TOC">
<nav role="doc-toc"> 
<ul>
<li><a href="#/motivation"><span class="toc-section-number">1</span> Motivation</a>
<ul>
<li><a href="#/multi-isa-ht"><span class="toc-section-number">1.1</span> Multi-ISA HT</a></li>
</ul></li>
<li><a href="#/process-migration"><span class="toc-section-number">2</span> Process Migration</a>
<ul>
<li><a href="#/motivation-1"><span class="toc-section-number">2.1</span> Motivation</a></li>
<li><a href="#/overview"><span class="toc-section-number">2.2</span> Overview</a></li>
<li><a href="#/state-transformation"><span class="toc-section-number">2.3</span> State Transformation</a></li>
<li><a href="#/result-analysis"><span class="toc-section-number">2.4</span> Result &amp; Analysis</a></li>
<li><a href="#/migration-cost"><span class="toc-section-number">2.5</span> Migration Cost</a></li>
<li><a href="#/migration-points"><span class="toc-section-number">2.6</span> Migration Points</a></li>
<li><a href="#/binary-translation-cost"><span class="toc-section-number">2.7</span> Binary Translation Cost</a></li>
<li><a href="#/summary"><span class="toc-section-number">2.8</span> Summary</a></li>
</ul></li>
<li><a href="#/isas-explore"><span class="toc-section-number">3</span> ISAs Explore</a>
<ul>
<li><a href="#/uarch-design-space"><span class="toc-section-number">3.1</span> uArch Design Space</a></li>
<li><a href="#/uarch-design-space-pruned"><span class="toc-section-number">3.2</span> uArch Design Space (Pruned)</a></li>
<li><a href="#/result-analysis-1"><span class="toc-section-number">3.3</span> Result &amp; Analysis</a></li>
<li><a href="#/all-tests-isa-affinity"><span class="toc-section-number">3.4</span> (All-Tests) ISA Affinity</a></li>
<li><a href="#/performance-and-energy-efficiency"><span class="toc-section-number">3.5</span> Performance and Energy Efficiency</a></li>
<li><a href="#/isa-affinity"><span class="toc-section-number">3.6</span> ISA Affinity</a></li>
<li><a href="#/migration-cost-1"><span class="toc-section-number">3.7</span> Migration Cost</a></li>
<li><a href="#/summary-1"><span class="toc-section-number">3.8</span> Summary</a></li>
</ul></li>
<li><a href="#/mitigate-rop-attack"><span class="toc-section-number">4</span> Mitigate ROP Attack</a></li>
<li><a href="#/composite-isa"><span class="toc-section-number">5</span> Composite ISA</a>
<ul>
<li><a href="#/motivation-2"><span class="toc-section-number">5.1</span> Motivation</a></li>
<li><a href="#/isa-design-space"><span class="toc-section-number">5.2</span> ISA Design Space</a></li>
<li><a href="#/uarch-design-space-1"><span class="toc-section-number">5.3</span> uArch Design Space</a></li>
<li><a href="#/results-analysis"><span class="toc-section-number">5.4</span> Results &amp; Analysis</a></li>
<li><a href="#/all-tests-feature-affinity"><span class="toc-section-number">5.5</span> (All-Tests) Feature Affinity</a></li>
<li><a href="#/performance-and-energy-efficiency-1"><span class="toc-section-number">5.6</span> Performance and Energy Efficiency</a></li>
<li><a href="#/migration-cost-2"><span class="toc-section-number">5.7</span> Migration Cost</a></li>
<li><a href="#/summary-2"><span class="toc-section-number">5.8</span> Summary</a></li>
<li><a href="#/doubt"><span class="toc-section-number">5.9</span> Doubt</a></li>
</ul></li>
<li><a href="#/isa-ht-summary"><span class="toc-section-number">6</span> ISA HT Summary</a></li>
<li><a href="#/my-ideas"><span class="toc-section-number">7</span> My Ideas</a>
<ul>
<li><a href="#/more-specific"><span class="toc-section-number">7.1</span> More Specific</a></li>
<li><a href="#/guest-isa-core"><span class="toc-section-number">7.2</span> guest ISA core</a></li>
<li><a href="#/my-plan"><span class="toc-section-number">7.3</span> My plan</a></li>
</ul></li>
<li><a href="#/my-works"><span class="toc-section-number">8</span> My Works</a>
<ul>
<li><a href="#/choose-ir"><span class="toc-section-number">8.1</span> Choose IR</a></li>
<li><a href="#/semantics-isa-ir"><span class="toc-section-number">8.2</span> Semantics ISA IR</a></li>
<li><a href="#/fuzzball"><span class="toc-section-number">8.3</span> FuzzBall</a></li>
<li><a href="#/fuzzball-1"><span class="toc-section-number">8.4</span> FuzzBall</a></li>
<li><a href="#/sail"><span class="toc-section-number">8.5</span> Sail</a></li>
<li><a href="#/summary-3"><span class="toc-section-number">8.6</span> Summary</a></li>
</ul></li>
<li><a href="#/distance"><span class="toc-section-number">9</span> Distance</a>
<ul>
<li><a href="#/extract-pattern-from-graphs"><span class="toc-section-number">9.1</span> Extract Pattern from Graphs</a></li>
<li><a href="#/my-implementation"><span class="toc-section-number">9.2</span> My Implementation</a></li>
<li><a href="#/graph-edit-distance"><span class="toc-section-number">9.3</span> Graph Edit Distance</a></li>
<li><a href="#/result"><span class="toc-section-number">9.4</span> Result</a></li>
<li><a href="#/why"><span class="toc-section-number">9.5</span> Why</a></li>
</ul></li>
<li><a href="#/cover"><span class="toc-section-number">10</span> Cover</a>
<ul>
<li><a href="#/more-specific-1"><span class="toc-section-number">10.1</span> More Specific</a></li>
<li><a href="#/my-implementation---123"><span class="toc-section-number">10.2</span> My Implementation - 123</a></li>
<li><a href="#/preprocess-tcgs"><span class="toc-section-number">10.3</span> preprocess TCGs</a></li>
<li><a href="#/tcgs-to-a-graph"><span class="toc-section-number">10.4</span> TCGs to a Graph</a></li>
<li><a href="#/my-implementation---456"><span class="toc-section-number">10.5</span> My Implementation - 456</a></li>
<li><a href="#/induced-connected-sub-graphs"><span class="toc-section-number">10.6</span> Induced-Connected Sub-Graphs</a></li>
<li><a href="#/count-freq-of-sub-graphs"><span class="toc-section-number">10.7</span> Count freq of Sub-Graphs</a></li>
<li><a href="#/result-so-far"><span class="toc-section-number">10.8</span> Result so far</a></li>
</ul></li>
</ul>
</nav>
</section>

<section>
<section id="motivation" class="title-slide slide level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Motivation</h1>
<!-- Number of slides is huge, so toc is huge -->
<style>
[role="doc-toc"] {zoom: 60%;}
[role="doc-toc"] > ul {column-width: 400px;}
</style>
<ul>
<li>HM (Homogeneous)</li>
<li>Single-ISA HT (Heterogeneous)</li>
<li><strong>Multi-ISA HT</strong></li>
</ul>
<div style="zoom: 60%;">
<p>📄Survey: 2015. <em>Heterogeneous Multi-core Architectures</em>, Tulika Mitra, jip, 15</p>
</div>
</section>
<section id="multi-isa-ht" class="slide level2" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Multi-ISA HT</h2>
<p>😎Ashish Venkat</p>
<div style="zoom: 90%;">
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="header">
<th>Y</th>
<th style="text-align: center;">C/J</th>
<th style="text-align: center;">Cit</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2012</td>
<td style="text-align: center;">asplos</td>
<td style="text-align: center;">95</td>
<td>Execution migration in a heterogeneous-ISA chip multiprocessor</td>
</tr>
<tr class="even">
<td>2014</td>
<td style="text-align: center;">isca</td>
<td style="text-align: center;">112</td>
<td>Harnessing ISA diversity: Design of a heterogeneous-ISA chip multiprocessor</td>
</tr>
<tr class="odd">
<td>2016</td>
<td style="text-align: center;">asplos</td>
<td style="text-align: center;">26</td>
<td>HIPStR: Heterogeneous-ISA Program State Relocation</td>
</tr>
<tr class="even">
<td>2018</td>
<td style="text-align: center;">doc</td>
<td style="text-align: center;">5</td>
<td><strong>Breaking the ISA Barrier in Modern Computing</strong></td>
</tr>
<tr class="odd">
<td>2019</td>
<td style="text-align: center;">hpca</td>
<td style="text-align: center;">17</td>
<td>Composite-ISA Cores: Enabling Multi-ISA Heterogeneity Using a Single ISA</td>
</tr>
</tbody>
</table>
</div>
</section></section>
<section>
<section id="process-migration" class="title-slide slide level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Process Migration</h1>
<h2>
Execution Migration in a Heterogeneous-ISA Chip Multiprocessor
</h2>
<p>Matthew DeVuyst, <strong>Ashish Venkat</strong>, Dean M. Tullsen</p>
<p>University of California, San Diego</p>
<p>2012 asplos 95</p>
</section>
<section id="motivation-1" class="slide level2" data-number="2.1">
<h2 data-number="2.1"><span class="header-section-number">2.1</span> Motivation</h2>
<p>Single-ISA HT v.s. Single-ISA HM (Homogeneous)</p>
<ul>
<li>performance</li>
<li>energy efficiency</li>
</ul>
<p>Multi-ISA HT v.s. Single-ISA HT</p>
<ul>
<li>process migration</li>
</ul>
<p>HT Cores v.s. HT Machines</p>
<ul>
<li>shared memory, copy less</li>
</ul>
</section>
<section id="overview" class="slide level2" data-number="2.2">
<h2 data-number="2.2"><span class="header-section-number">2.2</span> Overview</h2>
<div class="container">
<div class="col" style="zoom: 70%;">
<h3>
Mechanism
</h3>
<ul>
<li>Fat executables</li>
<li>Equivalence point
<ul>
<li>memory state is equivalent</li>
<li>constraint to function call</li>
</ul></li>
<li>Binary translate</li>
<li>State transform</li>
</ul>
</div>
<div class="col" style="zoom: 133%;">
<p><img data-src="./pictures/process_migration.svg" /></p>
</div>
</div>
</section>
<section id="state-transformation" class="slide level2" data-number="2.3">
<h2 data-number="2.3"><span class="header-section-number">2.3</span> State Transformation</h2>
<div class="container">
<div class="col">
<h3>
Compile Time
</h3>
<p>Memory Image Consistency</p>
<div style="zoom: 70%;">
<ul>
<li>Global Data</li>
<li>Code Section
<ul>
<li>same function address</li>
<li>(call addr may not same)</li>
</ul></li>
<li>Heap
<ul>
<li>same implement <code>malloc</code></li>
</ul></li>
<li>Stack
<ul>
<li>ABI, ARM &amp; MIPS (RISC)
<ul>
<li>padding</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div class="col">
<h3>
Run Time
</h3>
<p>Stack Transformation</p>
<div style="zoom: 70%;">
<ul>
<li>depends on compilation info</li>
<li>local variable locations
<ul>
<li>register</li>
<li>fixed stack slot</li>
<li>register spilled on stack</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="result-analysis" class="slide level2" data-number="2.4">
<h2 data-number="2.4"><span class="header-section-number">2.4</span> Result &amp; Analysis</h2>
<ul>
<li>Runtime Compromise
<ul>
<li>On average suffers by 3.1% in ARM, 1.6% in MIPS</li>
</ul></li>
<li>Migration Cost</li>
<li>Migration Points</li>
<li>Binary Translation Cost</li>
</ul>
</section>
<section id="migration-cost" class="slide level2" data-number="2.5">
<h2 data-number="2.5"><span class="header-section-number">2.5</span> Migration Cost</h2>
<p>(Without Binary Translation)</p>
<p><img src="./pictures/2012.f2.migration_cost.svg" style="zoom: 200%;"></p>
<p>On average</p>
<ul>
<li>272ms ARM =&gt; MIPS</li>
<li>344ms MIPS =&gt; ARM</li>
</ul>
<!-- <img src="./pictures/2012.f3.perf_freq_no_bt_st.svg" style="zoom: 120%;"> -->
<!-- Perf. (no BT&ST) vs freq. -->
<!-- * Binary Translation -->
<!-- * State Transformation -->
</section>
<section id="migration-points" class="slide level2" data-number="2.6">
<h2 data-number="2.6"><span class="header-section-number">2.6</span> Migration Points</h2>
<p><img src="./pictures/2012.f4.time_to_next_call.svg" style="zoom: 120%;"></p>
<p>dummy calls added to</p>
<ul>
<li>outermost loops
<ul>
<li>-1.4% ARM, -4.7% MIPS</li>
</ul></li>
<li>second-innermost loops
<ul>
<li>-2.3% ARM, 5.4% MIPS</li>
</ul></li>
</ul>
</section>
<section id="binary-translation-cost" class="slide level2" data-number="2.7">
<h2 data-number="2.7"><span class="header-section-number">2.7</span> Binary Translation Cost</h2>
<div class="container">
<div class="col">
<p><img src="./pictures/2012.f10.migration_cost_bt_st.svg" style="zoom: 120%;"></p>
<ul>
<li>BT: Inst Expansion Ratio 1~3.5</li>
</ul>
</div>
<div class="col">
<p><img src="./pictures/2012.f11.perf_freq.svg" style="zoom: 120%;"></p>
<p>Perf. vs migration freq.</p>
</div>
</div>
</section>
<section id="summary" class="slide level2" data-number="2.8">
<h2 data-number="2.8"><span class="header-section-number">2.8</span> Summary</h2>
<ul>
<li>need to transform stack &amp; regs</li>
<li>no need to transform pointers</li>
<li>runtime compromise (w/o migration)
<ul>
<li>-1.6% MIPS, -3.1% ARM</li>
</ul></li>
<li>state transformation
<ul>
<li>272us ARM=&gt;MIPS, 344us MIPS=&gt;ARM</li>
</ul></li>
<li>binary translation
<ul>
<li>2.75ms ARM=&gt;MIPS, 7.24ms MIPS=ARM</li>
</ul></li>
<li>migrate per O(100ms) perf loss &lt; 5%</li>
</ul>
</section></section>
<section>
<section id="isas-explore" class="title-slide slide level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> ISAs Explore</h1>
<h2>
Harnessing ISA Diversity: Design of a Heterogeneous-ISA Chip Multiprocessor
</h2>
<p><strong>Ashish Venkat</strong>, Dean M. Tullsen</p>
<p>University of California, San Diego</p>
<p>2014 isca 112</p>
</section>
<section id="uarch-design-space" class="slide level2" data-number="3.1">
<h2 data-number="3.1"><span class="header-section-number">3.1</span> uArch Design Space</h2>
<div style="zoom: 60%;">
<table>
<thead>
<tr class="header">
<th>Design Parameter</th>
<th>Design Choices</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ISA</td>
<td>Thumb, Alpha, x86-64</td>
</tr>
<tr class="even">
<td>Execution Semantics</td>
<td>In-order, Out-of-order</td>
</tr>
<tr class="odd">
<td>Issue width</td>
<td>1, 2, 4</td>
</tr>
<tr class="even">
<td>Branch Predictor</td>
<td>local, tournament</td>
</tr>
<tr class="odd">
<td>Reorder Buffer Size</td>
<td>64, 128 entries</td>
</tr>
<tr class="even">
<td>Architectural Register File</td>
<td>ISA-specific</td>
</tr>
<tr class="odd">
<td>Physical Register File (Integer)</td>
<td>96, 160</td>
</tr>
<tr class="even">
<td>Physical Register File (FP/SIMD)</td>
<td>64, 96</td>
</tr>
<tr class="odd">
<td>Integer ALUs</td>
<td>1, 3, 6</td>
</tr>
<tr class="even">
<td>Integer Multiply/Divide Units</td>
<td>1, 2</td>
</tr>
<tr class="odd">
<td>Floating-point ALUs</td>
<td>1, 2, 4</td>
</tr>
<tr class="even">
<td>FP Multiply/Divide Units</td>
<td>1, 2</td>
</tr>
<tr class="odd">
<td>SIMD Units</td>
<td>1, 2, 4</td>
</tr>
<tr class="even">
<td>Load/Store Queue Sizes</td>
<td>16, 32 entries</td>
</tr>
<tr class="odd">
<td>Instruction Cache</td>
<td>32KB 4-way, 64KB 4-way</td>
</tr>
<tr class="even">
<td>Private Data Cache</td>
<td>32KB 4-way, 64KB 4-way</td>
</tr>
<tr class="odd">
<td>Shared Last Level (L2) Cache</td>
<td>4-banked 4MB 4-way, 4-banked 8MB 8-way</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="uarch-design-space-pruned" class="slide level2" data-number="3.2">
<h2 data-number="3.2"><span class="header-section-number">3.2</span> uArch Design Space (Pruned)</h2>
<p>~750k combinations</p>
<p>↓</p>
<p>Prune correlations</p>
<p>↓</p>
<p>600 combinations</p>
<div style="zoom: 60%;">
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 70%" />
</colgroup>
<thead>
<tr class="header">
<th>Design Parameter</th>
<th>Design Choices</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ISA</td>
<td>Thumb, Alpha, x86-64</td>
</tr>
<tr class="even">
<td>Execution Semantics</td>
<td>In-order, Out-of-order</td>
</tr>
<tr class="odd">
<td>Branch Predictor</td>
<td>local, tournament</td>
</tr>
<tr class="even">
<td>Reorder Buffer-Register File</td>
<td>64-96-64, 128-160-96 entries</td>
</tr>
<tr class="odd">
<td>Issue Width-Functional Units</td>
<td>1-1-1-1-1-1, 1-3-2-2-2-2, 2-3-2-2-2-2, 4-3-2-2-2-2, 4-6-2-4-2-4</td>
</tr>
<tr class="even">
<td>Load/Store Queue Sizes</td>
<td>16, 32 entries</td>
</tr>
<tr class="odd">
<td>Cache Hierarchy</td>
<td>32K/4-32K/4-4M/4, 32K/4-32K/4-8M/8, 64K/4-64K/4-4M/4, 64K/4-64K/4-8M/8</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="result-analysis-1" class="slide level2" data-number="3.3">
<h2 data-number="3.3"><span class="header-section-number">3.3</span> Result &amp; Analysis</h2>
<ul>
<li>(All-Tests) ISA Affinity
<ul>
<li>All tests preferred uArch/ISA</li>
</ul></li>
<li>Performance and Energy Efficiency</li>
<li>(Particular-Test) ISA Affinity
<ul>
<li>Particular test preferred ISAs</li>
</ul></li>
<li>Migration Cost</li>
</ul>
</section>
<section id="all-tests-isa-affinity" class="slide level2" data-number="3.4">
<h2 data-number="3.4"><span class="header-section-number">3.4</span> (All-Tests) ISA Affinity</h2>
<p>uArch Design Space Result</p>
<div class="container">
<div class="col">
<ul>
<li>X: uArch parameters</li>
<li>Y: frequency of occurrence</li>
<li>Data: <strong>best designs</strong> from all experiments</li>
</ul>
</div>
<div class="col">
<p><img data-src="./pictures/2014.f8.design_space_exploration.svg" /></p>
</div>
</div>
</section>
<section id="performance-and-energy-efficiency" class="slide level2" data-number="3.5">
<h2 data-number="3.5"><span class="header-section-number">3.5</span> Performance and Energy Efficiency</h2>
<div class="container" style="zoom: 70%;">
<div class="col">
<p>Test targets</p>
<ul>
<li>Homogeneous</li>
<li>Single-ISA</li>
<li>🎉<strong>Heterogeneous-ISA</strong></li>
</ul>
</div>
<div class="col">
<p>Tests</p>
<table>
<thead>
<tr class="header">
<th>x</th>
<th>y</th>
<th>workload</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Peak Power</td>
<td>Speedup</td>
<td>Multi Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>Speedup</td>
<td>Multi Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>EDP</td>
<td>Multi Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>EDP</td>
<td>Multi Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>Speedup</td>
<td>Single Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>Speedup</td>
<td>Single Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>EDP</td>
<td>Single Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>EDP</td>
<td>Single Thread</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="isa-affinity" class="slide level2" data-number="3.6">
<h2 data-number="3.6"><span class="header-section-number">3.6</span> ISA Affinity</h2>
<div class="container">
<div class="col" style="zoom: 75%;">
<ul>
<li>4 columns : 4 optimizations
<ul>
<li>Single-thread performance</li>
<li>Multi-program performance</li>
<li>Single-thread EDP (Power)</li>
<li>Multi-program EDP (Power)</li>
</ul></li>
</ul>
</div>
<div class="col">
<p><img data-src="./pictures/2014.f9.isa_affinity.svg" /></p>
</div>
</div>
</section>
<section id="migration-cost-1" class="slide level2" data-number="3.7">
<h2 data-number="3.7"><span class="header-section-number">3.7</span> Migration Cost</h2>
<div class="container">
<div class="col">
<p><img src="./pictures/2014.f10.migration_dynamic_insts_num.svg" style="zoom: 140%;"></p>
<p>Distance to next equivalence</p>
</div>
<div class="col">
<p><img src="./pictures/2014.f11.avg_migration_time.svg" style="zoom: 140%;"></p>
<p>Average time: 4ms</p>
</div>
<div class="col">
<p><img src="./pictures/2014.f12.migration_bt_percent.svg" style="zoom: 140%;"></p>
<p>BT percentage</p>
</div>
</div>
</section>
<section id="summary-1" class="slide level2" data-number="3.8">
<h2 data-number="3.8"><span class="header-section-number">3.8</span> Summary</h2>
<ul>
<li>HM =&gt; single-ISA HT =&gt; HT ISA</li>
<li>uArch design space exploration</li>
<li>+20.8% perf. -23% energy than single-ISA HT</li>
<li>avg migration time: 4ms, bt high%</li>
</ul>
</section></section>
<section id="mitigate-rop-attack" class="title-slide slide level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Mitigate ROP Attack</h1>
<div style="zoom: 60%;">
<p>ROP (Return-Oriented Programming)</p>
</div>
<h2>
HIPStR – Heterogeneous-ISA Program State Relocation
</h2>
<p><strong>Ashish Venkat</strong>, Sriskanda Shamasunder, Dean M. Tullsen, Hovav Shacham</p>
<p>University of California, San Diego</p>
<p>2016 asplos 26</p>
</section>

<section>
<section id="composite-isa" class="title-slide slide level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Composite ISA</h1>
<h2>
Composite-ISA Cores: Enabling Multi-ISA Heterogeneity Using a Single ISA
</h2>
<div class="container">
<div class="col">
<p><strong>Ashish Venkat</strong></p>
<p>University of Virginia</p>
</div>
<div class="col">
<p>Harsha Basavaraj Dean M. Tullsen</p>
<p>University of California, San Diego</p>
</div>
</div>
<p>2019 hpca 17</p>
</section>
<section id="motivation-2" class="slide level2" data-number="5.1">
<h2 data-number="5.1"><span class="header-section-number">5.1</span> Motivation</h2>
<h3>
HT ISA problems
</h3>
<ul>
<li>licensing</li>
<li>verification costs &amp; barriers</li>
<li>process migration fat binaries</li>
<li>binary translation costs</li>
<li>state transformation costs</li>
</ul>
<h3>
Solution
</h3>
<ul>
<li>Composite ISA
<ul>
<li>Superset ISA resembles x86</li>
<li>Subset ISA HT</li>
</ul></li>
</ul>
</section>
<section id="isa-design-space" class="slide level2" data-number="5.2">
<h2 data-number="5.2"><span class="header-section-number">5.2</span> ISA Design Space</h2>
<!-- | Design Parameter   | Design Choices                                    | -->
<!-- |--------------------|---------------------------------------------------| -->
<!-- | Register Depth     | 8, 16, 32, 64                                     | -->
<!-- | Register Width     | 32, 64                                            | -->
<!-- | Opcode & Addr Mode | RISC(microx86), CISC                              | -->
<!-- | Predication        | partial (x86), full with gpr (this), full with cc | -->
<!-- | Data-Parallel      | with SSE2, without SSE2                           | -->
<div class="container">
<div class="col">

</div>
<div class="col" style="zoom: 100%;">
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="header">
<th>ISA Parameter</th>
<th>Options</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Register depth</td>
<td>8, 16, 32, 64 registers</td>
</tr>
<tr class="even">
<td>Register width</td>
<td>32-bit, 64-bit registers</td>
</tr>
<tr class="odd">
<td>Instruction/Addressing mode complexity</td>
<td>1:1 macroop-microop encoding (load-store x86 micro-op ISA), 1:n macroop-microop encoding (fully CISC x86 ISA)</td>
</tr>
<tr class="even">
<td>Predication Support</td>
<td>Full Predication like IA-64/Hexagon vs Partial (cmov) Predication</td>
</tr>
<tr class="odd">
<td>Data Parallelism</td>
<td>Scalar vs Vector (SIMD) execution</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="./pictures/2019.f1.uarch_design_sapce.svg" style="zoom: 140%;"></p>
</section>
<section id="uarch-design-space-1" class="slide level2" data-number="5.3">
<h2 data-number="5.3"><span class="header-section-number">5.3</span> uArch Design Space</h2>
<div style="zoom: 60%;">
<table>
<colgroup>
<col style="width: 46%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="header">
<th>Microarchitectural Parameter</th>
<th>Options</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Execution Semantics</td>
<td>Inorder vs Out-Of-Order designs</td>
</tr>
<tr class="even">
<td>Fetch/Issue Width</td>
<td>1, 2, 4</td>
</tr>
<tr class="odd">
<td>Decoder Configurations</td>
<td>1-3 1:1 decoders, 1 1:4 decoder, MSROM</td>
</tr>
<tr class="even">
<td>Micro-op Optimizations</td>
<td>Micro-op Cache, Micro-op Fusion</td>
</tr>
<tr class="odd">
<td>Instruction Queue Sizes</td>
<td>32, 64</td>
</tr>
<tr class="even">
<td>Reorder Buffer Sizes</td>
<td>64, 128</td>
</tr>
<tr class="odd">
<td>Physical Register File Configurations</td>
<td>(96 INT, 64 FP/SIMD), (64 INT, 96 FP/SIMD)</td>
</tr>
<tr class="even">
<td>Branch Predictors</td>
<td>2-level local, gshare, tournament</td>
</tr>
<tr class="odd">
<td>Integer ALUs</td>
<td>1, 3, 6</td>
</tr>
<tr class="even">
<td>FP/SIMD ALUs</td>
<td>1, 2, 4</td>
</tr>
<tr class="odd">
<td>Load/Store Queue Sizes</td>
<td>16, 32</td>
</tr>
<tr class="even">
<td>Instruction Cache</td>
<td>32KB 4-way, 64KB 4-way</td>
</tr>
<tr class="odd">
<td>Private Data Cache</td>
<td>32KB 4-way, 64KB 4-way</td>
</tr>
<tr class="even">
<td>Shared Last Level (L2) Cache</td>
<td>4-banked 4MB 4-way, 4-banked 8MB 8-way</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="results-analysis" class="slide level2" data-number="5.4">
<h2 data-number="5.4"><span class="header-section-number">5.4</span> Results &amp; Analysis</h2>
<ul>
<li>(All-Tests) Feature Affinity
<ul>
<li>All tests preferred feature</li>
</ul></li>
<li>Performance and Energy Efficiency</li>
<li><em>Feature Sensitivity Analysis</em>
<ul>
<li>by removing some feature diversity</li>
</ul></li>
<li><em>(Particular-Test) Feature Affinity</em>
<ul>
<li>Particular test preferred features</li>
</ul></li>
<li>Migration Cost</li>
</ul>
<div style="zoom: 70%;">
<p>by 2 petaflop XSEDE Comet cluster at the San Diego Supercomputing Center</p>
</div>
</section>
<section id="all-tests-feature-affinity" class="slide level2" data-number="5.5">
<h2 data-number="5.5"><span class="header-section-number">5.5</span> (All-Tests) Feature Affinity</h2>
<p>Feature Space Explore Results</p>
<div class="container">
<div class="col">
<p><img src="./pictures/2019.t3.perf_space_explore.svg" style="zoom: 120%;"></p>
<div style="zoom: 80%;">
<p>opt for multi-thread perfermance</p>
</div>
</div>
<div class="col">
<p><img src="./pictures/2019.t4.energy_space_explore.svg" style="zoom: 120%;"></p>
<div style="zoom: 80%;">
<p>opt for multi-thread energy efficiency</p>
</div>
</div>
</div>
</section>
<section id="performance-and-energy-efficiency-1" class="slide level2" data-number="5.6">
<h2 data-number="5.6"><span class="header-section-number">5.6</span> Performance and Energy Efficiency</h2>
<div class="container" style="zoom: 70%;">
<div class="col">
<p>Test targets</p>
<ul>
<li>Homogeneous (x86-64)</li>
<li>Single-ISA Heterogeneous (x86-64)</li>
<li>Composite-ISA fixed feat. (x86-64 + x86ized Thumb + x86ized Alpha)</li>
<li>Heterogeneous ISA (x86-64 + Thumb + Alpha)</li>
<li>🎉<strong>Composite-ISA full feat. (x86-64 + Full Feat. Diversity)</strong></li>
</ul>
</div>
<div class="col">
<p>Tests</p>
<table>
<thead>
<tr class="header">
<th>x</th>
<th>y</th>
<th>workload</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Peak Power</td>
<td>Speedup</td>
<td>Multi Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>Speedup</td>
<td>Multi Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>EDP</td>
<td>Multi Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>EDP</td>
<td>Multi Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>Speedup</td>
<td>Single Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>Speedup</td>
<td>Single Thread</td>
</tr>
<tr class="odd">
<td>Peak Power</td>
<td>EDP</td>
<td>Single Thread</td>
</tr>
<tr class="even">
<td>Area</td>
<td>EDP</td>
<td>Single Thread</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="migration-cost-2" class="slide level2" data-number="5.7">
<h2 data-number="5.7"><span class="header-section-number">5.7</span> Migration Cost</h2>
<div class="container">
<div class="col">
<h3>
Specific feature downgradation
</h3>
<p><img src="./pictures/2019.f14.feat_downgrade_cost.svg" style="zoom: 140%;"></p>
</div>
<div class="col">
<h3>
Overall feature downgradation
</h3>
<p>average 0.42%, max 0.75%</p>
<ul>
<li>1863 migrations
<ul>
<li>125 64-bit =&gt; 32-bit</li>
<li>171 64 regs =&gt; 32 regs</li>
<li>177 64 regs =&gt; 16 regs</li>
<li>8 x86 =&gt; microx86</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="summary-2" class="slide level2" data-number="5.8">
<h2 data-number="5.8"><span class="header-section-number">5.8</span> Summary</h2>
<p>Composite ISA</p>
<ul>
<li>no licensing problem</li>
<li>no fat binary</li>
<li>no state transformation</li>
<li>+19% perf., -30% energy than single-ISA HT</li>
<li>match or outperform HT-ISA</li>
<li>Migration Cost: avg 0.42%, max 0.75%</li>
</ul>
</section>
<section id="doubt" class="slide level2" data-number="5.9">
<h2 data-number="5.9"><span class="header-section-number">5.9</span> Doubt</h2>
<p><img src="./pictures/2019.f4.x86_fetch_decode.svg" style="zoom: 150%;"></p>
<blockquote>
<p>Our implementations of the micro-op cache and fusion are consistent with guidelines mentioned in the Intel Architecture Optimization Manual [112].</p>
</blockquote>
<div style="zoom: 70%;">
<p>[112] Intel R 64 and IA-32 Architectures Optimization Reference Manual.</p>
</div>
</section></section>
<section id="isa-ht-summary" class="title-slide slide level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> ISA HT Summary</h1>
<h2>
Pros
</h2>
<ul>
<li>a new arch design: ISA HT</li>
<li>higher perfermance, less energy</li>
</ul>
<h2>
Cons
</h2>
<ul>
<li>(intrinsic) need re-compilation</li>
<li>not implement in OS</li>
</ul>
</section>

<section>
<section id="my-ideas" class="title-slide slide level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> My Ideas</h1>
<h2>
Pros
</h2>
<ul>
<li>a new arch design: ISA HT</li>
<li>higher perfermance, less energy</li>
</ul>
<div class="container">
<div class="col">
<h2>
Cons
</h2>
<ul>
<li>(intrinsic) need re-compilation</li>
<li>not implement in OS (kernel)</li>
</ul>
</div>
<div class="col">
<h2>
Improvements
</h2>
<ul>
<li>no re-compilation: focus on BT</li>
<li>implement in OS (kernel)</li>
</ul>
</div>
</div>
</section>
<section id="more-specific" class="slide level2" data-number="7.1">
<h2 data-number="7.1"><span class="header-section-number">7.1</span> More Specific</h2>
<div class="container">
<div class="col">
<p><strong>Venkat’s idea</strong></p>
<ul>
<li>re-compiled apps</li>
<li><em>kernel</em></li>
<li>compiler</li>
<li>ISA HT</li>
</ul>
</div>
<div class="col">
<p><strong>My idea</strong></p>
<ul>
<li>original apps</li>
<li>kernel</li>
<li>BT</li>
<li>ISA HT</li>
</ul>
</div>
<div class="col">
<p><img src="./pictures/isa_ht_for_bt.svg" style="zoom: 200%;"></p>
</div>
</div>
</section>
<section id="guest-isa-core" class="slide level2" data-number="7.2">
<h2 data-number="7.2"><span class="header-section-number">7.2</span> guest ISA core</h2>
<div class="container">
<div class="col">
<p><img src="./pictures/guest_isa_core.svg" style="zoom: 200%;"></p>
</div>
<div class="col">
<ul>
<li>SW BT: no legit problem</li>
<li>KBT: inspired by KVM
<ul>
<li>Host/Guest seperate VA space</li>
</ul></li>
<li>uops: no PC mismatch problem
<ul>
<li>no indirect jump problem</li>
</ul></li>
<li>uops: designed for Host/Guest
<ul>
<li>e.g. Host/ARM uops</li>
<li>e.g. Host/x86 uops</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="my-plan" class="slide level2" data-number="7.3">
<h2 data-number="7.3"><span class="header-section-number">7.3</span> My plan</h2>
<ul>
<li>uops: IR + graph algorithm
<ul>
<li>BT IR</li>
<li>ISA Semantics IR</li>
</ul></li>
<li>uArch: Gem5 + McPat
<ul>
<li>prove performance improvement</li>
<li>prove energy saving</li>
</ul></li>
<li>kernel: ISA-HT QEMU-sys
<ul>
<li>ISA-HT QEMU-sys replace Gem5</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="my-works" class="title-slide slide level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> My Works</h1>
<p>Goal: A Methodology to generate uops</p>
<h2>
An analogue
</h2>
<table>
<thead>
<tr class="header">
<th>Linear Algebra</th>
<th>Computer Science</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vector A vs Vector B</td>
<td>Host ISA vs Guest ISA</td>
</tr>
<tr class="even">
<td>Common Base Vector</td>
<td>Intermediate Representation</td>
</tr>
<tr class="odd">
<td>Distance</td>
<td>Distance?</td>
</tr>
<tr class="even">
<td>Linear Independent Base</td>
<td>minimal Cover?</td>
</tr>
</tbody>
</table>
</section>
<section id="choose-ir" class="slide level2" data-number="8.1">
<h2 data-number="8.1"><span class="header-section-number">8.1</span> Choose IR</h2>
<ul>
<li>BT IR
<ul>
<li>QEMU tcg</li>
<li>LLVM IR</li>
</ul></li>
<li>Semantics ISA IR</li>
</ul>
</section>
<section id="semantics-isa-ir" class="slide level2" data-number="8.2">
<h2 data-number="8.2"><span class="header-section-number">8.2</span> Semantics ISA IR</h2>
<ul>
<li>cakeml[1], ACL2, K[2], FuzzBall[3], sail[4][5], …</li>
</ul>
<h3>
Goal
</h3>
<ul>
<li>Model ISA in math rigorous language.</li>
<li>Auto generate test-orcale tool.</li>
<li>Compute allowed behaviours in test cases.</li>
<li>Provide reference for HW/SW dev.</li>
</ul>
<div style="zoom:40%;">
<ul>
<li>[1]: Kumar, Ramana et al. “CakeML: a verified implementation of ML.” Proceedings of the 41st ACM SIGPLAN-SIGACT (2014).</li>
<li>[2]: Dasgupta, Sandeep et al. “A complete formal semantics of x86-64 user-level instruction set architecture.” Proceedings of the 40th ACM SIGPLAN (2019).</li>
<li>[3]: https://github.com/bitblaze-fuzzball/fuzzball</li>
<li>[4]: Gray, Kathryn E. et al. “An integrated concurrency and core-ISA architectural envelope definition, and test oracle, for IBM POWER multiprocessors.” 48th MICRO (2015): 635-646.</li>
<li>[5]: Armstrong, Alasdair et al. “Detailed Models of Instruction Set Architectures : From Pseudocode to Formal Semantics.” (2018).</li>
</ul>
</div>
</section>
<section id="fuzzball" class="slide level2" data-number="8.3">
<h2 data-number="8.3"><span class="header-section-number">8.3</span> FuzzBall</h2>
<p>Compilation</p>
<p><img src="./pictures/multi2multi.svg" style="zoom: 150%;"></p>
<p>Parameterization</p>
<p><img src="./pictures/para.svg" style="zoom: 150%;"></p>
<div style="zoom: 40%;">
<p>Wang, Wenwen et al. “Enhancing Cross-ISA DBT Through Automatically Learned Translation Rules.” 23rd ASPLOS (2018).</p>
</div>
</section>
<section id="fuzzball-1" class="slide level2" data-number="8.4">
<h2 data-number="8.4"><span class="header-section-number">8.4</span> FuzzBall</h2>
<p><img src="./pictures/para.svg" style="zoom: 150%;"></p>
<p>FuzBall Symbolic Execution (Simplified Ver.)</p>
<pre><code>r1_output  = r0 + r1 - 1
edx_output = eax + edx + (-1)</code></pre>
<p>SMT Solver</p>
<pre><code>∀ x,y ∈ int32
┌─r0 = eax = x
├─r1 = edx = y
└─r0 + r1 -1 = eax + edx + (-1)</code></pre>
</section>
<section id="sail" class="slide level2" data-number="8.5">
<h2 data-number="8.5"><span class="header-section-number">8.5</span> Sail</h2>
<p>Focus on ISA concurrecny model</p>
<p><img src="./pictures/2015.power_mp_sync_ctrl.svg" style="zoom:200%;"></p>
</section>
<section id="summary-3" class="slide level2" data-number="8.6">
<h2 data-number="8.6"><span class="header-section-number">8.6</span> Summary</h2>
<ul>
<li>Goal: A Methodology to generate uops</li>
<li>Tool: IR</li>
<li>Algorithm: Distance? Cover?</li>
</ul>
</section></section>
<section>
<section id="distance" class="title-slide slide level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Distance</h1>
<table>
<thead>
<tr class="header">
<th>Linear Algebra</th>
<th>Computer Science</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vector A vs Vector B</td>
<td>Host ISA vs Guest ISA</td>
</tr>
<tr class="even">
<td>Common Base Vector</td>
<td>Intermediate Representation</td>
</tr>
<tr class="odd">
<td>Distance</td>
<td>Distance?</td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>An Inst =&gt; several IRs =&gt; A Graph</p>
</div>
<div class="fragment">
<p>Graph Distance[1]</p>
</div>
<div class="fragment" style="zoom: 50%;">
<p>[1]: <strong>Algo Intro</strong>: Bengoetxea, Endika. “Inexact Graph Matching Using Estimation of Distribution Algorithms.” Doc Thesis (2002).</p>
</div>
</section>
<section id="extract-pattern-from-graphs" class="slide level2" data-number="9.1">
<h2 data-number="9.1"><span class="header-section-number">9.1</span> Extract Pattern from Graphs</h2>
<ul>
<li>Once we have Distance,
<ul>
<li>Divide Graphs into groups.</li>
</ul></li>
<li>Once we have Distance,
<ul>
<li>Gradient descent.</li>
</ul></li>
</ul>
<pre><code>get_a_uop_from_group:
    while (true)
        g = Gradient(uop, group)
        if (g &lt; τ)
            yield uop
            break
        uop += ε * g</code></pre>
<p>Unsupervised Learning: extract</p>
<div style="zoom: 45%;">
<p>[1]: Zhang, Quanshi et al. “Attributed Graph Mining and Matching: An Attempt to Define and Extract Soft Attributed Patterns.” CVPR (2014).</p>
</div>
</section>
<section id="my-implementation" class="slide level2" data-number="9.2">
<h2 data-number="9.2"><span class="header-section-number">9.2</span> My Implementation</h2>
<ul>
<li>ISA: aarch64 &amp; x86-64</li>
<li>IR: LLVM IR</li>
</ul>
<div class="container">
<div class="col">
<ol type="1">
<li>Remill[1]: an Inst =&gt; several LLVM IRs</li>
<li>LLVM Pass: several LLVM IRs =&gt; a Graph</li>
<li>networkx (python): graph algorithm</li>
</ol>
<ul>
<li>graph edit distance</li>
<li>aarch64:33 * x86-64:351 = 11582 pairs</li>
</ul>
</div>
<div class="col">
<p>x64: ADD_GPR8_MEMb</p>
<p><img src="./pictures/ISEL_ADD_GPR8_MEMb-gai.dot.svg" style="zoom:200%;"></p>
</div>
</div>
<div style="zoom: 50%;">
<p>[1]: https://github.com/lifting-bits/remill</p>
</div>
</section>
<section id="graph-edit-distance" class="slide level2" data-number="9.3">
<h2 data-number="9.3"><span class="header-section-number">9.3</span> Graph Edit Distance</h2>
<div class="container">
<div class="col">
<p>aarch64: ADD_64_ADDSUB_EXT</p>
<p><img src="./pictures/ISEL_ADD_64_ADDSUB_EXT-gai.dot.svg" style="zoom:100%;"></p>
</div>
<div class="col">
<p>x64: ADD_GPR8_MEMb</p>
<p><img src="./pictures/ISEL_ADD_GPR8_MEMb-gai.dot.svg" style="zoom:100%;"></p>
</div>
</div>
<p>Add 2 nodes, 2 edges.</p>
<p>Naive_GED = 2 + 2 = 4</p>
</section>
<section id="result" class="slide level2" data-number="9.4">
<h2 data-number="9.4"><span class="header-section-number">9.4</span> Result</h2>
<p><span class="fragment" style="zoom:200%;">S…L…O…W…</span> <span class="fragment" style="zoom:200%;">…</span> <span class="fragment" style="zoom:200%;">…</span> <span class="fragment" style="zoom:200%;">…🐢</span></p>
<div class="fragment">
<ul>
<li>graph edit distance</li>
<li>aarch64:33 * x86-64:351 = 11582 pairs</li>
</ul>
</div>
<div class="fragment" style="zoom:200%;">
<p>It takes a whole night!</p>
</div>
</section>
<section id="why" class="slide level2" data-number="9.5">
<h2 data-number="9.5"><span class="header-section-number">9.5</span> Why</h2>
<h3>
Definitely
</h3>
<ul>
<li>LLVM generate too much info
<ul>
<li>e.g. PUNPCKHBW MMXq MEMq: ~50 nodes <img src="./pictures/ISEL_PUNPCKHBW_MMXq_MEMq.O3.dot.svg" style="zoom:50%;"></li>
</ul></li>
<li>Graph Edit Distance too complex
<ul>
<li>N-node graph * N-node graph: time ~O(N!)</li>
</ul></li>
</ul>
<h3>
Maybe
</h3>
<ul>
<li>python is slow</li>
</ul>
</section></section>
<section>
<section id="cover" class="title-slide slide level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Cover</h1>
<table>
<thead>
<tr class="header">
<th>Linear Algebra</th>
<th>Computer Science</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vector A vs Vector B</td>
<td>Host ISA vs Guest ISA</td>
</tr>
<tr class="even">
<td>Common Base Vector</td>
<td><span class="fragment strike" data-fragment-index="3">Intermediate Representation</span> <span class="fragment" data-fragment-index="3">Sub-Graphs</span></td>
</tr>
<tr class="odd">
<td>Distance</td>
<td><del>Distance?</del></td>
</tr>
<tr class="even">
<td>Linear Independent Base</td>
<td>minimal Cover?</td>
</tr>
</tbody>
</table>
<div class="fragment" data-fragment-index="1">
<p>An Inst =&gt; several IRs =&gt; A Graph</p>
</div>
<div class="fragment" data-fragment-index="2">
<p>A Graph =&gt; All its Sub-Graphs</p>
</div>
<div class="fragment" data-fragment-index="4">
<p>For all Insts, counting their Sub-Graphs freq.</p>
</div>
</section>
<section id="more-specific-1" class="slide level2" data-number="10.1">
<h2 data-number="10.1"><span class="header-section-number">10.1</span> More Specific</h2>
<ul>
<li>Get all Sub-graphs of a Inst</li>
<li>Count Sub-Graphs freq. for all Insts</li>
<li>Use weighted (freq.) Sub-Graphs, to minial cover Insts</li>
</ul>
</section>
<section id="my-implementation---123" class="slide level2" data-number="10.2">
<h2 data-number="10.2"><span class="header-section-number">10.2</span> My Implementation - 123</h2>
<ul>
<li>ISA: aarch64 &amp; x86-64</li>
<li>IR: QEMU TCG</li>
<li>Lang: CPP</li>
</ul>
<ol type="1">
<li>asmjit[1]: enumerate Insts</li>
<li>QEMU-user single-step: an Inst =&gt; several TCGs</li>
<li>these TCGs =&gt; a Graph</li>
</ol>
<div style="zoom: 50%;">
<p>[1]: https://github.com/asmjit/asmjit.git</p>
</div>
</section>
<section id="preprocess-tcgs" class="slide level2" data-number="10.3">
<h2 data-number="10.3"><span class="header-section-number">10.3</span> preprocess TCGs</h2>
<div class="container">
<div class="col">
<p>aarch64 Inst</p>
<pre><code>2D48003A : setf16 w1</code></pre>
<p>TCGs</p>
<pre><code>mov_i32 tmp0,reg0
shl_i32 NF,tmp0,0x10
shl_i32 VF,tmp0,0xf
mov_i32 ZF,NF
xor_i32 VF,VF,NF</code></pre>
</div>
<div class="col">
<p>Parameterization</p>
<ul>
<li>w1 =&gt; reg0</li>
</ul>
<p>Not SSA</p>
<ul>
<li>tmp0: multiple values</li>
</ul>
</div>
</div>
</section>
<section id="tcgs-to-a-graph" class="slide level2" data-number="10.4">
<h2 data-number="10.4"><span class="header-section-number">10.4</span> TCGs to a Graph</h2>
<div class="container">
<div class="col">
<p>aarch64 Inst</p>
<pre><code>2D48003A : setf16 reg0</code></pre>
<p>TCGs</p>
<pre><code>mov_i32 tmp0,reg0
shl_i32 NF,tmp0,0x10
shl_i32 VF,tmp0,0xf
mov_i32 ZF,NF
xor_i32 VF,VF,NF</code></pre>
</div>
<div class="col">
<p><img src="./pictures/2D48003A.dot.svg" style="zoom:60%;"></p>
</div>
</div>
</section>
<section id="my-implementation---456" class="slide level2" data-number="10.5">
<h2 data-number="10.5"><span class="header-section-number">10.5</span> My Implementation - 456</h2>
<ol start="4" type="1">
<li>this Graph =&gt; all Induced-Connected Sub-Graphs Induced: all edges connecting pairs of nodes are in Sub-Graph</li>
<li>count the freq. of these Sub-Graphs =&gt; map {freq, Sub-Graphs}</li>
<li>cover Insts with minial <strong>weight</strong> by using these Sub-Graphs naive_weight = freq</li>
</ol>
</section>
<section id="induced-connected-sub-graphs" class="slide level2" data-number="10.6">
<h2 data-number="10.6"><span class="header-section-number">10.6</span> Induced-Connected Sub-Graphs</h2>
<div class="container">
<div class="col">
<p><img src="./pictures/2D48003A.dot.svg" style="zoom:60%;"></p>
</div>
<div class="col">
<p>enumerate Induced Connected Sub-Graphs by recursive algo. Time: ~O(2^n)</p>
<ul>
<li>nodes: 11</li>
<li>compute_nodes: 5 (num of TCGs)</li>
<li>Induced Sub-Graphs: 32 = 2^5</li>
<li>Induced Connected Sub-Graphs: 22</li>
</ul>
</div>
</div>
</section>
<section id="count-freq-of-sub-graphs" class="slide level2" data-number="10.7">
<h2 data-number="10.7"><span class="header-section-number">10.7</span> Count freq of Sub-Graphs</h2>
<ul>
<li>Sub-Graphs =&gt; string =&gt; hash =&gt; hash table</li>
<li>Num of Sub-Graphs
<ul>
<li>Inst ~ 5 nodes</li>
<li>Graph ~ 2^5 ~ 30 Sub-Graphs</li>
<li>~700 aarch64 Insts</li>
<li>~10^4 Sub-Graphs</li>
</ul></li>
</ul>
</section>
<section id="result-so-far" class="slide level2" data-number="10.8">
<h2 data-number="10.8"><span class="header-section-number">10.8</span> Result so far</h2>
<div style="zoom:70%;">
<ol type="1">
<li>☑ asmjit[1]: enumerate Insts</li>
<li>☑ QEMU-user single-step: an Inst =&gt; several TCGs</li>
<li>☑ these TCGs =&gt; a Graph</li>
<li>☑ this Graph =&gt; all Induced-Connected Sub-Graphs</li>
<li>☑ count the freq. of these Sub-Graphs =&gt; map {freq, Sub-Graphs}</li>
<li><input type="checkbox" disabled="" />
cover Insts with minial <strong>weight</strong> by using these Sub-Graphs</li>
</ol>
</div>
<h3>
Insteresting Info
</h3>
<ul>
<li>Program run in several seconds</li>
<li>797 aarch64 basic Insts =&gt; 29315 Sub-Graphs</li>
<li>most weighted Sub-Graph</li>
</ul>
<pre><code>shl_i64 =tmp1,tmp0,0x8
sar_i64 =tmp2,tmp1,0x8
and_i64 =tmp4,@01b4e86a93660d9f,tmp3;</code></pre>
</section></section>
    </div>
  </div>

  <script src="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/plugin/notes/notes.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/plugin/search/search.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/reveal.js/4.3.1/plugin/zoom/zoom.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/reveal.js-plugins@4.1.5/chalkboard/plugin.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/reveal.js-plugins@4.1.5/customcontrols/plugin.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        chalkboard: {
          theme: "whiteboard",
        },
        customcontrols: {
          controls: [
            // { icon: '<i class="fa fa-pen-square"></i>',
            //   title: 'Toggle chalkboard (B)',
            //   action: 'RevealChalkboard.toggleChalkboard();'
            // },
            { icon: '<i class="fa fa-pen"></i>',
              title: 'Toggle notes canvas (C)',
              action: 'RevealChalkboard.toggleNotesCanvas();'
            }
          ]
        },
        // reveal.js plugins
        plugins: [
          RevealChalkboard,
          RevealCustomControls,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    </body>
</html>
