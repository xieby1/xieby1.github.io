<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>driver - xieby1&#x27;s notes</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../../favicon.svg">
                        <link rel="shortcut icon" href="../../../favicon.png">
                <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
                <link rel="stylesheet" href="../../../custom.css">
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../../../index.html">Welcome</a></li><li class="chapter-item "><a href="../../../Essays.html">Essays</a></li><li class="chapter-item "><a href="../../../abbreviations.html">abbreviations</a></li><li class="chapter-item affix "><li class="part-title">xieby1's notes</li><li class="chapter-item "><div>ABI</div></li><li class="chapter-item "><div>Algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Graph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Algo/Graph/1998.distance.bunke.prl.775.html">1998.distance.bunke.prl.775.md</a></li><li class="chapter-item "><a href="../../../Algo/Graph/2002.inexact_match.bengoetxea.doc_thesis.107.html">2002.inexact_match.bengoetxea.doc_thesis.107.md</a></li><li class="chapter-item "><a href="../../../Algo/Graph/2014.attributed.zhang.cvpr.19.html">2014.attributed.zhang.cvpr.19.md</a></li><li class="chapter-item "><a href="../../../Algo/Graph/2016.survey.yan.icmr.108.html">2016.survey.yan.icmr.108.md</a></li><li class="chapter-item "><a href="../../../Algo/Graph/2021.igraphmatch.qiao..0.html">2021.igraphmatch.qiao..0.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div></li><li class="chapter-item "><div>Arch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>HT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Arch/HT/2005.cell.kahle.ibmjrd.1093.html">2005.cell.kahle.ibmjrd.1093.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2012.process_migration.devuyst.asplos.83.html">2012.process_migration.devuyst.asplos.83.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2014.isa_explore.venkat.isca.112.html">2014.isa_explore.venkat.isca.112.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2015.overview.mitra.jip.15.html">2015.overview.mitra.jip.15.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2018.process_migration.venkat.doc_thesis.5.html">2018.process_migration.venkat.doc_thesis.5.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2019.composite_isa.venkat.hpca.17.html">2019.composite_isa.venkat.hpca.17.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/2020.byoc_framework.balkind.asplos.3.html">2020.byoc_framework.balkind.asplos.3.md</a></li><li class="chapter-item "><a href="../../../Arch/HT/doc_thoughts.html">doc_thoughts.md</a></li></ol></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Arch/reconf/1997.chimaera.hauck.fccm.461.html">1997.chimaera.hauck.fccm.461.md</a></li><li class="chapter-item "><a href="../../../Arch/reconf/2008.reconf_acc.beck.date.97.html">2008.reconf_acc.beck.date.97.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div></li></ol></li><li class="chapter-item "><div>Benchmarks</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Benchmarks/coremark.html">coremark.md</a></li><li class="chapter-item "><div>herdtools7</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Benchmarks/herdtools7/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><a href="../../../Benchmarks/spec/index.html">spec</a></li><li class="chapter-item "><a href="../../../Benchmarks/spec2000.html">spec2000.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>algo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/algo/2006.lib.杨浩.计算机研究与发展.0.html">2006.lib.杨浩.计算机研究与发展.0.md</a></li><li class="chapter-item "><a href="../../../BT/algo/2016.static_identify_jump_target.federico.cases.9.html">2016.static_identify_jump_target.federico.cases.9.md</a></li><li class="chapter-item "><div>bt_rules</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/algo/bt_rules/2006.peephole_superopt.bansal.asplos.134.html">2006.peephole_superopt.bansal.asplos.134.md</a></li><li class="chapter-item "><a href="../../../BT/algo/bt_rules/2018.learn.wwwang.asplos.11.html">2018.learn.wwwang.asplos.11.md</a></li></ol></li><li class="chapter-item "><div>offload</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/algo/offload/2010.distribit.guan.hpdc.5.html">2010.distribit.guan.hpdc.5.md</a></li></ol></li><li class="chapter-item "><div>reg</div></li><li class="chapter-item "><div>smc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/algo/smc/2015.detect.hawkins.cgo.24.html">2015.detect.hawkins.cgo.24.md</a></li></ol></li><li class="chapter-item "><div>trace</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/algo/trace/1994.opt_profiling_tracing.ball.toplas.580.html">1994.opt_profiling_tracing.ball.toplas.580.md</a></li><li class="chapter-item "><a href="../../../BT/algo/trace/2000.net.duesterwald.asplos.141.html">2000.net.duesterwald.asplos.141.md</a></li><li class="chapter-item "><a href="../../../BT/algo/trace/2005.edge_profile.白童心.计算机工程.2.html">2005.edge_profile.白童心.计算机工程.2.md</a></li><li class="chapter-item "><a href="../../../BT/algo/trace/2005.lei_net.hiniker.micro.39.html">2005.lei_net.hiniker.micro.39.md</a></li></ol></li></ol></li><li class="chapter-item "><div>analysis</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/analysis/2014.simulators_harm.nowatki..19.html">2014.simulators_harm.nowatki..19.md</a></li><li class="chapter-item "><a href="../../../BT/analysis/2020.perfdbt.wu.iccd.2.html">2020.perfdbt.wu.iccd.2.md</a></li></ol></li><li class="chapter-item "><div>application</div></li><li class="chapter-item "><div>Box86</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/Box86/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>dynamic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/dynamic/2017.mambox64.dantras.pldi.18.html">2017.mambox64.dantras.pldi.18.md</a></li></ol></li><li class="chapter-item "><div>Emulator</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Emulator_Design</div></li></ol></li><li class="chapter-item "><a href="../../../BT/exagear.html">exagear.md</a></li><li class="chapter-item "><div>HQEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/HQEMU/codeReading-deprecated.html">codeReading-deprecated.md</a></li><li class="chapter-item "><a href="../../../BT/HQEMU/codeReading.html">codeReading.md</a></li></ol></li><li class="chapter-item "><div>HW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/HW/2008.coprocessor.li.amasbt.3.html">2008.coprocessor.li.amasbt.3.md</a></li><li class="chapter-item "><a href="../../../BT/HW/2009.godson3_x86_emu.hu.micro.84.html">2009.godson3_x86_emu.hu.micro.84.md</a></li><li class="chapter-item "><div>codeCache</div></li><li class="chapter-item "><div>reconf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/HW/reconf/2013.x86_mips_reconf.junior.jsa.4.html">2013.x86_mips_reconf.junior.jsa.4.md</a></li></ol></li><li class="chapter-item "><div>VLIW</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/HW/VLIW/2015.denver.nvidia.micro.36.html">2015.denver.nvidia.micro.36.md</a></li><li class="chapter-item "><a href="../../../BT/HW/VLIW/2019.hybrid_dbt.rokicki.cadics.2.html">2019.hybrid_dbt.rokicki.cadics.2.md</a></li><li class="chapter-item "><div>crusoe</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/HW/VLIW/crusoe/2000.crusoe.klaiber.transmeta.118.html">2000.crusoe.klaiber.transmeta.118.md</a></li></ol></li><li class="chapter-item "><div>daisy</div></li></ol></li></ol></li><li class="chapter-item "><div>kernel</div></li><li class="chapter-item "><a href="../../../BT/libDBT/index.html">libDBT</a></li><li class="chapter-item "><div>lift</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LLBT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/lift/IR/LLBT/LLBT调研.html">LLBT调研.md</a></li><li class="chapter-item "><a href="../../../BT/lift/IR/LLBT/二进制翻译调研报告（LLBT相关）.html">二进制翻译调研报告（LLBT相关）.md</a></li></ol></li><li class="chapter-item "><div>mcsema</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/lift/IR/mcsema/2019.mcsema_dyninst.korencik...html">2019.mcsema_dyninst.korencik...md</a></li><li class="chapter-item "><a href="../../../BT/lift/IR/mcsema/2019.mcsema.researchLogs.html">2019.mcsema.researchLogs.md</a></li><li class="chapter-item "><a href="../../../BT/lift/IR/mcsema/remill.html">remill.md</a></li></ol></li><li class="chapter-item "><div>mctoll</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/lift/IR/mctoll/2019.mctoll.yadavalli.lctes.5.html">2019.mctoll.yadavalli.lctes.5.md</a></li><li class="chapter-item "><a href="../../../BT/lift/IR/mctoll/codesReading.html">codesReading.md</a></li><li class="chapter-item "><a href="../../../BT/lift/IR/mctoll/run.html">run.md</a></li></ol></li><li class="chapter-item "><a href="../../../BT/lift/IR/overview.html">overview.md</a></li><li class="chapter-item "><div>REVNG</div></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/Mem/2008.thread_safe_by_tm.chung.hpca.51.html">2008.thread_safe_by_tm.chung.hpca.51.md</a></li><li class="chapter-item "><a href="../../../BT/Mem/2016.atomic.rigo.taco.6.html">2016.atomic.rigo.taco.6.md</a></li></ol></li><li class="chapter-item "><div>oldProj</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/oldProj/1993.mips2alphaaxp.sites.cacm.267.html">1993.mips2alphaaxp.sites.cacm.267.md</a></li><li class="chapter-item "><a href="../../../BT/oldProj/1998.fx32.chernoff.micro.217.html">1998.fx32.chernoff.micro.217.md</a></li><li class="chapter-item "><div>dbt4AndStatic</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/oldProj/dbt4AndStatic/DBT4代码阅读笔记.html">DBT4代码阅读笔记.md</a></li><li class="chapter-item "><a href="../../../BT/oldProj/dbt4AndStatic/dbt-static.html">dbt-static.md</a></li><li class="chapter-item "><a href="../../../BT/oldProj/dbt4AndStatic/去除orc工作量和难度.html">去除orc工作量和难度.md</a></li></ol></li></ol></li><li class="chapter-item "><div>others</div></li><li class="chapter-item "><div>overview</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/overview/2001.bt_opt_challenges.altman.pieee.38.html">2001.bt_opt_challenges.altman.pieee.38.md</a></li><li class="chapter-item "><a href="../../../BT/overview/2004.bibliography_of_simulators.html">2004.bibliography_of_simulators.md</a></li></ol></li><li class="chapter-item "><div>QEMU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/QEMU/16k.html">16k.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/2005.qemu.bellard.usenix.2217.html">2005.qemu.bellard.usenix.2217.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/2017.qemu_multi_cores.cota.cgo.8.html">2017.qemu_multi_cores.cota.cgo.8.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/LA-backend.html">LA-backend.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/linux-user-32.html">linux-user-32.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/linux-user.html">linux-user.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/linux-user-memory_region.html">linux-user-memory_region.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/logs.html">logs.md</a></li><li class="chapter-item "><div>lx</div></li><li class="chapter-item "><a href="../../../BT/QEMU/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../BT/QEMU/signal.html">signal.md</a></li><li class="chapter-item "><div>target</div></li></ol></li><li class="chapter-item "><div>rewrite</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/rewrite/2018.superset_disassembly.bauman.ndss.40.html">2018.superset_disassembly.bauman.ndss.40.md</a></li><li class="chapter-item "><div>instru</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/rewrite/instru/2009.mt.hazelwood.ismm.28.html">2009.mt.hazelwood.ismm.28.md</a></li><li class="chapter-item "><a href="../../../BT/rewrite/instru/mem_count.html">mem_count.md</a></li></ol></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>static</div></li><li class="chapter-item "><div>sys</div></li><li class="chapter-item "><div>Tarmac</div></li><li class="chapter-item "><div>test</div></li><li class="chapter-item "><div>x86-qemu-mips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/check_manual.html">check_manual.md</a></li><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/check.html">check.md</a></li><li class="chapter-item "><div>debugs</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/debugs/OPEN.unknown-loop-in-bios.html">OPEN.unknown-loop-in-bios.md</a></li></ol></li><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/linux-user.html">linux-user.md</a></li><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/mips-llvm.html">mips-llvm.md</a></li><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/mt-tcg.html">mt-tcg.md</a></li><li class="chapter-item "><a href="../../../BT/x86-qemu-mips/tr_misc修改记录.html">tr_misc修改记录.md</a></li></ol></li><li class="chapter-item "><div>X86toMips</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../BT/X86toMips/dbt测试结果.html">dbt测试结果.md</a></li><li class="chapter-item "><a href="../../../BT/X86toMips/Pseudo-README.html">Pseudo-README.md</a></li><li class="chapter-item "><a href="../../../BT/X86toMips/X86toMips调研.html">X86toMips调研.md</a></li><li class="chapter-item "><a href="../../../BT/X86toMips/X86toMips调研-续.html">X86toMips调研-续.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Build</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Autotools</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Autotools/2012.autotools_criticism.kamp..html">2012.autotools_criticism.kamp..md</a></li><li class="chapter-item "><a href="../../../Build/Autotools/autotools.html">autotools.md</a></li></ol></li><li class="chapter-item "><div>CMake</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/CMake/Notes.html">Notes.md</a></li></ol></li><li class="chapter-item "><div>Compiler</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Compiler/1992.hyperblock.mahlke.micro.html">1992.hyperblock.mahlke.micro.md</a></li><li class="chapter-item "><div>llvm</div></li><li class="chapter-item "><div>mingw</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Compiler/mingw/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>ORC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Compiler/ORC/2004.ORC-LCPC04-Tutorial.html">2004.ORC-LCPC04-Tutorial.md</a></li><li class="chapter-item "><a href="../../../Build/Compiler/ORC/2004.overview_orc.wuchengyong.iwlcpc.html">2004.overview_orc.wuchengyong.iwlcpc.md</a></li></ol></li><li class="chapter-item "><div>trans</div></li></ol></li><li class="chapter-item "><div>Disassemble</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Disassemble/2002.disassembly.bschwarz.pieee.html">2002.disassembly.bschwarz.pieee.md</a></li></ol></li><li class="chapter-item "><a href="../../../Build/ELF/index.html">ELF</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/ELF/ELF调研.html">ELF调研.md</a></li><li class="chapter-item "><a href="../../../Build/ELF/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Linker_Loader</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Build/Linker_Loader/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../../Build/mingw.html">mingw.md</a></li></ol></li><li class="chapter-item "><a href="../../../cheatsheet.html">cheatsheet.md</a></li><li class="chapter-item "><div>CLI</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../CLI/term_pty_sh.html">term_pty_sh.md</a></li></ol></li><li class="chapter-item "><div>CompatLayer</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../CompatLayer/2006.linuxulator.divacky.freebsd..html">2006.linuxulator.divacky.freebsd..md</a></li><li class="chapter-item "><a href="../../../CompatLayer/Alky.html">Alky.md</a></li><li class="chapter-item "><div>UML</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../CompatLayer/UML/user_mode_linux.html">user_mode_linux.md</a></li></ol></li><li class="chapter-item "><div>WINE</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../CompatLayer/WINE/2020_6_25.emu_win_syscall.corbet.lwn.html">2020_6_25.emu_win_syscall.corbet.lwn.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/Design_of_WINE.html">Design_of_WINE.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/optimizable.html">optimizable.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/others.html">others.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/qemu-wine-logs.html">qemu-wine-logs.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/qemu-wine.html">qemu-wine.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/qemu-winetest_debug_logs.html">qemu-winetest_debug_logs.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/qemu-wine环境搭建.html">qemu-wine环境搭建.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/References.html">References.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/Winegcc调研.html">Winegcc调研.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/Winelib调研报告.html">Winelib调研报告.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/WINE设备驱动调研.html">WINE设备驱动调研.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/WINE调研.html">WINE调研.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/二进制翻译调研报告_FX32_Wine.html">二进制翻译调研报告_FX32_Wine.md</a></li><li class="chapter-item "><a href="../../../CompatLayer/WINE/二进制翻译调研报告_Wine.html">二进制翻译调研报告_Wine.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Connect</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Bluetooth/index.html">Bluetooth</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bluez</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Bluetooth/bluez/profile_input.html">profile_input.md</a></li></ol></li><li class="chapter-item "><div>btkbdd</div></li><li class="chapter-item "><div>dbus</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Bluetooth/dbus/Overview.html">Overview.md</a></li></ol></li><li class="chapter-item "><div>Essays</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>2005.bluez_intro.albert</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Bluetooth/Essays/2005.bluez_intro.albert/An_Introduction_to_Bluetooth_Programming.html">An_Introduction_to_Bluetooth_Programming.md</a></li></ol></li><li class="chapter-item "><a href="../../../Connect/Bluetooth/Essays/阅读记录.html">阅读记录.md</a></li></ol></li><li class="chapter-item "><div>hidclient</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Bluetooth/hidclient/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Network</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bittorrent</div></li><li class="chapter-item "><div>nginx</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Connect/Network/nginx/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><a href="../../../Connect/Network/p2p.html">p2p.md</a></li><li class="chapter-item "><a href="../../../Connect/Network/streaming_server.html">streaming_server.md</a></li></ol></li><li class="chapter-item "><div>NFC</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Essays</div></li></ol></li></ol></li><li class="chapter-item "><div>dataViz</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../dataViz/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Distro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Distro/JingOS.html">JingOS.md</a></li><li class="chapter-item "><div>Nix</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Distro/Nix/android.html">android.md</a></li><li class="chapter-item "><a href="../../../Distro/Nix/nixpkgs.html">nixpkgs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>EPaper</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../EPaper/laptop.html">laptop.md</a></li></ol></li><li class="chapter-item "><div>FPGA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../FPGA/iverilog.html">iverilog.md</a></li></ol></li><li class="chapter-item "><div>hackthon</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../hackthon/Untitled.html">Untitled.md</a></li></ol></li><li class="chapter-item "><div>Input</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Input/logs.html">logs.md</a></li></ol></li><li class="chapter-item "><div>ISA</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../ISA/2013.power_of_risc_cisc.blem.hpca.144.html">2013.power_of_risc_cisc.blem.hpca.144.md</a></li><li class="chapter-item "><div>arm</div></li><li class="chapter-item "><div>enhance</div></li><li class="chapter-item "><div>mips</div></li><li class="chapter-item "><div>mips_lx</div></li><li class="chapter-item "><div>riscv</div></li><li class="chapter-item "><a href="../../../ISA/Semantics/index.html">Semantics</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../ISA/Semantics/2013.locate.lakhotia.pprew.75.html">2013.locate.lakhotia.pprew.75.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2014.lem.mulligan.icfp.79.html">2014.lem.mulligan.icfp.79.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2015.sail.gray.micro.31.html">2015.sail.gray.micro.31.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2016.learn.heule.pldi.56.html">2016.learn.heule.pldi.56.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2018.sail.armstrong..3.html">2018.sail.armstrong..3.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2019.x64_validation.dasgupta.sigplan.24.html">2019.x64_validation.dasgupta.sigplan.24.md</a></li><li class="chapter-item "><a href="../../../ISA/Semantics/2021.sail.armstrong.manual.html">2021.sail.armstrong.manual.md</a></li><li class="chapter-item "><div>k</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../ISA/Semantics/k/logs.html">logs.md</a></li></ol></li></ol></li><li class="chapter-item "><div>ultrasparc</div></li><li class="chapter-item "><div>Uop</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../ISA/Uop/1990.nec_intel.elkins...html">1990.nec_intel.elkins...md</a></li><li class="chapter-item "><a href="../../../ISA/Uop/1996.palcode..manual..html">1996.palcode..manual..md</a></li><li class="chapter-item "><a href="../../../ISA/Uop/2003.ucache.solomon.tvlsi.13.html">2003.ucache.solomon.tvlsi.13.md</a></li><li class="chapter-item "><a href="../../../ISA/Uop/2019.reverse_engineer.koppe.usenix_security.16.html">2019.reverse_engineer.koppe.usenix_security.16.md</a></li><li class="chapter-item "><a href="../../../ISA/Uop/2020.improve_ucache.kotra.micro.1.html">2020.improve_ucache.kotra.micro.1.md</a></li></ol></li><li class="chapter-item "><div>x86</div></li></ol></li><li class="chapter-item "><div>JIT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../JIT/2008.llvm_sim.brandner..29.html">2008.llvm_sim.brandner..29.md</a></li><li class="chapter-item "><a href="../../../JIT/2011.llvm_sim.helmstetter.imecs.6.html">2011.llvm_sim.helmstetter.imecs.6.md</a></li><li class="chapter-item "><div>dynarmic</div></li><li class="chapter-item "><div>opt</div></li></ol></li><li class="chapter-item expanded "><div>Kernel</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/2020_9_9.prepare_new_feat.edge.lwn-lpc.html">2020_9_9.prepare_new_feat.edge.lwn-lpc.md</a></li><li class="chapter-item "><div>Driver</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Driver/2019.linux_win_printer.金融通.软件所硕士.html">2019.linux_win_printer.金融通.软件所硕士.md</a></li></ol></li><li class="chapter-item "><div>exo</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/exo/1995.intro.engler.sosp.1259.html">1995.intro.engler.sosp.1259.md</a></li></ol></li><li class="chapter-item "><div>Linux</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Linux/2002.rcu.mckenney..216.html">2002.rcu.mckenney..216.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/2016.sched_bug.lozi.eurosys.120.html">2016.sched_bug.lozi.eurosys.120.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/2018.concurrency.alglave.asplos.31.html">2018.concurrency.alglave.asplos.31.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/2020.rcu.mckenney...html">2020.rcu.mckenney...md</a></li><li class="chapter-item "><div>Android</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Linux/Android/anbox.html">anbox.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/Android/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/Android/to_mainline.html">to_mainline.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/Android/Waydroid.html">Waydroid.md</a></li></ol></li><li class="chapter-item "><a href="../../../Kernel/Linux/cache_alias.html">cache_alias.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/cache_alias_page_color.html">cache_alias_page_color.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/docsReading.html">docsReading.md</a></li><li class="chapter-item "><div>drivers</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Linux/drivers/ioctl.html">ioctl.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/drivers/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../../Kernel/Linux/idle.html">idle.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/lx.html">lx.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/memory_mapping.html">memory_mapping.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/module.logs.html">module.logs.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/mtlb.logs.html">mtlb.logs.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/page_fault.html">page_fault.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/page_size.html">page_size.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/QnA-alpine.html">QnA-alpine.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/startup.html">startup.md</a></li><li class="chapter-item "><a href="../../../Kernel/Linux/syscalls.html">syscalls.md</a></li></ol></li><li class="chapter-item "><a href="../../../Kernel/memory.html">memory.md</a></li><li class="chapter-item "><div>micro</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/micro/1995.u_kernel.lietdke.sosp.308.html">1995.u_kernel.lietdke.sosp.308.md</a></li><li class="chapter-item "><a href="../../../Kernel/micro/2013.l3_sel4.elphinstone.sosp.126.html">2013.l3_sel4.elphinstone.sosp.126.md</a></li></ol></li><li class="chapter-item "><div>multi</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/multi/2009.intro.baumann.sosp.856.html">2009.intro.baumann.sosp.856.md</a></li></ol></li><li class="chapter-item "><div>syscall</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/syscall/2020_9_8.extensible_syscall.corbet.lwn-lpc.html">2020_9_8.extensible_syscall.corbet.lwn-lpc.md</a></li></ol></li><li class="chapter-item "><a href="../../../Kernel/transkernel.html">transkernel.md</a></li><li class="chapter-item "><div>unikernel</div></li><li class="chapter-item "><div>WinCmptbl</div></li><li class="chapter-item expanded "><div>Windows</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Windows/compilation.html">compilation.md</a></li><li class="chapter-item expanded "><a href="../../../Kernel/Windows/driver/index.html" class="active">driver</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/Windows/driver/ddiwrapper.html">ddiwrapper.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/logs-1.html">logs-1.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/logs.html">logs.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/ndis.html">ndis.md</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>err</div></li></ol></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/printer.html">printer.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/driver/types.html">types.md</a></li></ol></li><li class="chapter-item "><a href="../../../Kernel/Windows/nameConventions.html">nameConventions.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/QnA.html">QnA.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/ReactOS/index.html">ReactOS</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/service.html">service.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/subsystem.html">subsystem.md</a></li><li class="chapter-item "><a href="../../../Kernel/Windows/syscall.html">syscall.md</a></li></ol></li><li class="chapter-item "><div>XNU</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Darling</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Kernel/XNU/Darling/overview.html">overview.md</a></li></ol></li></ol></li></ol></li><li class="chapter-item "><div>Lang</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Asm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/Asm/asm.html">asm.md</a></li><li class="chapter-item "><div>riscv</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/Asm/riscv/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><div>C.f</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/C.f/macro.html">macro.md</a></li></ol></li><li class="chapter-item "><div>Dot</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/Dot/overview.html">overview.md</a></li><li class="chapter-item "><a href="../../../Lang/Dot/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>IR</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/IR/1999.JVM_Specification.html">1999.JVM_Specification.md</a></li><li class="chapter-item "><a href="../../../Lang/IR/2000.llvm.lattner.master_thesis.241.html">2000.llvm.lattner.master_thesis.241.md</a></li><li class="chapter-item "><a href="../../../Lang/IR/2004.llvm.lattner.cgo.4340.html">2004.llvm.lattner.cgo.4340.md</a></li><li class="chapter-item "><a href="../../../Lang/IR/2013.importance.chow...html">2013.importance.chow...md</a></li><li class="chapter-item "><div>Common2</div></li><li class="chapter-item "><a href="../../../Lang/IR/LLVM-IR.html">LLVM-IR.md</a></li><li class="chapter-item "><a href="../../../Lang/IR/MapleIRDesign.html">MapleIRDesign.md</a></li></ol></li><li class="chapter-item "><div>JS</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/JS/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>Latex</div></li><li class="chapter-item "><div>Lisp</div></li><li class="chapter-item "><div>Py</div></li><li class="chapter-item "><div>SMT-LIB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/SMT-LIB/2012.smt_lib_v2.cok..47.html">2012.smt_lib_v2.cok..47.md</a></li></ol></li><li class="chapter-item "><div>WebAsm</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lang/WebAsm/2017.intro.haas.pldi.194.html">2017.intro.haas.pldi.194.md</a></li><li class="chapter-item "><a href="../../../Lang/WebAsm/overview.html">overview.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Lib</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>Glibc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lib/Glibc/glibc.html">glibc.md</a></li><li class="chapter-item "><a href="../../../Lib/Glibc/mmap.html">mmap.md</a></li><li class="chapter-item "><a href="../../../Lib/Glibc/pthread.html">pthread.md</a></li><li class="chapter-item "><a href="../../../Lib/Glibc/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>igraph</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lib/igraph/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><div>Libc</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Lib/Libc/Musl/index.html">Musl</a></li></ol></li></ol></li><li class="chapter-item "><div>Mem</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Mem/cat.html">cat.md</a></li><li class="chapter-item "><div>model</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Mem/model/2017.memalloy.wickerson.popl.77.html">2017.memalloy.wickerson.popl.77.md</a></li></ol></li><li class="chapter-item "><a href="../../../Mem/order.html">order.md</a></li><li class="chapter-item "><a href="../../../Mem/test.html">test.md</a></li></ol></li><li class="chapter-item "><div>Opinions</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Opinions/notes.html">notes.md</a></li><li class="chapter-item "><a href="../../../Opinions/openEcoSys.html">openEcoSys.md</a></li></ol></li><li class="chapter-item "><div>other_read_list</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../other_read_list/cambridge.html">cambridge.md</a></li><li class="chapter-item "><a href="../../../other_read_list/stanford/index.html">stanford</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../other_read_list/stanford/1999.codesigned_vm.smith.iwia.html">1999.codesigned_vm.smith.iwia.md</a></li><li class="chapter-item "><a href="../../../other_read_list/stanford/2001.vm_intro.smith.html">2001.vm_intro.smith.md</a></li><li class="chapter-item "><a href="../../../other_read_list/stanford/2002.vector_vs_ss.kozyrakis.micro.html">2002.vector_vs_ss.kozyrakis.micro.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Perf</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Perf/flamegraph.html">flamegraph.md</a></li></ol></li><li class="chapter-item "><div>PoSh</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../PoSh/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../../Proj/index.html">Proj</a></li><li class="chapter-item "><div>Pwr</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Pwr/2009.mcpat.li.micro.2319.html">2009.mcpat.li.micro.2319.md</a></li></ol></li><li class="chapter-item "><a href="../../../QnA-Daliy.html">QnA-Daliy.md</a></li><li class="chapter-item "><div>Repos</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Repos/llvm-tutor.html">llvm-tutor.md</a></li></ol></li><li class="chapter-item "><div>Sandbox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Sandbox/chroot.html">chroot.md</a></li><li class="chapter-item "><div>Docker</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Sandbox/Docker/Overview.html">Overview.md</a></li><li class="chapter-item "><a href="../../../Sandbox/Docker/QnA.html">QnA.md</a></li></ol></li><li class="chapter-item "><a href="../../../Sandbox/proot.html">proot.md</a></li></ol></li><li class="chapter-item "><a href="../../../scripts/index.html">scripts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>bash</div></li><li class="chapter-item "><div>nix</div></li></ol></li><li class="chapter-item "><div>security</div></li><li class="chapter-item "><div>SftwStack</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../SftwStack/applications_arch.html">applications_arch.md</a></li><li class="chapter-item "><a href="../../../SftwStack/linux_desktop.html">linux_desktop.md</a></li></ol></li><li class="chapter-item "><div>Sim</div></li><li class="chapter-item "><div>Softwares</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Softwares/ocrmypdf.html">ocrmypdf.md</a></li><li class="chapter-item "><a href="../../../Softwares/pandoc.html">pandoc.md</a></li><li class="chapter-item "><a href="../../../Softwares/tree_timeline_note.html">tree_timeline_note.md</a></li><li class="chapter-item "><div>Vim</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Softwares/Vim/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../SPIN.html">SPIN.md</a></li><li class="chapter-item "><div>SQL</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../SQL/overview.html">overview.md</a></li></ol></li><li class="chapter-item "><div>SymExec</div></li><li class="chapter-item "><div>Temp</div></li><li class="chapter-item "><div>uArch</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>TLB</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../uArch/TLB/QnA.html">QnA.md</a></li></ol></li></ol></li><li class="chapter-item "><div>Virt</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Virt/1988.386.smith.programmers_journal..html">1988.386.smith.programmers_journal..md</a></li><li class="chapter-item "><a href="../../../Virt/2002.esx.waldspurger.opsr.1402.html">2002.esx.waldspurger.opsr.1402.md</a></li><li class="chapter-item "><a href="../../../Virt/2003.xen.barham.opsr.6475.html">2003.xen.barham.opsr.6475.md</a></li><li class="chapter-item "><a href="../../../Virt/2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.html">2003.xen.barham.opsr.6475.sync-conflict-20211220-085833-2SHHM4X.md</a></li><li class="chapter-item "><a href="../../../Virt/2006.cmp_soft_hard_x86.adams.asplos.700.html">2006.cmp_soft_hard_x86.adams.asplos.700.md</a></li><li class="chapter-item "><a href="../../../Virt/2012.dune.belay.osdi.215.html">2012.dune.belay.osdi.215.md</a></li><li class="chapter-item "><div>addr_trans</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Virt/addr_trans/2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.html">2018.1_qemu_dune_2_lkm.faravelon.doc_thesis.1.md</a></li></ol></li><li class="chapter-item "><div>BT</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Virt/BT/2016.cross_arch_captive.spink.taco.3.html">2016.cross_arch_captive.spink.taco.3.md</a></li><li class="chapter-item "><a href="../../../Virt/BT/2019.cross_arch_captive.spink.usenix.1.html">2019.cross_arch_captive.spink.usenix.1.md</a></li></ol></li><li class="chapter-item "><a href="../../../Virt/overview.html">overview.md</a></li><li class="chapter-item "><div>virtualBox</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../Virt/virtualBox/install.html">install.md</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../X11/index.html">X11</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../X11/windowManage.html">windowManage.md</a></li></ol></li><li class="chapter-item "><div>行业报告</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>LF</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../行业报告/LF/2020-Linux-Foundation-Annual-Report_120520.html">2020-Linux-Foundation-Annual-Report_120520.md</a></li><li class="chapter-item "><a href="../../../行业报告/LF/FINOS-business-value-of-open-source.html">FINOS-business-value-of-open-source.md</a></li></ol></li><li class="chapter-item "><div>Nix</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../行业报告/Nix/2021.summur.html">2021.summur.md</a></li></ol></li><li class="chapter-item "><div>企业年报</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div>apple</div></li><li class="chapter-item "><div>华为</div></li><li class="chapter-item "><div>海信</div></li><li class="chapter-item "><div>联想</div></li></ol></li><li class="chapter-item "><div>网信自主创新</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../行业报告/网信自主创新/2020.html">2020.md</a></li></ol></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                            </div>

                    <h1 class="menu-title">xieby1&#x27;s notes</h1>

                    <div class="right-buttons">
                                                                        <a href="https://github.com/xieby1/xieby1.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                
                    </div>
                </div>

                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>发布记录</p>
<p>2021.3.5：发布</p>
<h1 id="a-hrefhttp1721710358loongsonlabnotes-treemasterxiebenyikernelwindowsdriverreadmemdwine打印机方案a"><a class="header" href="#a-hrefhttp1721710358loongsonlabnotes-treemasterxiebenyikernelwindowsdriverreadmemdwine打印机方案a"><a href="http://172.17.103.58/loongsonlab/notes/-/tree/master/xiebenyi/Kernel/Windows/driver/README.md">WINE打印机方案</a></a></h1>
<p>本文档记录龙芯实验室的基于WINE的打印方案。本文档尽可能地记录下设计思路和调试经验，尽可能避免代码细节和调试细节。代码细节主要蕴含在源码和注释之中，调试细节主要蕴含在各个调试软件的手册之中。附件尽可能包含了所有WINE打印机方案的资料。其目录结构如下，</p>
<ul>
<li><code>docs/</code>：各类相关文献，关键内容已添加到尾注</li>
<li><code>nt5/</code>：WinNT5源码和编译结果，内容已全添加到尾注</li>
<li><code>src/</code>：WINE打印机方案的源码，源码也可以从<a href="http://172.17.103.58/loongsonlab/">实验室的gitlab</a>获取，内容已全添加到尾注</li>
<li><code>utils/</code>：各类工具</li>
</ul>
<p><code>docs/</code>内容较多，直接和本文档相关的文献已添加到尾注，其他文献作为必要时的研究参考。另外3个文件夹<code>nt5/</code>、<code>src/</code>、<code>utils/</code>的内容已全数添加到尾注。</p>
<h2 id="目录"><a class="header" href="#目录">目录</a></h2>
<p>[toc]</p>
<h2 id="设计思路"><a class="header" href="#设计思路">设计思路</a></h2>
<p>提出WINE打印机方案的主要目的是提速。因为用Win虚拟机运行Win打印机驱动的方案虽然简单稳定，但是速度慢。</p>
<p>WINE是能够在Linux等系统上运行Win用户程序的兼容层。WINE不是像虚拟机或者模拟器一样运行Win操作系统，而是将Win API翻译为Linux调用，因此WINE能够高效地运行Win用户程序（用gcc-9.3以同样的参数编译32位版本的Coremark，WINE-5.2-13的效率比Linux原生效率高4.11%。）。Win打印机驱动是用户态的，因此理论上WINE可以运行Win打印机驱动。</p>
<p>官方的WINE支持打印机，前提是安装了相应的Linux打印机驱动。WINE将Linux打印机驱动包装给了Win用户程序。我们称这个打印方案为“官方打印方案”。官方打印方案使用的是Linux打印机驱动，而非Win打印机驱动。因此需要对WINE做扩展，让其能够使用Win打印机驱动。目前基于这个目的，实验室给WINE官方打印方案做了修改和扩展，我们称之为“扩展打印方案”。因为是修改和拓展，则存在诸多不高效的设计。但因为修改和拓展对WINE本身的影响相对是小的，这能够使实验阶段的扩展打印方案更稳定，能够我们能够更快地验证猜想——“在WINE上可以运行Win打印机驱动”。下面简介WINE的官方打印方案和扩展打印方案。而关于更高效更具挑战的打印方案，将会在文末的“未来工作”中简介。</p>
<p><img src="pictures/wine_gdiprinter_overview-formatted.svg" alt="wine_gdiprinter_overview-formatted" /></p>
<ul>
<li>
<p>官方打印方案</p>
<p>WINE启动时扫描Linux中安装的打印机，在Win系统内生成对应的打印机信息（注册表、c:\windows\win.ini等），添加可用的打印机选项。在打印时调用wineps.drv驱动。wineps.drv可以看做是一个虚拟打印机。该虚拟打印机将Win用户程序的打印请求转换成一个ps（Post Script）文件，然后将打印任务重定向到Linux的打印系统——CUPS（Common UNIX Printing System）。</p>
</li>
<li>
<p>扩展打印方案</p>
<p>总体和官方打印方案流程相似。为了减少实验阶段的工作量，扩展打印方案仅支持位图（bitmap, bmp）格式的打印。将其他格式的打印请求转换为位图，即可满足所有打印格式需求。新增一个和wineps.drv地位相同的驱动，称之为wingdi.drv，来包装Win打印机驱动。位图打印程序的输入为bmp格式的文件，然后通过wingdi.drv输出raw数据，最后通过USB发送给打印机。</p>
</li>
</ul>
<p>wingdi.drv是扩展打印方案的关键。它详细涉及Win打印机驱动的原理。获取Win原理的路径主要来自<strong>官方文档</strong>（<a href="https://docs.microsoft.com/en-us/">在线文档</a>或开发包中的离线文档<sup class="footnote-reference"><a href="#wdk">1</a></sup><sup class="footnote-reference"><a href="#ddk">2</a></sup><sup class="footnote-reference"><a href="#sdk">3</a></sup>）和<strong>Win源码</strong><sup class="footnote-reference"><a href="#nt5src">4</a></sup>。</p>
<p>通过<strong>官方文档</strong>可以了解到在WinXP时期，打印机厂商广泛使用GDI类型的打印驱动。因为在Win里，该类型打印机和显示设备有相同处理流程，所以被称作GDI（Graphics Device Interface）类型。这类打印机驱动由两部分构成：</p>
<ol>
<li>
<p>printer graphics DLL及其附属DLL，</p>
<p>负责图形计算，是打印机实际打印功能的承担者。因此在相关文档和代码中，该DLL会被称作graphics DLL、driver DLL。</p>
</li>
<li>
<p>printer interface DLL及其附属DLL，</p>
<p>负责打印机参数设置，即负责印机属性的对话框、打印机任务队列的任务属性对话框等。因此在相关文档和代码中，该DLL会被称作interface DLL、UI DLL、configuration DLL。</p>
</li>
</ol>
<p>有些打印机可以只依赖graphics DLL，便能进行基础打印，比如目前实验选用的佳能i80。因此实验思路是先实现WINE调用graphics DLL。阶段目标是用i80打印机打印bmp图片。然后再实现WINE调用interface DLL。阶段目标是用惠普1020打印机打印bmp图片。（这两个阶段目标均一达成。）</p>
<p>通过调试对比<strong>Win源码</strong>和WINE源码，可以明确WINE缺失的功能。通过增补这些功能，来让打印机驱动运作起来。调试过程中还参考了其他项目的思路和代码。调试graphics DLL参考了DDIWrapper项目<sup class="footnote-reference"><a href="#ddiwrapper">5</a></sup>和软件所同行的工作<sup class="footnote-reference"><a href="#linux_win_printer">6</a></sup>。DDIWrapper项目用WINE包装打印机驱动，并嵌入到CUPS打印系统里。它只支持graphics dll的调用。且它和WINE是分离开的，这给调试带来一些不便。扩展打印方案弥补了这两个不足。调试Win源码也同时参考了<a href="https://reactos.org/">ReactOS</a>和OpenNT项目。这两个项目是Win内核的开源实现。因为其设计相对简单，且功能和Win保持兼容，所以可以辅助理解Win晦涩难懂的代码。在“调试”这一章节，将更详细的介绍我们所使用的调试经验。</p>
<h2 id="安装使用"><a class="header" href="#安装使用">安装&amp;使用</a></h2>
<p>按照扩展打印方案的图所示，需要安装3部分内容——位图打印程序、Win打印机驱动（wingdi.drv包装的内容）、WINE。</p>
<p>首先安装WINE。扩展打印方案中WINE的wgf分支已经添加wingdi.drv，</p>
<pre><code class="language-shell"># 从实验室的gitlab获取，或是从wine.zip中获取
git clone --single-branch --branch wgf http://172.17.103.58/loongsonlab/wine.git
# 和正常编译WINE一样
cd wine
./configure
make
</code></pre>
<p>然后编译<a href="https://www.dreamincode.net/forums/topic/261009-bitmap-printing-tutorial-in-c-win32/">位图打印程序</a>（bmprnt或bmprnt-cli），</p>
<pre><code class="language-shell"># 图形界面bmp打印程序，从实验室的gitlab获取如下，或是从bmprnt.zip中获取
git clone http://172.17.103.58/printer/bmprnt.git
cd bmprnt
winemaker --wine32 &amp;&amp; make

# 命令行bmp打印程序，从实验室的gitlab获取，或是从bmprnt-cli.zip中获取
git clone http://172.17.103.58/printer/bmprnt-cli.git
cd bmprnt-cli
make
</code></pre>
<p>最后安装Win打印机驱动。目前这个过程还没做到自动化，均为手动完成。其宗旨是把Win系统的相关设置和文件复制到WINE中。因此这个过程要借助装有Win的虚拟机的帮助。以佳能<a href="https://www.canon-europe.com/support/consumer_products/products/printers/inkjet/i_series/bubble_jet_i80.html?type=drivers&amp;language=en&amp;os=windows%20xp%20(32-bit)">i80打印机驱动</a>为例。</p>
<ul>
<li>
<p>在Win虚拟机中安装打印机驱动：</p>
<ul>
<li>若有i80打印机，则连上Win虚拟机后可以直接安装驱动</li>
<li>若没有i80打印机，
<ul>
<li>用解压软件把驱动的安装文件解压到一个目录</li>
<li>从控制面板添加打印机的界面出发，手工添加驱动，端口选择<code>file://</code>，选择对应的驱动目</li>
</ul>
</li>
</ul>
</li>
<li>
<p>复制打印机相关注册表：</p>
<ul>
<li><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers\Canon i80</code></li>
<li><code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Environments\Windows NT x86\Drivers\Version-3\Canon i80</code></li>
</ul>
</li>
<li>
<p>复制打印机驱动到<code>~/.wine/drive_c/windows/system32/spool/drivers/w32x86/3/</code></p>
</li>
<li>
<p>修改WINE打印机配置<code>~/.wine/drive_c/windows/win.ini</code>，</p>
<ul>
<li>[devices]下面添加<code>Canon i80=wingdi.drv,GDI:Canon i80,15,45</code></li>
<li>[PrinterPorts]下面添加<code>Canon i80=wingdi.drv,GDI:Canon i80,15,45</code></li>
</ul>
</li>
</ul>
<p>安装完WINE、位图打印程序和打印机驱动后。如下，用WINE运行位图打印程序即可。</p>
<pre><code class="language-shell">wine bmprnt # 或是wine bmprnt-cli
</code></pre>
<h2 id="调试"><a class="header" href="#调试">调试</a></h2>
<p>目前已经调通两款打印机——佳能i80和惠普1020。根据调试环境的不同，可以把调试手段分为2部分——调试Win和调试WINE。每种调试手段分为3部分进行说明，<strong>准备</strong>、<strong>操作</strong>、<strong>技巧</strong>。</p>
<h3 id="win"><a class="header" href="#win">Win</a></h3>
<p>根据编译工具链的不同，在Win中调试器可以分为2类。</p>
<ol>
<li>
<p>GNU的工具链（gcc）</p>
<p>以winedbg为代表。它使用的调试信息附加在PE文件中，格式为dwarf。</p>
</li>
<li>
<p>微软的工具链（vc）</p>
<p>以windbg为代表。它使用的调试信息是独立的pdb文件。</p>
</li>
</ol>
<p>尽管有2种调试信息的转换工具，比如<a href="https://github.com/rainers/cv2pdb">cv2pdb</a>，但做不到完美转换。因此应该根据不同的需求选择不同的调试器进行调试。比如，要想了解Win内核工作原理，则需要用windbg进行内核调试。再比如，想要对比同一用户程序在WINE和Win中运行的异同，则需要用gdb在Linux和Win中调试对比。</p>
<h4 id="windbg"><a class="header" href="#windbg">windbg</a></h4>
<p>windbg既可以调试Win用户程序，又可以调试Win内核，功能强大且稳健。windbg通常是Win开发包中的附属工具。任意安装一个开发包即可，比如WDK<sup class="footnote-reference"><a href="#wdk">1</a></sup>、DDK<sup class="footnote-reference"><a href="#ddk">2</a></sup>和SDK<sup class="footnote-reference"><a href="#sdk">3</a></sup>。</p>
<p><strong>准备</strong>：</p>
<p>首先编译待调试的程序——Win操作系统（Win内核+用户程序）<sup class="footnote-reference"><a href="#nt5src">4</a></sup>。参考<a href="https://rentry.co/build-win2k3">编译WinXP源码的文档</a>。编译出的WinXP有2个版本chk版<sup class="footnote-reference"><a href="#winxp-chk">7</a></sup>和fre版<sup class="footnote-reference"><a href="#winxp-fre">8</a></sup>（微软工具链的术语check、free和GNU工具链的术语debug、release等价）。chk版本无法正常运行，其原因还去未探明，fre版本可以正常运行。尽管使用的是fre版本，但是调试没有遇到本质性的障碍。因此接下来都围绕fre版本展开。</p>
<p>然后需要做如下设置和替换操作。这些步骤不分先后顺序：</p>
<ul>
<li>
<p>设置源码的路径</p>
<p>windbg菜单File-&gt;Source File Path设置为<code>&lt;根路径&gt;\srv03rtm</code>。</p>
<p><code>srv03rtm\</code><sup class="footnote-reference"><a href="#srv03rtm">9</a></sup>中是经过预处理的源文件（.c, .h, .res, ...）和编译中间文件（.o, ...）。需要强调的是这里的源文件已经经过Win编译器预处理，和源码中的源文件略有不同。调试信息中（.pdb）所含的行号信息匹配这些源文件。</p>
</li>
<li>
<p>设置调试信息的路径</p>
<p>windbg菜单File-&gt;Symbol File Path设置为<code>&lt;根路径&gt;\binaries.x86fre\symbols.pri\retail;&lt;根路径&gt;\binaries.x86fre\symbols\retail</code>。前者既包含函数信息也包含源码信息，后者只包含函数信息。</p>
<p><code>binaries.x86fre\</code><sup class="footnote-reference"><a href="#binaries.x86fre">10</a></sup>文件夹内存放的是各类二进制文件（.exe, .dl, ...）和调试信息文件(.pdb)。windbg在寻找pdb文件时，会根据模块的类型依次在上述2个路径中寻找。比如尝试加载gdi32.dll的调试信息时，windbg则会在<code>dll\</code>中寻找gdi32.pdb。</p>
</li>
<li>
<p>替换二进制文件</p>
<p><code>binaries.x86fre\</code>中的.pdb文件并不匹配fre版操作系统里的.exe文件和.dll文件。.pdb文件匹配<code>binaries.x86fre\</code>中的.exe文件和.dll文件。因此需要将调试目标.exe和.dll替换为<code>binaries.x86fre\</code>中对应文件。例如，需要把<code>notepad.exe</code>替换为<code>binaries.x86fre\notepad.exe</code>，把<code>C:\WINDOWS\system32\gdi32.dll</code>替换为<code>binaries.x86fre\gdi32.dll</code>。</p>
</li>
</ul>
<p><strong>操作</strong>：</p>
<p>上述步骤完成后，用windbg开始调试。根据调试对象的不同，大致可以分为下面3类。详细调试操作参阅windbg附带的手册<sup class="footnote-reference"><a href="#windbg_man">11</a></sup>，<a href="http://windbg.info/doc/1-common-cmds.html">Common WinDbg Commands</a><sup class="footnote-reference"><a href="#windbg_cmds">12</a></sup>也可作为入门速查手册。</p>
<ol>
<li>
<p>调试用户程序</p>
<p>直接打开待调试程序即可。</p>
</li>
<li>
<p>调试Win内核</p>
<p>需要两个运行2个Win内核，一个充当调试内核，另一充当被调试内核，两个内核可以版本不一致。上面的准备工作在调试内核中完成，即调试内核需要大磁盘空间容纳源码和调试信息，被调试内核不需要太大磁盘空间。虚拟机VirtualBox和QEMU-kvm中都可以正常使用windbg调试Win用户程序，但是目前只在QEMU-kvm中成功使用windbg调试Win内核，VirtualBox参考<a href="https://stackoverflow.com/questions/12696825/debugging-windows-kernel-from-linux">Debugging Windows Kernel from Linux</a>。</p>
</li>
<li>
<p>在调试Win内核中，调试用户程序</p>
<p>参考<a href="https://mike.melnyk.org/post/windbg_debug_user_mode/">Debug user mode application with kernel debugger</a>-&gt;<a href="https://stackoverflow.com/questions/42776503/how-to-do-hybrid-user-mode-kernel-mode-debugging">How to do hybrid user-mode/kernel-mode debugging?</a>。</p>
</li>
</ol>
<p><strong>技巧</strong>：</p>
<ul>
<li>打开调试符号信息的报错通道<code>!sym noisy</code>。</li>
<li>强制重新加载某模块的符号信息<code>.reload /f &lt;module&gt;</code>。</li>
<li>除了设置位置断点（例如<code>bp</code>），还可以设置事件触发断点。比如加载某模块时中断程序执行，<code>sxe ld:&lt;module&gt;</code>。</li>
</ul>
<h4 id="gdb"><a class="header" href="#gdb">gdb</a></h4>
<p>在Win上使用GNU工具链有2套方案——MinGW和CygWin。MinGW是使用微软C库，只能编译专门写给Win运行的代码。CygWin使用Win版GNU的C库。其目的是在Win上，尽可能模拟Linux的各种C库函数特性，以便在Win上编译且运行Linux程序。因此，为了探究Win底层工作原理，即使用微软C库，我们应该使用MinGW提供的GNU工具链。</p>
<p><strong>准备</strong>：</p>
<p>MinGW编译器既可以在Win上运行，也可以在Linux上运行。我们更倾向在Linux上运行编译任务。i686-w64-mingw32-gcc-win32是在64位Linux上编译32位Win程序的mingw-gcc。编译出来的程序既可以用WINE运行，也可以在Win上直接运行。在Win上，使用与MinGW搭配的gdb<sup class="footnote-reference"><a href="#gdb-mingw">13</a></sup>进行调试。</p>
<p><strong>操作</strong>：</p>
<p>和普通的gdb一致。</p>
<p><strong>技巧</strong>：</p>
<p>和普通的gdb一致。</p>
<h3 id="wine"><a class="header" href="#wine">WINE</a></h3>
<p>WINE提供给我们的调试工具有两套，一个是WINE自身的调试通道（Debug Channels），另一个是调试器winedbg。</p>
<h4 id="调试通道"><a class="header" href="#调试通道">调试通道</a></h4>
<p>调试通道是WINE输出消息的机制。WINE的调试通道本质上是利用stdout和stderr输出各种信息。这些stdout和stderr受环境变量<code>WINEDEBUG</code>的控制。</p>
<p><strong>准备</strong>：</p>
<p>宏函数<code>WINE_DEFAULT_DEBUG_CHANNEL()</code>被用来划分调试模块。宏函数<code>TRACE()</code>被来输出调试信息。所以在源代码按需调用这些函数即可。编译之后，这些函数便能在运行时给我们提供需要的信息。在扩展打印方案中引入如下模块：</p>
<ul>
<li><code>winspool</code>模拟Win打印缓冲池模块。对应dlls/winspool.drv/。打印作业送到winspool缓存后winspool选择合适的后端实施打印。</li>
<li><code>localspl</code>本地打印后端。对应dlls/localspl/。</li>
<li><code>wingdidrv</code>我们新增的Win gdi驱动 for wine，把Win .dll驱动包装成wine需要的接口。对应dlls/wingdi.drv</li>
<li><code>print</code>gdi32中打印模块，对应dlls/gdi32/printdrv.c</li>
<li><code>driver</code>gdi32中驱动加载模块，对应dlls/gdi32/driver.c</li>
<li><code>eng</code>我们新增的对应Win GRE模块的engine实现（即EngXXX函数，会被Win驱动回调）</li>
</ul>
<p><strong>操作</strong>：</p>
<p>参考WINE官方文档<a href="https://wiki.winehq.org/Debug_Channels">Debug channels</a>。</p>
<h4 id="winedbg-gdb"><a class="header" href="#winedbg-gdb">winedbg (gdb)</a></h4>
<p><strong>准备</strong>：</p>
<p>在Win的部分已经说明winedbg和windbg属于不同的工具链，因此需要用GNU的编译器来编译待调试程序。使用winegcc和MinGW-gcc均可。二者略有区别。winegcc编译出来的是Linux的.so文件，只能在WINE上运行。MinGW-gcc编译出来的是Win的PE文件既可以在WINE上也可以在Win上运行。</p>
<p>在编译时添加<code>-gdwarf-2 -gstrict-dwarf</code>参数，以免winedbg不识别调试信息。</p>
<p><strong>操作</strong>：</p>
<p>和普通的gdb一致，可参考<code>man winedbg</code>。</p>
<p><strong>技巧</strong>：</p>
<ul>
<li>
<p>用winegcc编译Win程序时，可以使用winemaker脚本自动生成Makefile。比如上文编译位图打印程序bmprnt时就用到了winemaker。</p>
</li>
<li>
<p>winedbg可以用gdb当前端，命令行<code>winedbg --gdb</code>可以启用。</p>
<p>gdb前端需要手动跳过一些合法的SIGSEGV，需要用<code>symbol-file</code>命令手动加载部分模块的调试信息。</p>
</li>
<li>
<p>协助调试通道展示错误现场。</p>
<p>比如，调试通道能够展示SetLastError的错误号，但是没法知道何时何地出现的设置的错误号。可以借助winedbg的watch功能查看。</p>
</li>
</ul>
<h3 id="其他"><a class="header" href="#其他">其他</a></h3>
<p>二进制分析相关工具：</p>
<p>[<strong>仅Win</strong>] depends<sup class="footnote-reference"><a href="#depends">14</a></sup>分析.exe文件和.dll文件所依赖的库。</p>
<p>[<strong>仅Win</strong>] IDA-pro<sup class="footnote-reference"><a href="#ida-pro">15</a></sup>反编译工具。用于反编译打印机的驱动。反编译出来的C文件用来辅助调试。</p>
<p>[<strong>仅Linux</strong>] pev<sup class="footnote-reference"><a href="#pev">16</a></sup>工具集用于分析.exe文件和.dll文件。比如该工具集中的readpe是类似readelf工具。</p>
<p>源码相关工具：</p>
<p>[<strong>Win&amp;Linux</strong>] cvdump<sup class="footnote-reference"><a href="#cvdump">17</a></sup>分析Win的.pdb文件，比如可以<code>cvdump -sf &lt;pdb file&gt;</code>输出相关的源文件。尽管cvdump是Win程序，但是经测试可以用WINE在Linux上稳定运行。</p>
<p>[<strong>Win&amp;WINE</strong>] reshacker<sup class="footnote-reference"><a href="#reshacker">18</a></sup>分析Win资源文件（.rec和.rc）。</p>
<p>调试相关工具:</p>
<p>[<strong>Win&amp;Linux</strong>] 编译器去掉优化选项-O2，方便更精确的打断点。</p>
<p>[<strong>Win&amp;Linux</strong>] 在调试器不能准确打断点的情况下，可以在源码中添加<code>asm (&quot;int $3&quot;);</code>辅助调试。</p>
<p>除了上述调试工具，还可以参考如下网站：</p>
<ul>
<li>Github上的<a href="https://github.com/j00ru/windows-syscalls">windows-syscalls</a>项目记录了历代Win的系统调用号，可以用于辅助调试Win内核。</li>
<li>一个逆向工程师的关于Win的博客<a href="http://www.geoffchappell.com/index.htm">Geoff Chappell, Software Analyst</a>。</li>
<li>龙芯实验室张福新关于<a href="http://172.17.103.58/loongsonlab/notes/-/blob/master/zhangfuxin/windbg.md">windbg的笔记</a>和<a href="http://172.17.103.58/loongsonlab/notes/-/blob/master/zhangfuxin/winedbg.md">winedbg的笔记</a>。</li>
<li>龙芯实验室谢本壹关于<a href="http://172.17.103.58/loongsonlab/notes/-/tree/master/xiebenyi/Kernel/Windows/driver">调试Win驱动的笔记</a>。</li>
</ul>
<h2 id="未来工作"><a class="header" href="#未来工作">未来工作</a></h2>
<p><strong>扩展打印方案</strong>：</p>
<ul>
<li>WINE和二进制翻译结合
<ul>
<li>给二进制翻译器添加WINE兼容模块<sup class="footnote-reference"><a href="#qemu_opt_wine">19</a></sup></li>
<li>给WINE添加二进制翻译模块<sup class="footnote-reference"><a href="#wine_bochs">20</a></sup></li>
</ul>
</li>
<li>完善打印机接口即printer interface DLL对应的打印机配置窗口</li>
<li>适配更多打印机</li>
<li>集成到Linux的CUPS打印系统中</li>
<li>性能瓶颈分析</li>
</ul>
<p><strong>高效打印方案</strong>：</p>
<ul>
<li>
<p>改造Win代码来替换WINE中的打印模块，</p>
<p>比如现有的gdi32、winspool、localspl模块都用Win代码来改造。这样能够使得扩展打印方案更加稳定。增加非GDI打印机的支持也更加简单。</p>
</li>
</ul>
<h2 id="尾注"><a class="header" href="#尾注">尾注</a></h2>
<ul>
<li>[Win软件] Adobe PDF阅读器，附件名7.0_AdbeRdr70_enu.exe</li>
</ul>
<div class="footnote-definition" id="nt5src"><sup class="footnote-definition-label">4</sup>
<p>[Win内核] WinNT5源码及编译工具，附件名<code>nt5src.7z</code>
<sup class="footnote-reference"><a href="#winxp-fre">8</a></sup>: [Win内核] free版本，附件名<code>3790.x86fre.srckit.201111-1534_pro.iso</code>
<sup class="footnote-reference"><a href="#winxp-chk">7</a></sup>: [Win内核] check版本，附件名<code>3790.x86chk.srckit.201111-0902_pro.iso</code>
<sup class="footnote-reference"><a href="#binaries.x86fre">10</a></sup>: [Win内核] binaries.x86fre文件夹压缩包，附件名<code>binaries.x86fre.zip</code>
<sup class="footnote-reference"><a href="#srv03rtm">9</a></sup>: [Win内核] srv03rtm文件夹压缩包，附件名<code>srv03rtm.zip</code>
<sup class="footnote-reference"><a href="#ddk">2</a></sup>: [Win软件] Device Development Kit，附件名<code>1830_usa_ddk.iso</code>
<sup class="footnote-reference"><a href="#cvdump">17</a></sup>: [Win软件] cvdump，提取pdb文件的信息，附件名<code>cvdump.exe</code>
<sup class="footnote-reference"><a href="#depends">14</a></sup>: [Win软件] depends，解析DLL依赖，附件名<code>depends22_x86.zip</code>
<sup class="footnote-reference"><a href="#gdb-mingw">13</a></sup>: [Win软件] gdb-MinGW，Win的gdb，附件名<code>gdb-9.2-1-MinGW32-bin.zip</code>
<sup class="footnote-reference"><a href="#sdk">3</a></sup>: [Win软件] Software Development Kit，附件名<code>GRMSDK_EN_DVD.iso</code>
<sup class="footnote-reference"><a href="#wdk">1</a></sup>: [Win软件] Windows Driver Kit，附件名<code>GRMWDK_EN_7600_1.iso</code>
<sup class="footnote-reference"><a href="#reshacker">18</a></sup>: [Win软件] reshacker，Win资源文件（.rc和.res）解析器，附件名<code>reshacker_setup.exe</code>
<sup class="footnote-reference"><a href="#ida-pro">15</a></sup>: [Win软件] IDA-pro，附件名<code>IDA-pro.tar.xz</code>
<sup class="footnote-reference"><a href="#ddiwrapper">5</a></sup>: [Linux软件] DDIWrapper，佳能打印机驱动包装层，在其README中有详细列举支持的打印机，附件名<code>ddiwrapper_0.3-rc1.tgz</code>，<strong>注</strong>：修改过后的WINE中自带，位于programs/printer/
<sup class="footnote-reference"><a href="#wine_bochs">20</a></sup>: [Linux软件] wine+bochs，附件名<code>wine-bochs.李文刚.zip</code>
<sup class="footnote-reference"><a href="#pev">16</a></sup>: [Linux软件] pev，PE文件分析工具包，主页https://github.com/merces/pev</p>
</div>
<div class="footnote-definition" id="windbg_cmds"><sup class="footnote-definition-label">12</sup>
<p>[Win手册] windbg常用指令，附件名<code>WinDbg_cmds.pdf</code>
<sup class="footnote-reference"><a href="#windbg_man">11</a></sup>: [Win手册] windbg手册，来源DDK，附件名<code>winddk.debugger.chm</code>
<sup class="footnote-reference"><a href="#linux_win_printer">6</a></sup>: [论文] Linux平台下Windows打印设备驱动兼容框架设计与实现，附件名<code>2019.linux_win_printer.金融通.软件所硕士.pdf</code></p>
</div>
<div class="footnote-definition" id="qemu_opt_wine"><sup class="footnote-definition-label">19</sup>
<p>[论文] 二进制兼容系统的设计实现与性能优化，附件名<code>2010.qemu_opt_wine.刘奇.计算所博士.pdf</code></p>
</div>

                    </main>
                    <script src="https://utteranc.es/client.js"
                        repo="xieby1/xieby1.github.io"
                        issue-term="pathname"
                        theme="github-light"
                        crossorigin="anonymous"
                        async>
                    </script>
                </div>
            </div>
        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
        
        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
